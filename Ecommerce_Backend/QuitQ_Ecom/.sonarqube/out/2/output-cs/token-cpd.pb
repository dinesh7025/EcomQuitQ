ша
SD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Program.cs
	namespace 	

EcomWebApp
 
{ 
public 

class 
Program 
{   
public!! 
static!! 
void!! 
Main!! 
(!!  
string!!  &
[!!& '
]!!' (
args!!) -
)!!- .
{"" 	
var## 
builder## 
=## 
WebApplication## (
.##( )
CreateBuilder##) 6
(##6 7
args##7 ;
)##; <
;##< =
builder%% 
.%% 
Services%% 
.%% 
AddApiVersioning%% -
(%%- .
options%%. 5
=>%%6 8
{&& 
options'' 
.'' 
DefaultApiVersion'' )
=''* +
new'', /

ApiVersion''0 :
('': ;
$num''; <
,''< =
$num''> ?
)''? @
;''@ A
options(( 
.(( /
#AssumeDefaultVersionWhenUnspecified(( ;
=((< =
true((> B
;((B C
options)) 
.)) 
ReportApiVersions)) )
=))* +
true)), 0
;))0 1
}** 
)** 
;** 
builder,, 
.,, 
Services,, 
.,, 
AddCors,, $
(,,$ %
options,,% ,
=>,,- /
{-- 
options.. 
... 
	AddPolicy.. !
(..! "
$str.." 2
,..2 3
builder// 
=>// 
builder// &
.00 
AllowAnyOrigin00 '
(00' (
)00( )
.11 
AllowAnyMethod11 '
(11' (
)11( )
.22 
AllowAnyHeader22 '
(22' (
)22( )
)22) *
;22* +
}33 
)33 
;33 
var55 
key55 
=55 
builder55 
.55 
Configuration55 +
.55+ ,
GetValue55, 4
<554 5
string555 ;
>55; <
(55< =
$str55= Q
)55Q R
;55R S
builder66 
.66 
Services66 
.66 
AddAuthentication66 .
(66. /
x66/ 0
=>661 3
{77 
x88 
.88 %
DefaultAuthenticateScheme88 +
=88, -
JwtBearerDefaults88. ?
.88? @ 
AuthenticationScheme88@ T
;88T U
x99 
.99 "
DefaultChallengeScheme99 (
=99) *
JwtBearerDefaults99+ <
.99< = 
AuthenticationScheme99= Q
;99Q R
}:: 
):: 
.;; 
AddJwtBearer;; 
(;; 
x;; 
=>;;  "
{<< 
x== 
.==  
RequireHttpsMetadata== *
===+ ,
false==- 2
;==2 3
x>> 
.>> 
	SaveToken>> 
=>>  !
true>>" &
;>>& '
x?? 
.?? %
TokenValidationParameters?? /
=??0 1
new??2 5%
TokenValidationParameters??6 O
{@@ 
ValidateLifetimeAA (
=AA) *
trueAA+ /
,AA/ 0$
ValidateIssuerSigningKeyBB 0
=BB1 2
trueBB3 7
,BB7 8
ValidateIssuerCC &
=CC' (
trueCC) -
,CC- .
ValidateAudienceDD (
=DD) *
trueDD+ /
,DD/ 0
ValidIssuerEE #
=EE$ %
$strEE& 1
,EE1 2
ValidAudienceFF %
=FF& '
$strFF( 5
,FF5 6
IssuerSigningKeyHH (
=HH) *
newHH+ . 
SymmetricSecurityKeyHH/ C
(HHC D
EncodingHHD L
.HHL M
ASCIIHHM R
.HHR S
GetBytesHHS [
(HH[ \
keyHH\ _
)HH_ `
)HH` a
,HHa b
RoleClaimTypeII %
=II& '
$strII( f
}KK 
;KK 
}LL 
)LL 
;LL 
builderNN 
.NN 
ServicesNN 
.NN 
AddSwaggerGenNN *
(NN* +
cNN+ ,
=>NN- /
{OO 
cPP 
.PP 

SwaggerDocPP 
(PP 
$strPP !
,PP! "
newPP# &
OpenApiInfoPP' 2
{QQ 
VersionRR 
=RR 
$strRR "
,RR" #
TitleSS 
=SS 
$strSS ,
,SS, -
DescriptionTT 
=TT  !
$strTT" 3
}UU 
)UU 
;UU 
cWW 
.WW 

SwaggerDocWW 
(WW 
$strWW !
,WW! "
newWW# &
OpenApiInfoWW' 2
{XX 
VersionYY 
=YY 
$strYY "
,YY" #
TitleZZ 
=ZZ 
$strZZ ,
,ZZ, -
Description[[ 
=[[  !
$str[[" 3
}\\ 
)\\ 
;\\ 
c^^ 
.^^ %
ResolveConflictingActions^^ +
(^^+ ,
apiDescriptions^^, ;
=>^^< >
apiDescriptions^^? N
.^^N O
First^^O T
(^^T U
)^^U V
)^^V W
;^^W X
c__ 
.__ !
AddSecurityDefinition__ '
(__' (
$str__( 0
,__0 1
new__2 5!
OpenApiSecurityScheme__6 K
{`` 
Descriptionaa 
=aa  !
$straa" t
,aat u
Namebb 
=bb 
$strbb *
,bb* +
Incc 
=cc 
ParameterLocationcc *
.cc* +
Headercc+ 1
,cc1 2
Typedd 
=dd 
SecuritySchemeTypedd -
.dd- .
ApiKeydd. 4
,dd4 5
Schemeee 
=ee 
$stree %
}ff 
)ff 
;ff 
chh 
.hh "
AddSecurityRequirementhh (
(hh( )
newhh) ,&
OpenApiSecurityRequirementhh- G
{ii 
{jj 
newkk !
OpenApiSecuritySchemekk 1
{ll 
	Referencemm %
=mm& '
newmm( +
OpenApiReferencemm, <
{nn 
Typeoo  $
=oo% &
ReferenceTypeoo' 4
.oo4 5
SecuritySchemeoo5 C
,ooC D
Idpp  "
=pp# $
$strpp% -
}qq 
,qq 
Schemerr "
=rr# $
$strrr% -
,rr- .
Namess  
=ss! "
$strss# 2
,ss2 3
Intt 
=tt  
ParameterLocationtt! 2
.tt2 3
Headertt3 9
}uu 
,uu 
newvv 
Listvv  
<vv  !
stringvv! '
>vv' (
(vv( )
)vv) *
}ww 
}xx 
)xx 
;xx 
}yy 
)yy 
;yy 
builder|| 
.|| 
Services|| 
.|| 
AddDbContext|| )
<||) *
AppDbContext||* 6
>||6 7
(||7 8
options||8 ?
=>||@ B
options}} 
.}} 
UseSqlServer}} (
(}}( )
builder}}) 0
.}}0 1
Configuration}}1 >
.}}> ?
GetConnectionString}}? R
(}}R S
$str}}S f
)}}f g
)}}g h
)}}h i
;}}i j
builder 
. 
Services 
. 
	Configure &
<& '
MailSettings' 3
>3 4
(4 5
builder5 <
.< =
Configuration= J
.J K

GetSectionK U
(U V
$strV d
)d e
)e f
;f g
builder
АА 
.
АА 
Services
АА 
.
АА 
AddTransient
АА )
<
АА) *
EmailService
АА* 6
>
АА6 7
(
АА7 8
)
АА8 9
;
АА9 :
builder
ГГ 
.
ГГ 
Services
ГГ 
.
ГГ 
	AddScoped
ГГ &
<
ГГ& '
UserService
ГГ' 2
>
ГГ2 3
(
ГГ3 4
)
ГГ4 5
;
ГГ5 6
builder
ДД 
.
ДД 
Services
ДД 
.
ДД 
	AddScoped
ДД &
<
ДД& '
AuthService
ДД' 2
>
ДД2 3
(
ДД3 4
)
ДД4 5
;
ДД5 6
builder
ЕЕ 
.
ЕЕ 
Services
ЕЕ 
.
ЕЕ 
	AddScoped
ЕЕ &
<
ЕЕ& '
ProductService
ЕЕ' 5
>
ЕЕ5 6
(
ЕЕ6 7
)
ЕЕ7 8
;
ЕЕ8 9
builder
ЖЖ 
.
ЖЖ 
Services
ЖЖ 
.
ЖЖ 
	AddScoped
ЖЖ &
<
ЖЖ& '
TokenGeneration
ЖЖ' 6
>
ЖЖ6 7
(
ЖЖ7 8
)
ЖЖ8 9
;
ЖЖ9 :
builder
ЗЗ 
.
ЗЗ 
Services
ЗЗ 
.
ЗЗ 
	AddScoped
ЗЗ &
<
ЗЗ& '
CategoryService
ЗЗ' 6
>
ЗЗ6 7
(
ЗЗ7 8
)
ЗЗ8 9
;
ЗЗ9 :
builder
ИИ 
.
ИИ 
Services
ИИ 
.
ИИ 
	AddScoped
ИИ &
<
ИИ& '
InventoryService
ИИ' 7
>
ИИ7 8
(
ИИ8 9
)
ИИ9 :
;
ИИ: ;
builder
ЙЙ 
.
ЙЙ 
Services
ЙЙ 
.
ЙЙ 
	AddScoped
ЙЙ &
<
ЙЙ& '
CartService
ЙЙ' 2
>
ЙЙ2 3
(
ЙЙ3 4
)
ЙЙ4 5
;
ЙЙ5 6
builder
КК 
.
КК 
Services
КК 
.
КК 
	AddScoped
КК &
<
КК& '
DiscountService
КК' 6
>
КК6 7
(
КК7 8
)
КК8 9
;
КК9 :
builder
ЛЛ 
.
ЛЛ 
Services
ЛЛ 
.
ЛЛ 
	AddScoped
ЛЛ &
<
ЛЛ& '$
ProductDiscountService
ЛЛ' =
>
ЛЛ= >
(
ЛЛ> ?
)
ЛЛ? @
;
ЛЛ@ A
builder
ММ 
.
ММ 
Services
ММ 
.
ММ 
	AddScoped
ММ &
<
ММ& '
OrderService
ММ' 3
>
ММ3 4
(
ММ4 5
)
ММ5 6
;
ММ6 7
builder
НН 
.
НН 
Services
НН 
.
НН 
	AddScoped
НН &
<
НН& '"
ProductReviewService
НН' ;
>
НН; <
(
НН< =
)
НН= >
;
НН> ?
builder
ОО 
.
ОО 
Services
ОО 
.
ОО 
	AddScoped
ОО &
<
ОО& '#
SalesAnalyticsService
ОО' <
>
ОО< =
(
ОО= >
)
ОО> ?
;
ОО? @
builder
ПП 
.
ПП 
Services
ПП 
.
ПП 
	AddScoped
ПП &
<
ПП& '"
UserAnalyticsService
ПП' ;
>
ПП; <
(
ПП< =
)
ПП= >
;
ПП> ?
builder
РР 
.
РР 
Services
РР 
.
РР 
	AddScoped
РР &
<
РР& '
WishlistService
РР' 6
>
РР6 7
(
РР7 8
)
РР8 9
;
РР9 :
builder
ФФ 
.
ФФ 
Services
ФФ 
.
ФФ 
	AddScoped
ФФ &
<
ФФ& '
IUserRepository
ФФ' 6
,
ФФ6 7
UserRepository
ФФ8 F
>
ФФF G
(
ФФG H
)
ФФH I
;
ФФI J
builder
ХХ 
.
ХХ 
Services
ХХ 
.
ХХ 
	AddScoped
ХХ &
<
ХХ& ' 
IProductRepository
ХХ' 9
,
ХХ9 :
ProductRepository
ХХ; L
>
ХХL M
(
ХХM N
)
ХХN O
;
ХХO P
builder
ЦЦ 
.
ЦЦ 
Services
ЦЦ 
.
ЦЦ 
	AddScoped
ЦЦ &
<
ЦЦ& '
ILoginRepository
ЦЦ' 7
,
ЦЦ7 8
LoginRepository
ЦЦ9 H
>
ЦЦH I
(
ЦЦI J
)
ЦЦJ K
;
ЦЦK L
builder
ЧЧ 
.
ЧЧ 
Services
ЧЧ 
.
ЧЧ 
	AddScoped
ЧЧ &
<
ЧЧ& '!
ICategoryRepository
ЧЧ' :
,
ЧЧ: ; 
CategoryRepository
ЧЧ< N
>
ЧЧN O
(
ЧЧO P
)
ЧЧP Q
;
ЧЧQ R
builder
ШШ 
.
ШШ 
Services
ШШ 
.
ШШ 
	AddScoped
ШШ &
<
ШШ& '"
IInventoryRepository
ШШ' ;
,
ШШ; <!
InventoryRepository
ШШ= P
>
ШШP Q
(
ШШQ R
)
ШШR S
;
ШШS T
builder
ЩЩ 
.
ЩЩ 
Services
ЩЩ 
.
ЩЩ 
	AddScoped
ЩЩ &
<
ЩЩ& '
ICartRepository
ЩЩ' 6
,
ЩЩ6 7
CartRepository
ЩЩ8 F
>
ЩЩF G
(
ЩЩG H
)
ЩЩH I
;
ЩЩI J
builder
ЪЪ 
.
ЪЪ 
Services
ЪЪ 
.
ЪЪ 
	AddScoped
ЪЪ &
<
ЪЪ& '!
IDiscountRepository
ЪЪ' :
,
ЪЪ: ; 
DiscountRepository
ЪЪ< N
>
ЪЪN O
(
ЪЪO P
)
ЪЪP Q
;
ЪЪQ R
builder
ЫЫ 
.
ЫЫ 
Services
ЫЫ 
.
ЫЫ 
	AddScoped
ЫЫ &
<
ЫЫ& '(
IProductDiscountRepository
ЫЫ' A
,
ЫЫA B'
ProductDiscountRepository
ЫЫC \
>
ЫЫ\ ]
(
ЫЫ] ^
)
ЫЫ^ _
;
ЫЫ_ `
builder
ЬЬ 
.
ЬЬ 
Services
ЬЬ 
.
ЬЬ 
	AddScoped
ЬЬ &
<
ЬЬ& '
IOrderRepository
ЬЬ' 7
,
ЬЬ7 8
OrderRepository
ЬЬ9 H
>
ЬЬH I
(
ЬЬI J
)
ЬЬJ K
;
ЬЬK L
builder
ЭЭ 
.
ЭЭ 
Services
ЭЭ 
.
ЭЭ 
	AddScoped
ЭЭ &
<
ЭЭ& '"
IOrderItemRepository
ЭЭ' ;
,
ЭЭ; <!
OrderItemRepository
ЭЭ= P
>
ЭЭP Q
(
ЭЭQ R
)
ЭЭR S
;
ЭЭS T
builder
ЮЮ 
.
ЮЮ 
Services
ЮЮ 
.
ЮЮ 
	AddScoped
ЮЮ &
<
ЮЮ& ' 
IPaymentRepository
ЮЮ' 9
,
ЮЮ9 :
PaymentRepository
ЮЮ; L
>
ЮЮL M
(
ЮЮM N
)
ЮЮN O
;
ЮЮO P
builder
ЯЯ 
.
ЯЯ 
Services
ЯЯ 
.
ЯЯ 
	AddScoped
ЯЯ &
<
ЯЯ& '!
IDiscountRepository
ЯЯ' :
,
ЯЯ: ; 
DiscountRepository
ЯЯ< N
>
ЯЯN O
(
ЯЯO P
)
ЯЯP Q
;
ЯЯQ R
builder
аа 
.
аа 
Services
аа 
.
аа 
	AddScoped
аа &
<
аа& '&
IProductReviewRepository
аа' ?
,
аа? @%
ProductReviewRepository
ааA X
>
ааX Y
(
ааY Z
)
ааZ [
;
аа[ \
builder
бб 
.
бб 
Services
бб 
.
бб 
	AddScoped
бб &
<
бб& ''
ISalesAnalyticsRepository
бб' @
,
бб@ A&
SalesAnalyticsRepository
ббB Z
>
ббZ [
(
бб[ \
)
бб\ ]
;
бб] ^
builder
вв 
.
вв 
Services
вв 
.
вв 
	AddScoped
вв &
<
вв& '&
IUserAnalyticsRepository
вв' ?
,
вв? @%
UserAnalyticsRepository
ввA X
>
ввX Y
(
ввY Z
)
ввZ [
;
вв[ \
builder
гг 
.
гг 
Services
гг 
.
гг 
	AddScoped
гг &
<
гг& ''
ISellerAnalysisRepository
гг' @
,
гг@ A&
SellerAnalysisRepository
ггB Z
>
ггZ [
(
гг[ \
)
гг\ ]
;
гг] ^
builder
дд 
.
дд 
Services
дд 
.
дд 
	AddScoped
дд &
<
дд& '!
IWishlistRepository
дд' :
,
дд: ; 
WishlistRepository
дд< N
>
ддN O
(
ддO P
)
ддP Q
;
ддQ R
var
ии 
loggerRepository
ии  
=
ии! "
log4net
ии# *
.
ии* +

LogManager
ии+ 5
.
ии5 6
GetRepository
ии6 C
(
ииC D
System
ииD J
.
ииJ K

Reflection
ииK U
.
ииU V
Assembly
ииV ^
.
ии^ _
GetEntryAssembly
ии_ o
(
ииo p
)
ииp q
)
ииq r
;
ииr s
log4net
йй 
.
йй 
Config
йй 
.
йй 
XmlConfigurator
йй *
.
йй* +
	Configure
йй+ 4
(
йй4 5
loggerRepository
йй5 E
,
ййE F
new
ййG J
FileInfo
ййK S
(
ййS T
$str
ййT d
)
ййd e
)
ййe f
;
ййf g
builder
лл 
.
лл 
Services
лл 
.
лл 
AddControllers
лл +
(
лл+ ,
)
лл, -
;
лл- .
builder
нн 
.
нн 
Services
нн 
.
нн %
AddEndpointsApiExplorer
нн 4
(
нн4 5
)
нн5 6
;
нн6 7
builder
оо 
.
оо 
Services
оо 
.
оо 
AddSwaggerGen
оо *
(
оо* +
)
оо+ ,
;
оо, -
var
░░ 
app
░░ 
=
░░ 
builder
░░ 
.
░░ 
Build
░░ #
(
░░# $
)
░░$ %
;
░░% &
if
╗╗ 
(
╗╗ 
app
╗╗ 
.
╗╗ 
Environment
╗╗ 
.
╗╗  
IsDevelopment
╗╗  -
(
╗╗- .
)
╗╗. /
)
╗╗/ 0
{
╝╝ 
app
╜╜ 
.
╜╜ 

UseSwagger
╜╜ 
(
╜╜ 
)
╜╜  
;
╜╜  !
app
╛╛ 
.
╛╛ 
UseSwaggerUI
╛╛  
(
╛╛  !
c
╛╛! "
=>
╛╛# %
{
┐┐ 
c
└└ 
.
└└ 
SwaggerEndpoint
└└ %
(
└└% &
$str
└└& @
,
└└@ A
$str
└└B U
)
└└U V
;
└└V W
c
┴┴ 
.
┴┴ 
SwaggerEndpoint
┴┴ %
(
┴┴% &
$str
┴┴& @
,
┴┴@ A
$str
┴┴B U
)
┴┴U V
;
┴┴V W
}
┬┬ 
)
┬┬ 
;
┬┬ 
}
├├ 
else
── 
{
┼┼ 
app
╞╞ 
.
╞╞ !
UseExceptionHandler
╞╞ '
(
╞╞' (
$str
╞╞( 0
)
╞╞0 1
;
╞╞1 2
}
╟╟ 
app
╚╚ 
.
╚╚  
UseStatusCodePages
╚╚ "
(
╚╚" #
async
╚╚# (
context
╚╚) 0
=>
╚╚1 3
{
╔╔ 
var
╩╩ 
response
╩╩ 
=
╩╩ 
context
╩╩ &
.
╩╩& '
HttpContext
╩╩' 2
.
╩╩2 3
Response
╩╩3 ;
;
╩╩; <
if
╦╦ 
(
╦╦ 
response
╦╦ 
.
╦╦ 

StatusCode
╦╦ '
==
╦╦( *
StatusCodes
╦╦+ 6
.
╦╦6 7 
Status403Forbidden
╦╦7 I
)
╦╦I J
{
╠╠ 
response
══ 
.
══ 
ContentType
══ (
=
══) *
$str
══+ =
;
══= >
await
╬╬ 
response
╬╬ "
.
╬╬" #

WriteAsync
╬╬# -
(
╬╬- .
$str
╬╬. v
)
╬╬v w
;
╬╬w x
}
╧╧ 
else
╨╨ 
if
╨╨ 
(
╨╨ 
response
╨╨ !
.
╨╨! "

StatusCode
╨╨" ,
==
╨╨- /
StatusCodes
╨╨0 ;
.
╨╨; <#
Status401Unauthorized
╨╨< Q
)
╨╨Q R
{
╤╤ 
response
╥╥ 
.
╥╥ 
ContentType
╥╥ (
=
╥╥) *
$str
╥╥+ =
;
╥╥= >
await
╙╙ 
response
╙╙ "
.
╙╙" #

WriteAsync
╙╙# -
(
╙╙- .
$str
╙╙. l
)
╙╙l m
;
╙╙m n
}
╘╘ 
}
╒╒ 
)
╒╒ 
;
╒╒ 
app
╫╫ 
.
╫╫ !
UseHttpsRedirection
╫╫ #
(
╫╫# $
)
╫╫$ %
;
╫╫% &
app
╪╪ 
.
╪╪ 
UseCors
╪╪ 
(
╪╪ 
$str
╪╪ (
)
╪╪( )
;
╪╪) *
app
┘┘ 
.
┘┘ 
UseAuthentication
┘┘ !
(
┘┘! "
)
┘┘" #
;
┘┘# $
app
┌┌ 
.
┌┌ 
UseAuthorization
┌┌  
(
┌┌  !
)
┌┌! "
;
┌┌" #
app
▌▌ 
.
▌▌ 
MapControllers
▌▌ 
(
▌▌ 
)
▌▌  
;
▌▌  !
app
▀▀ 
.
▀▀ 
Run
▀▀ 
(
▀▀ 
)
▀▀ 
;
▀▀ 
}
рр 	
}
сс 
}тт ╓B
jD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\WishlistController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[ 
ApiController 
] 
[		 
Route		 

(		
 
$str		 
)		 
]		 
public

 

class

 
WishlistController

 #
:

$ %
ControllerBase

& 4
{ 
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
WishlistControllerG Y
)Y Z
)Z [
;[ \
private 
readonly 
WishlistService (
_wishlistService) 9
;9 :
public 
WishlistController !
(! "
WishlistService" 1
wishlistService2 A
)A B
{ 	
_wishlistService 
= 
wishlistService .
;. /
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str '
)' (
]( )
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
AddToWishlist) 6
(6 7
int7 :
userId; A
,A B
intC F
	productIdG P
)P Q
{ 	
try 
{ 
if 
( 
userId 
<= 
$num 
||  "
	productId# ,
<=- /
$num0 1
)1 2
{ 
log 
. 
Warn 
( 
$" 
$str 5
{5 6
userId6 <
}< =
$str= I
{I J
	productIdJ S
}S T
"T U
)U V
;V W
return 

BadRequest %
(% &
$str& C
)C D
;D E
}   
await"" 
_wishlistService"" &
.""& '
AddToWishlist""' 4
(""4 5
userId""5 ;
,""; <
	productId""= F
)""F G
;""G H
log## 
.## 
Info## 
(## 
$"## 
$str## 2
{##2 3
	productId##3 <
}##< =
$str##= [
{##[ \
userId##\ b
}##b c
$str##c d
"##d e
)##e f
;##f g
return$$ 
Ok$$ 
($$ 
new$$ 
{$$ 
message$$ &
=$$' (
$str$$) R
}$$S T
)$$T U
;$$U V
}%% 
catch&& 
(&& 
	Exception&& 
ex&& 
)&&  
{'' 
log(( 
.(( 
Error(( 
((( 
$"(( 
$str(( E
{((E F
	productId((F O
}((O P
$str((P [
{(([ \
userId((\ b
}((b c
$str((c o
"((o p
,((p q
ex((r t
)((t u
;((u v
return)) 

StatusCode)) !
())! "
$num))" %
,))% &
$str))' Y
)))Y Z
;))Z [
}** 
}++ 	
[,, 	
	Authorize,,	 
(,, 
Roles,, 
=,, 
$str,, '
),,' (
],,( )
[-- 	
HttpGet--	 
(-- 
$str--  
)--  !
]--! "
public.. 
async.. 
Task.. 
<.. 
IActionResult.. '
>..' (
GetUserWishlist..) 8
(..8 9
int..9 <
userId..= C
)..C D
{// 	
try00 
{11 
if22 
(22 
userId22 
<=22 
$num22 
)22  
{33 
log44 
.44 
Warn44 
(44 
$"44 
$str44 .
{44. /
userId44/ 5
}445 6
$str446 7
"447 8
)448 9
;449 :
return55 

BadRequest55 %
(55% &
$str55& 8
)558 9
;559 :
}66 
var88 
wishlist88 
=88 
await88 $
_wishlistService88% 5
.885 6
GetUserWishlist886 E
(88E F
userId88F L
)88L M
;88M N
if:: 
(:: 
wishlist:: 
==:: 
null::  $
||::% '
!::( )
wishlist::) 1
.::1 2
Any::2 5
(::5 6
)::6 7
)::7 8
{;; 
log<< 
.<< 
Warn<< 
(<< 
$"<< 
$str<< <
{<<< =
userId<<= C
}<<C D
$str<<D E
"<<E F
)<<F G
;<<G H
return== 
NotFound== #
(==# $
$str==$ ;
)==; <
;==< =
}>> 
log@@ 
.@@ 
Info@@ 
(@@ 
$"@@ 
$str@@ 7
{@@7 8
userId@@8 >
}@@> ?
$str@@? @
"@@@ A
)@@A B
;@@B C
returnAA 
OkAA 
(AA 
wishlistAA "
)AA" #
;AA# $
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
logEE 
.EE 
ErrorEE 
(EE 
$"EE 
$strEE Q
{EEQ R
userIdEER X
}EEX Y
$strEEY Z
"EEZ [
,EE[ \
exEE] _
)EE_ `
;EE` a
returnFF 

StatusCodeFF !
(FF! "
$numFF" %
,FF% &
$strFF' Y
)FFY Z
;FFZ [
}GG 
}HH 	
[II 	
	AuthorizeII	 
(II 
RolesII 
=II 
$strII '
)II' (
]II( )
[JJ 	

HttpDeleteJJ	 
(JJ 
$strJJ 
)JJ 
]JJ 
publicKK 
asyncKK 
TaskKK 
<KK 
IActionResultKK '
>KK' (
RemoveFromWishlistKK) ;
(KK; <
intKK< ?
userIdKK@ F
,KKF G
intKKH K
	productIdKKL U
)KKU V
{LL 	
tryMM 
{NN 
ifOO 
(OO 
userIdOO 
<=OO 
$numOO 
||OO  "
	productIdOO# ,
<=OO- /
$numOO0 1
)OO1 2
{PP 
logQQ 
.QQ 
WarnQQ 
(QQ 
$"QQ 
$strQQ 5
{QQ5 6
userIdQQ6 <
}QQ< =
$strQQ= I
{QQI J
	productIdQQJ S
}QQS T
"QQT U
)QQU V
;QQV W
returnRR 

BadRequestRR %
(RR% &
$strRR& C
)RRC D
;RRD E
}SS 
awaitUU 
_wishlistServiceUU &
.UU& '
RemoveFromWishlistUU' 9
(UU9 :
userIdUU: @
,UU@ A
	productIdUUB K
)UUK L
;UUL M
logVV 
.VV 
InfoVV 
(VV 
$"VV 
$strVV 2
{VV2 3
	productIdVV3 <
}VV< =
$strVV= _
{VV_ `
userIdVV` f
}VVf g
$strVVg h
"VVh i
)VVi j
;VVj k
returnWW 
OkWW 
(WW 
newWW 
{WW 
messageWW  '
=WW( )
$strWW* U
}WWV W
)WWW X
;WWX Y
}XX 
catchYY 
(YY 
	ExceptionYY 
exYY 
)YY  
{ZZ 
log[[ 
.[[ 
Error[[ 
([[ 
$"[[ 
$str[[ G
{[[G H
	productId[[H Q
}[[Q R
$str[[R _
{[[_ `
userId[[` f
}[[f g
$str[[g s
"[[s t
,[[t u
ex[[v x
)[[x y
;[[y z
return\\ 

StatusCode\\ !
(\\! "
$num\\" %
,\\% &
$str\\' Y
)\\Y Z
;\\Z [
}]] 
}^^ 	
}__ 
}`` ─¤
fD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\UserController.cs
	namespace		 	

EcomWebApp		
 
.		 
Controllers		  
{

 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
UserController 
:  !
ControllerBase" 0
{ 
private 
readonly 
UserService $
_userService% 1
;1 2
private 
readonly 
EmailService %
_emailService& 3
;3 4
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
UserControllerG U
)U V
)V W
;W X
public 
UserController 
( 
UserService )
userService* 5
,5 6
EmailService7 C
emailServiceD P
)P Q
{ 	
_userService 
= 
userService &
;& '
_emailService 
= 
emailService (
;( )
} 	
[ 	
HttpGet	 
( 
$str #
)# $
]$ %
public 
async 
Task 
< 
IActionResult '
>' (
GetUserById) 4
(4 5
int5 8
id9 ;
); <
{ 	
try 
{ 
var 
user 
= 
await  
_userService! -
.- .
GetUserByIdAsync. >
(> ?
id? A
)A B
;B C
if 
( 
user 
== 
null  
)  !
{   
log!! 
.!! 
Warn!! 
(!! 
$"!! 
$str!! ,
{!!, -
id!!- /
}!!/ 0
$str!!0 ;
"!!; <
)!!< =
;!!= >
return"" 
NotFound"" #
(""# $
new""$ '
{""( )
message""* 1
=""2 3
$str""4 E
}""F G
)""G H
;""H I
}## 
log$$ 
.$$ 
Info$$ 
($$ 
$"$$ 
$str$$ ?
{$$? @
id$$@ B
}$$B C
$str$$C D
"$$D E
)$$E F
;$$F G
return%% 
Ok%% 
(%% 
user%% 
)%% 
;%%  
}&& 
catch'' 
('' 
	Exception'' 
ex'' 
)''  
{(( 
log)) 
.)) 
Error)) 
()) 
$")) 
$str)) G
{))G H
id))H J
}))J K
$str))K M
{))M N
ex))N P
.))P Q
Message))Q X
}))X Y
"))Y Z
,))Z [
ex))\ ^
)))^ _
;))_ `
return** 

StatusCode** !
(**! "
$num**" %
,**% &
new**' *
{**+ ,
message**- 4
=**5 6
$str**7 O
}**P Q
)**Q R
;**R S
}++ 
},, 	
[.. 	
HttpGet..	 
(.. 
$str.. /
)../ 0
]..0 1
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (
GetUserByUsername//) :
(//: ;
string//; A
username//B J
)//J K
{00 	
try11 
{22 
var33 
user33 
=33 
await33  
_userService33! -
.33- ."
GetUserByUsernameAsync33. D
(33D E
username33E M
)33M N
;33N O
if44 
(44 
user44 
==44 
null44  
)44  !
{55 
log66 
.66 
Warn66 
(66 
$"66 
$str66 2
{662 3
username663 ;
}66; <
$str66< G
"66G H
)66H I
;66I J
return77 
NotFound77 #
(77# $
new77$ '
{77( )
message77* 1
=772 3
$str774 E
}77F G
)77G H
;77H I
}88 
log99 
.99 
Info99 
(99 
$"99 
$str99 E
{99E F
username99F N
}99N O
$str99O P
"99P Q
)99Q R
;99R S
return:: 
Ok:: 
(:: 
user:: 
):: 
;::  
};; 
catch<< 
(<< 
	Exception<< 
ex<< 
)<<  
{== 
log>> 
.>> 
Error>> 
(>> 
$">> 
$str>> M
{>>M N
username>>N V
}>>V W
$str>>W Y
{>>Y Z
ex>>Z \
.>>\ ]
Message>>] d
}>>d e
">>e f
,>>f g
ex>>h j
)>>j k
;>>k l
return?? 

StatusCode?? !
(??! "
$num??" %
,??% &
new??' *
{??+ ,
message??- 4
=??5 6
$str??7 O
}??P Q
)??Q R
;??R S
}@@ 
}AA 	
[CC 	
HttpGetCC	 
(CC 
$strCC )
)CC) *
]CC* +
publicDD 
asyncDD 
TaskDD 
<DD 
IActionResultDD '
>DD' (
GetUserByEmailDD) 7
(DD7 8
stringDD8 >
emailDD? D
)DDD E
{EE 	
tryFF 
{GG 
varHH 
userHH 
=HH 
awaitHH  
_userServiceHH! -
.HH- .
GetUserByEmailAsyncHH. A
(HHA B
emailHHB G
)HHG H
;HHH I
ifII 
(II 
userII 
==II 
nullII  
)II  !
{JJ 
logKK 
.KK 
WarnKK 
(KK 
$"KK 
$strKK /
{KK/ 0
emailKK0 5
}KK5 6
$strKK6 A
"KKA B
)KKB C
;KKC D
returnLL 
NotFoundLL #
(LL# $
newLL$ '
{LL( )
messageLL* 1
=LL2 3
$strLL4 E
}LLF G
)LLG H
;LLH I
}MM 
logNN 
.NN 
InfoNN 
(NN 
$"NN 
$strNN B
{NNB C
emailNNC H
}NNH I
$strNNI J
"NNJ K
)NNK L
;NNL M
returnOO 
OkOO 
(OO 
userOO 
)OO 
;OO  
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
exQQ 
)QQ  
{RR 
logSS 
.SS 
ErrorSS 
(SS 
$"SS 
$strSS J
{SSJ K
emailSSK P
}SSP Q
$strSSQ S
{SSS T
exSST V
.SSV W
MessageSSW ^
}SS^ _
"SS_ `
,SS` a
exSSb d
)SSd e
;SSe f
returnTT 

StatusCodeTT !
(TT! "
$numTT" %
,TT% &
newTT' *
{TT+ ,
messageTT- 4
=TT5 6
$strTT7 O
}TTP Q
)TTQ R
;TTR S
}UU 
}VV 	
[XX 	
HttpPostXX	 
(XX 
$strXX  
)XX  !
]XX! "
publicYY 
asyncYY 
TaskYY 
<YY 
IActionResultYY '
>YY' (
RegisterUserYY) 5
(YY5 6
[YY6 7
FromBodyYY7 ?
]YY? @
RegisterUserDTOYYA P
userDtoYYQ X
)YYX Y
{ZZ 	
try[[ 
{\\ 
if]] 
(]] 
!]] 

ModelState]] 
.]]  
IsValid]]  '
)]]' (
{^^ 
log__ 
.__ 
Warn__ 
(__ 
$"__ 
$str__ B
"__B C
)__C D
;__D E
return`` 

BadRequest`` %
(``% &

ModelState``& 0
)``0 1
;``1 2
}aa 
varcc 
	newUserIdcc 
=cc 
awaitcc  %
_userServicecc& 2
.cc2 3
RegisterUserAsynccc3 D
(ccD E
userDtoccE L
)ccL M
;ccM N
logdd 
.dd 
Infodd 
(dd 
$"dd 
$strdd C
{ddC D
userDtoddD K
.ddK L
EmailddL Q
}ddQ R
$strddR S
"ddS T
)ddT U
;ddU V
vargg 
emailSubjectgg  
=gg! "
$strgg# 6
;gg6 7
varhh 
	emailBodyhh 
=hh 
$"hh  "
$strhh" %
{hh% &
userDtohh& -
.hh- .
Usernamehh. 6
}hh6 7
$str	hh7 ╗
"
hh╗ ╝
;
hh╝ ╜
awaitii 
_emailServiceii #
.ii# $
SendEmailAsyncii$ 2
(ii2 3
userDtoii3 :
.ii: ;
Emailii; @
,ii@ A
emailSubjectiiB N
,iiN O
	emailBodyiiP Y
)iiY Z
;iiZ [
returnjj 
Okjj 
(jj 
newjj 
{jj 
messagejj  '
=jj( )
$"jj* ,
$strjj, R
{jjR S
	newUserIdjjS \
}jj\ ]
"jj] ^
}jj_ `
)jj` a
;jja b
}kk 
catchll 
(ll 
	Exceptionll 
exll 
)ll  
{mm 
lognn 
.nn 
Errornn 
(nn 
$"nn 
$strnn M
{nnM N
userDtonnN U
.nnU V
EmailnnV [
}nn[ \
$strnn\ ^
{nn^ _
exnn_ a
.nna b
Messagennb i
}nni j
"nnj k
,nnk l
exnnm o
)nno p
;nnp q
returnoo 

StatusCodeoo !
(oo! "
$numoo" %
,oo% &
newoo' *
{oo+ ,
messageoo- 4
=oo5 6
$stroo7 O
}ooP Q
)ooQ R
;ooR S
}pp 
}qq 	
[ss 	
HttpPostss	 
(ss 
$strss "
)ss" #
]ss# $
publictt 
asynctt 
Tasktt 
<tt 
IActionResulttt '
>tt' (
RegisterSellertt) 7
(tt7 8
[tt8 9
FromBodytt9 A
]ttA B
RegisterSellerDTOttC T
	sellerDtottU ^
)tt^ _
{uu 	
tryvv 
{ww 
ifxx 
(xx 
!xx 

ModelStatexx 
.xx  
IsValidxx  '
)xx' (
{yy 
logzz 
.zz 
Warnzz 
(zz 
$"zz 
$strzz B
"zzB C
)zzC D
;zzD E
return{{ 

BadRequest{{ %
({{% &

ModelState{{& 0
){{0 1
;{{1 2
}|| 
var~~ 
newSellerId~~ 
=~~  !
await~~" '
_userService~~( 4
.~~4 5
RegisterSellerAsync~~5 H
(~~H I
	sellerDto~~I R
)~~R S
;~~S T
log
АА 
.
АА 
Info
АА 
(
АА 
$"
АА 
$str
АА E
{
ААE F
	sellerDto
ААF O
.
ААO P
Email
ААP U
}
ААU V
$str
ААV W
"
ААW X
)
ААX Y
;
ААY Z
var
ГГ 
emailSubject
ГГ  
=
ГГ! "
$str
ГГ# 6
;
ГГ6 7
var
ДД 
	emailBody
ДД 
=
ДД 
$"
ДД  "
$str
ДД" %
{
ДД% &
	sellerDto
ДД& /
.
ДД/ 0
Username
ДД0 8
}
ДД8 9
$strДД9 ╤
"ДД╤ ╥
;ДД╥ ╙
await
ЕЕ 
_emailService
ЕЕ #
.
ЕЕ# $
SendEmailAsync
ЕЕ$ 2
(
ЕЕ2 3
	sellerDto
ЕЕ3 <
.
ЕЕ< =
Email
ЕЕ= B
,
ЕЕB C
emailSubject
ЕЕD P
,
ЕЕP Q
	emailBody
ЕЕR [
)
ЕЕ[ \
;
ЕЕ\ ]
return
ЖЖ 
Ok
ЖЖ 
(
ЖЖ 
new
ЖЖ 
{
ЖЖ 
message
ЖЖ  '
=
ЖЖ( )
$"
ЖЖ* ,
$str
ЖЖ, R
{
ЖЖR S
newSellerId
ЖЖS ^
}
ЖЖ^ _
"
ЖЖ_ `
}
ЖЖa b
)
ЖЖb c
;
ЖЖc d
}
ЗЗ 
catch
ИИ 
(
ИИ 
	Exception
ИИ 
ex
ИИ 
)
ИИ  
{
ЙЙ 
log
КК 
.
КК 
Error
КК 
(
КК 
$"
КК 
$str
КК M
{
ККM N
	sellerDto
ККN W
.
ККW X
Email
ККX ]
}
КК] ^
$str
КК^ `
{
КК` a
ex
ККa c
.
ККc d
Message
ККd k
}
ККk l
"
ККl m
,
ККm n
ex
ККo q
)
ККq r
;
ККr s
return
ЛЛ 

StatusCode
ЛЛ !
(
ЛЛ! "
$num
ЛЛ" %
,
ЛЛ% &
new
ЛЛ' *
{
ЛЛ+ ,
message
ЛЛ- 4
=
ЛЛ5 6
$str
ЛЛ7 O
}
ЛЛP Q
)
ЛЛQ R
;
ЛЛR S
}
ММ 
}
НН 	
[
ОО 	
	Authorize
ОО	 
(
ОО 
Roles
ОО 
=
ОО 
$str
ОО "
)
ОО" #
]
ОО# $
[
ПП 	
HttpPut
ПП	 
(
ПП 
$str
ПП "
)
ПП" #
]
ПП# $
public
РР 
async
РР 
Task
РР 
<
РР 
IActionResult
РР '
>
РР' (

UpdateUser
РР) 3
(
РР3 4
[
РР4 5
FromBody
РР5 =
]
РР= >
UserDTO
РР? F
userDto
РРG N
,
РРN O
int
РРP S
id
РРT V
)
РРV W
{
СС 	
try
ТТ 
{
УУ 
if
ФФ 
(
ФФ 
!
ФФ 

ModelState
ФФ 
.
ФФ  
IsValid
ФФ  '
)
ФФ' (
{
ХХ 
log
ЦЦ 
.
ЦЦ 
Warn
ЦЦ 
(
ЦЦ 
$"
ЦЦ 
$str
ЦЦ <
"
ЦЦ< =
)
ЦЦ= >
;
ЦЦ> ?
return
ЧЧ 

BadRequest
ЧЧ %
(
ЧЧ% &

ModelState
ЧЧ& 0
)
ЧЧ0 1
;
ЧЧ1 2
}
ШШ 
await
ЪЪ 
_userService
ЪЪ "
.
ЪЪ" #
UpdateUserAsync
ЪЪ# 2
(
ЪЪ2 3
userDto
ЪЪ3 :
,
ЪЪ: ;
id
ЪЪ< >
)
ЪЪ> ?
;
ЪЪ? @
log
ЫЫ 
.
ЫЫ 
Info
ЫЫ 
(
ЫЫ 
$"
ЫЫ 
$str
ЫЫ =
{
ЫЫ= >
id
ЫЫ> @
}
ЫЫ@ A
$str
ЫЫA B
"
ЫЫB C
)
ЫЫC D
;
ЫЫD E
return
ЬЬ 
Ok
ЬЬ 
(
ЬЬ 
new
ЬЬ 
{
ЬЬ 
message
ЬЬ  '
=
ЬЬ( )
$str
ЬЬ* F
}
ЬЬG H
)
ЬЬH I
;
ЬЬI J
}
ЭЭ 
catch
ЮЮ 
(
ЮЮ "
KeyNotFoundException
ЮЮ '
ex
ЮЮ( *
)
ЮЮ* +
{
ЯЯ 
log
аа 
.
аа 
Warn
аа 
(
аа 
ex
аа 
.
аа 
Message
аа #
)
аа# $
;
аа$ %
return
бб 
NotFound
бб 
(
бб  
new
бб  #
{
бб$ %
message
бб& -
=
бб. /
ex
бб0 2
.
бб2 3
Message
бб3 :
}
бб; <
)
бб< =
;
бб= >
}
вв 
catch
гг 
(
гг 
	Exception
гг 
ex
гг 
)
гг  
{
дд 
log
ее 
.
ее 
Error
ее 
(
ее 
$"
ее 
$str
ее G
{
ееG H
id
ееH J
}
ееJ K
$str
ееK M
{
ееM N
ex
ееN P
.
ееP Q
Message
ееQ X
}
ееX Y
"
ееY Z
,
ееZ [
ex
ее\ ^
)
ее^ _
;
ее_ `
return
жж 

StatusCode
жж !
(
жж! "
$num
жж" %
,
жж% &
new
жж' *
{
жж+ ,
message
жж- 4
=
жж5 6
$str
жж7 O
}
жжP Q
)
жжQ R
;
жжR S
}
зз 
}
ии 	
[
йй 	
	Authorize
йй	 
(
йй 
Roles
йй 
=
йй 
$str
йй "
)
йй" #
]
йй# $
[
кк 	

HttpDelete
кк	 
(
кк 
$str
кк %
)
кк% &
]
кк& '
public
лл 
async
лл 
Task
лл 
<
лл 
IActionResult
лл '
>
лл' (

DeleteUser
лл) 3
(
лл3 4
int
лл4 7
id
лл8 :
)
лл: ;
{
мм 	
try
нн 
{
оо 
await
пп 
_userService
пп "
.
пп" #
DeleteUserAsync
пп# 2
(
пп2 3
id
пп3 5
)
пп5 6
;
пп6 7
log
░░ 
.
░░ 
Info
░░ 
(
░░ 
$"
░░ 
$str
░░ =
{
░░= >
id
░░> @
}
░░@ A
$str
░░A B
"
░░B C
)
░░C D
;
░░D E
return
▒▒ 
Ok
▒▒ 
(
▒▒ 
new
▒▒ 
{
▒▒ 
message
▒▒  '
=
▒▒( )
$str
▒▒* F
}
▒▒G H
)
▒▒H I
;
▒▒I J
}
▓▓ 
catch
││ 
(
││ 
	Exception
││ 
ex
││ 
)
││  
{
┤┤ 
log
╡╡ 
.
╡╡ 
Error
╡╡ 
(
╡╡ 
$"
╡╡ 
$str
╡╡ G
{
╡╡G H
id
╡╡H J
}
╡╡J K
$str
╡╡K M
{
╡╡M N
ex
╡╡N P
.
╡╡P Q
Message
╡╡Q X
}
╡╡X Y
"
╡╡Y Z
,
╡╡Z [
ex
╡╡\ ^
)
╡╡^ _
;
╡╡_ `
return
╢╢ 

StatusCode
╢╢ !
(
╢╢! "
$num
╢╢" %
,
╢╢% &
new
╢╢' *
{
╢╢+ ,
message
╢╢- 4
=
╢╢5 6
$str
╢╢7 O
}
╢╢P Q
)
╢╢Q R
;
╢╢R S
}
╖╖ 
}
╕╕ 	
[
║║ 	
HttpPut
║║	 
(
║║ 
$str
║║ !
)
║║! "
]
║║" #
public
╗╗ 
async
╗╗ 
Task
╗╗ 
<
╗╗ 
IActionResult
╗╗ '
>
╗╗' ( 
UpdateAddressAsync
╗╗) ;
(
╗╗; <
int
╗╗< ?
userId
╗╗@ F
,
╗╗F G

AddressDTO
╗╗H R

addressDto
╗╗S ]
)
╗╗] ^
{
╝╝ 	
try
╜╜ 
{
╛╛ 
log
┐┐ 
.
┐┐ 
Info
┐┐ 
(
┐┐ 
$"
┐┐ 
$str
┐┐ 9
{
┐┐9 :
userId
┐┐: @
}
┐┐@ A
"
┐┐A B
)
┐┐B C
;
┐┐C D
await
└└ 
_userService
└└ "
.
└└" # 
UpdateAddressAsync
└└# 5
(
└└5 6
userId
└└6 <
,
└└< =

addressDto
└└> H
)
└└H I
;
└└I J
log
┴┴ 
.
┴┴ 
Info
┴┴ 
(
┴┴ 
$"
┴┴ 
$str
┴┴ E
{
┴┴E F
userId
┴┴F L
}
┴┴L M
"
┴┴M N
)
┴┴N O
;
┴┴O P
return
┬┬ 
Ok
┬┬ 
(
┬┬ 
$str
┬┬ 9
)
┬┬9 :
;
┬┬: ;
}
├├ 
catch
── 
(
── #
UserNotFoundException
── (
ex
──) +
)
──+ ,
{
┼┼ 
log
╞╞ 
.
╞╞ 
Warn
╞╞ 
(
╞╞ 
$"
╞╞ 
$str
╞╞ ?
{
╞╞? @
userId
╞╞@ F
}
╞╞F G
$str
╞╞G R
"
╞╞R S
)
╞╞S T
;
╞╞T U
return
╟╟ 
NotFound
╟╟ 
(
╟╟  
ex
╟╟  "
.
╟╟" #
Message
╟╟# *
)
╟╟* +
;
╟╟+ ,
}
╚╚ 
catch
╔╔ 
(
╔╔ 
	Exception
╔╔ 
ex
╔╔ 
)
╔╔  
{
╩╩ 
log
╦╦ 
.
╦╦ 
Error
╦╦ 
(
╦╦ 
$"
╦╦ 
$str
╦╦ F
{
╦╦F G
userId
╦╦G M
}
╦╦M N
"
╦╦N O
,
╦╦O P
ex
╦╦Q S
)
╦╦S T
;
╦╦T U
return
╠╠ 

StatusCode
╠╠ !
(
╠╠! "
$num
╠╠" %
,
╠╠% &
$str
╠╠' V
)
╠╠V W
;
╠╠W X
}
══ 
}
╬╬ 	
[
╤╤ 	
HttpPut
╤╤	 
(
╤╤ 
$str
╤╤ (
)
╤╤( )
]
╤╤) *
public
╥╥ 
async
╥╥ 
Task
╥╥ 
<
╥╥ 
IActionResult
╥╥ '
>
╥╥' (&
UpdateSellerDetailsAsync
╥╥) A
(
╥╥A B
int
╥╥B E
userId
╥╥F L
,
╥╥L M
SellerDetailsDTO
╥╥N ^
sellerDetailsDto
╥╥_ o
)
╥╥o p
{
╙╙ 	
try
╘╘ 
{
╒╒ 
log
╓╓ 
.
╓╓ 
Info
╓╓ 
(
╓╓ 
$"
╓╓ 
$str
╓╓ @
{
╓╓@ A
userId
╓╓A G
}
╓╓G H
"
╓╓H I
)
╓╓I J
;
╓╓J K
await
╫╫ 
_userService
╫╫ "
.
╫╫" #&
UpdateSellerDetailsAsync
╫╫# ;
(
╫╫; <
userId
╫╫< B
,
╫╫B C
sellerDetailsDto
╫╫D T
)
╫╫T U
;
╫╫U V
log
╪╪ 
.
╪╪ 
Info
╪╪ 
(
╪╪ 
$"
╪╪ 
$str
╪╪ L
{
╪╪L M
userId
╪╪M S
}
╪╪S T
"
╪╪T U
)
╪╪U V
;
╪╪V W
return
┘┘ 
Ok
┘┘ 
(
┘┘ 
$str
┘┘ @
)
┘┘@ A
;
┘┘A B
}
┌┌ 
catch
██ 
(
██ #
UserNotFoundException
██ (
ex
██) +
)
██+ ,
{
▄▄ 
log
▌▌ 
.
▌▌ 
Warn
▌▌ 
(
▌▌ 
$"
▌▌ 
$str
▌▌ ?
{
▌▌? @
userId
▌▌@ F
}
▌▌F G
$str
▌▌G R
"
▌▌R S
)
▌▌S T
;
▌▌T U
return
▐▐ 
NotFound
▐▐ 
(
▐▐  
ex
▐▐  "
.
▐▐" #
Message
▐▐# *
)
▐▐* +
;
▐▐+ ,
}
▀▀ 
catch
рр 
(
рр 
	Exception
рр 
ex
рр 
)
рр  
{
сс 
log
тт 
.
тт 
Error
тт 
(
тт 
$"
тт 
$str
тт M
{
ттM N
userId
ттN T
}
ттT U
"
ттU V
,
ттV W
ex
ттX Z
)
ттZ [
;
тт[ \
return
уу 

StatusCode
уу !
(
уу! "
$num
уу" %
,
уу% &
$str
уу' Y
)
ууY Z
;
ууZ [
}
фф 
}
хх 	
[
цц 	
	Authorize
цц	 
(
цц 
Roles
цц 
=
цц 
$str
цц "
)
цц" #
]
цц# $
[
шш 	
HttpGet
шш	 
(
шш 
$str
шш  
)
шш  !
]
шш! "
public
щщ 
async
щщ 
Task
щщ 
<
щщ 
IActionResult
щщ '
>
щщ' (
GetAllUsersAsync
щщ) 9
(
щщ9 :
)
щщ: ;
{
ъъ 	
try
ыы 
{
ьь 
log
ээ 
.
ээ 
Info
ээ 
(
ээ 
$str
ээ .
)
ээ. /
;
ээ/ 0
var
юю 
users
юю 
=
юю 
await
юю !
_userService
юю" .
.
юю. /
GetAllUsersAsync
юю/ ?
(
юю? @
)
юю@ A
;
ююA B
log
яя 
.
яя 
Info
яя 
(
яя 
$str
яя 6
)
яя6 7
;
яя7 8
return
ЁЁ 
Ok
ЁЁ 
(
ЁЁ 
users
ЁЁ 
)
ЁЁ  
;
ЁЁ  !
}
ёё 
catch
ЄЄ 
(
ЄЄ 
	Exception
ЄЄ 
ex
ЄЄ 
)
ЄЄ  
{
єє 
log
ЇЇ 
.
ЇЇ 
Error
ЇЇ 
(
ЇЇ 
$str
ЇЇ 7
,
ЇЇ7 8
ex
ЇЇ9 ;
)
ЇЇ; <
;
ЇЇ< =
return
її 

StatusCode
її !
(
її! "
$num
її" %
,
її% &
$str
її' P
)
їїP Q
;
їїQ R
}
ЎЎ 
}
ўў 	
[
∙∙ 	
	Authorize
∙∙	 
(
∙∙ 
Roles
∙∙ 
=
∙∙ 
$str
∙∙ '
)
∙∙' (
]
∙∙( )
[
√√ 	
HttpGet
√√	 
(
√√ 
$str
√√ '
)
√√' (
]
√√( )
public
№№ 
IActionResult
№№ "
GetAddressesByUserId
№№ 1
(
№№1 2
int
№№2 5
userId
№№6 <
)
№№< =
{
¤¤ 	
try
■■ 
{
   
log
АА 
.
АА 
Info
АА 
(
АА 
$"
АА 
$str
АА =
{
АА= >
userId
АА> D
}
ААD E
"
ААE F
)
ААF G
;
ААG H
var
ББ 
	addresses
ББ 
=
ББ 
_userService
ББ  ,
.
ББ, -"
GetAddressesByUserId
ББ- A
(
ББA B
userId
ББB H
)
ББH I
;
ББI J
if
ГГ 
(
ГГ 
!
ГГ 
	addresses
ГГ 
.
ГГ 
Any
ГГ "
(
ГГ" #
)
ГГ# $
)
ГГ$ %
{
ДД 
log
ЕЕ 
.
ЕЕ 
Warn
ЕЕ 
(
ЕЕ 
$"
ЕЕ 
$str
ЕЕ M
{
ЕЕM N
userId
ЕЕN T
}
ЕЕT U
"
ЕЕU V
)
ЕЕV W
;
ЕЕW X
return
ЖЖ 
NotFound
ЖЖ #
(
ЖЖ# $
$str
ЖЖ$ L
)
ЖЖL M
;
ЖЖM N
}
ЗЗ 
return
ЙЙ 
Ok
ЙЙ 
(
ЙЙ 
	addresses
ЙЙ #
)
ЙЙ# $
;
ЙЙ$ %
}
КК 
catch
ЛЛ 
(
ЛЛ 
	Exception
ЛЛ 
ex
ЛЛ 
)
ЛЛ  
{
ММ 
return
НН 

StatusCode
НН !
(
НН! "
$num
НН" %
,
НН% &
$"
НН' )
$str
НН) Q
{
ННQ R
userId
ННR X
}
ННX Y
"
ННY Z
)
ННZ [
;
НН[ \
}
ОО 
}
ПП 	
[
СС 	
	Authorize
СС	 
(
СС 
Roles
СС 
=
СС 
$str
СС )
)
СС) *
]
СС* +
[
УУ 	
HttpGet
УУ	 
(
УУ 
$str
УУ )
)
УУ) *
]
УУ* +
public
ФФ 
async
ФФ 
Task
ФФ 
<
ФФ 
IActionResult
ФФ '
>
ФФ' (
GetSellerByUserId
ФФ) :
(
ФФ: ;
int
ФФ; >
userId
ФФ? E
)
ФФE F
{
ХХ 	
try
ЦЦ 
{
ЧЧ 
var
ШШ 
seller
ШШ 
=
ШШ 
await
ШШ "
_userService
ШШ# /
.
ШШ/ 0$
GetSellerByUserIdAsync
ШШ0 F
(
ШШF G
userId
ШШG M
)
ШШM N
;
ШШN O
if
ЩЩ 
(
ЩЩ 
seller
ЩЩ 
==
ЩЩ 
null
ЩЩ "
)
ЩЩ" #
{
ЪЪ 
log
ЫЫ 
.
ЫЫ 
Info
ЫЫ 
(
ЫЫ 
$"
ЫЫ 
$str
ЫЫ ;
{
ЫЫ; <
userId
ЫЫ< B
}
ЫЫB C
"
ЫЫC D
)
ЫЫD E
;
ЫЫE F
return
ЬЬ 
NotFound
ЬЬ #
(
ЬЬ# $
$"
ЬЬ$ &
$str
ЬЬ& B
{
ЬЬB C
userId
ЬЬC I
}
ЬЬI J
"
ЬЬJ K
)
ЬЬK L
;
ЬЬL M
}
ЭЭ 
return
ЮЮ 
Ok
ЮЮ 
(
ЮЮ 
seller
ЮЮ  
)
ЮЮ  !
;
ЮЮ! "
}
ЯЯ 
catch
аа 
(
аа 
	Exception
аа 
ex
аа 
)
аа  
{
бб 
log
вв 
.
вв 
Error
вв 
(
вв 
$"
вв 
$str
вв >
{
вв> ?
userId
вв? E
}
ввE F
$str
ввF S
{
ввS T
ex
ввT V
.
ввV W
Message
ввW ^
}
вв^ _
"
вв_ `
)
вв` a
;
ввa b
return
гг 

StatusCode
гг !
(
гг! "
$num
гг" %
,
гг% &
$str
гг' ?
)
гг? @
;
гг@ A
}
дд 
}
ее 	
[
зз 	
	Authorize
зз	 
(
зз 
Roles
зз 
=
зз 
$str
зз .
)
зз. /
]
зз/ 0
[
йй 	
HttpGet
йй	 
(
йй 
$str
йй 
)
йй 
]
йй 
public
кк 
async
кк 
Task
кк 
<
кк 
IActionResult
кк '
>
кк' (
GetUserProfile
кк) 7
(
кк7 8
int
кк8 ;
userId
кк< B
)
ккB C
{
лл 	
try
мм 
{
нн 
var
оо 
userProfile
оо 
=
оо  !
await
оо" '
_userService
оо( 4
.
оо4 5!
GetUserProfileAsync
оо5 H
(
ооH I
userId
ооI O
)
ооO P
;
ооP Q
if
пп 
(
пп 
userProfile
пп 
==
пп  "
null
пп# '
)
пп' (
{
░░ 
return
▒▒ 
NotFound
▒▒ #
(
▒▒# $
)
▒▒$ %
;
▒▒% &
}
▓▓ 
return
││ 
Ok
││ 
(
││ 
userProfile
││ %
)
││% &
;
││& '
}
┤┤ 
catch
╡╡ 
(
╡╡ 
	Exception
╡╡ 
ex
╡╡ 
)
╡╡  
{
╢╢ 
log
╖╖ 
.
╖╖ 
Error
╖╖ 
(
╖╖ 
$str
╖╖ 9
,
╖╖9 :
ex
╖╖; =
)
╖╖= >
;
╖╖> ?
return
╕╕ 

StatusCode
╕╕ !
(
╕╕! "
$num
╕╕" %
,
╕╕% &
$str
╕╕' >
)
╕╕> ?
;
╕╕? @
}
╣╣ 
}
║║ 	
[
╝╝ 	
	Authorize
╝╝	 
(
╝╝ 
Roles
╝╝ 
=
╝╝ 
$str
╝╝ .
)
╝╝. /
]
╝╝/ 0
[
╛╛ 	
HttpPut
╛╛	 
]
╛╛ 
public
┐┐ 
async
┐┐ 
Task
┐┐ 
<
┐┐ 
IActionResult
┐┐ '
>
┐┐' (
UpdateUserProfile
┐┐) :
(
┐┐: ;
[
┐┐; <
FromBody
┐┐< D
]
┐┐D E
UserProfileDto
┐┐F T
userProfileDto
┐┐U c
)
┐┐c d
{
└└ 	
try
┴┴ 
{
┬┬ 
if
├├ 
(
├├ 
userProfileDto
├├ "
==
├├# %
null
├├& *
||
├├+ -
userProfileDto
├├. <
.
├├< =
UserId
├├= C
<=
├├D F
$num
├├G H
)
├├H I
{
── 
return
┼┼ 

BadRequest
┼┼ %
(
┼┼% &
$str
┼┼& 9
)
┼┼9 :
;
┼┼: ;
}
╞╞ 
await
╚╚ 
_userService
╚╚ "
.
╚╚" #$
UpdateUserProfileAsync
╚╚# 9
(
╚╚9 :
userProfileDto
╚╚: H
)
╚╚H I
;
╚╚I J
return
╔╔ 
	NoContent
╔╔  
(
╔╔  !
)
╔╔! "
;
╔╔" #
}
╩╩ 
catch
╦╦ 
(
╦╦ 
	Exception
╦╦ 
ex
╦╦ 
)
╦╦  
{
╠╠ 
log
══ 
.
══ 
Error
══ 
(
══ 
$str
══ 7
,
══7 8
ex
══9 ;
)
══; <
;
══< =
return
╬╬ 

StatusCode
╬╬ !
(
╬╬! "
$num
╬╬" %
,
╬╬% &
$str
╬╬' >
)
╬╬> ?
;
╬╬? @
}
╧╧ 
}
╨╨ 	
}
╤╤ 
}╥╥ З0
oD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\UserAnalyticsController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
AnalyticsController		 $
:		% &
ControllerBase		' 5
{

 
private 
readonly  
UserAnalyticsService -
_analyticsService. ?
;? @
private 
readonly 
ILog 
_logger %
;% &
public 
AnalyticsController "
(" # 
UserAnalyticsService# 7
analyticsService8 H
)H I
{ 	
_analyticsService 
= 
analyticsService  0
;0 1
_logger 
= 

LogManager  
.  !
	GetLogger! *
(* +
typeof+ 1
(1 2
AnalyticsController2 E
)E F
)F G
;G H
} 	
[ 	
HttpGet	 
( 
$str +
)+ ,
], -
public 
IActionResult %
GetTotalUserRegistrations 6
(6 7
)7 8
{ 	
try 
{ 
var 

totalUsers 
=  
_analyticsService! 2
.2 3%
GetTotalUserRegistrations3 L
(L M
)M N
;N O
_logger 
. 
Info 
( 
$str M
)M N
;N O
return 
Ok 
( 

totalUsers $
)$ %
;% &
} 
catch 
( 
	Exception 
ex 
)  
{ 
_logger 
. 
Error 
( 
$str H
,H I
exJ L
)L M
;M N
return   

StatusCode   !
(  ! "
$num  " %
,  % &
ex  ' )
.  ) *
Message  * 1
)  1 2
;  2 3
}!! 
}"" 	
[$$ 	
HttpGet$$	 
($$ 
$str$$ -
)$$- .
]$$. /
public%% 
IActionResult%% '
GetTotalSellerRegistrations%% 8
(%%8 9
)%%9 :
{&& 	
try'' 
{(( 
var)) 
totalSellers))  
=))! "
_analyticsService))# 4
.))4 5'
GetTotalSellerRegistrations))5 P
())P Q
)))Q R
;))R S
_logger** 
.** 
Info** 
(** 
$str** O
)**O P
;**P Q
return++ 
Ok++ 
(++ 
totalSellers++ &
)++& '
;++' (
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)--  
{.. 
_logger// 
.// 
Error// 
(// 
$str// J
,//J K
ex//L N
)//N O
;//O P
return00 

StatusCode00 !
(00! "
$num00" %
,00% &
ex00' )
.00) *
Message00* 1
)001 2
;002 3
}11 
}22 	
[44 	
HttpGet44	 
(44 
$str44 #
)44# $
]44$ %
public55 
IActionResult55 
GetTopActiveUsers55 .
(55. /
[55/ 0
	FromQuery550 9
]559 :
int55; >
topN55? C
)55C D
{66 	
try77 
{88 
var99 
topActiveUsers99 "
=99# $
_analyticsService99% 6
.996 7
GetTopActiveUsers997 H
(99H I
topN99I M
)99M N
;99N O
_logger:: 
.:: 
Info:: 
(:: 
$":: 
$str:: +
{::+ ,
topN::, 0
}::0 1
$str::1 L
"::L M
)::M N
;::N O
return;; 
Ok;; 
(;; 
topActiveUsers;; (
);;( )
;;;) *
}<< 
catch== 
(== 
	Exception== 
ex== 
)==  
{>> 
_logger?? 
.?? 
Error?? 
(?? 
$"??  
$str??  3
{??3 4
topN??4 8
}??8 9
$str??9 G
"??G H
,??H I
ex??J L
)??L M
;??M N
return@@ 

StatusCode@@ !
(@@! "
$num@@" %
,@@% &
ex@@' )
.@@) *
Message@@* 1
)@@1 2
;@@2 3
}AA 
}BB 	
[DD 	
HttpGetDD	 
(DD 
$strDD $
)DD$ %
]DD% &
publicEE 
IActionResultEE 
GetUserActivityLogEE /
(EE/ 0
)EE0 1
{FF 	
tryGG 
{HH 
varII 
activityLogII 
=II  !
_analyticsServiceII" 3
.II3 4
GetUserActivityLogII4 F
(IIF G
)IIG H
;IIH I
_loggerJJ 
.JJ 
InfoJJ 
(JJ 
$"JJ 
$strJJ K
"JJK L
)JJL M
;JJM N
returnKK 
OkKK 
(KK 
activityLogKK %
)KK% &
;KK& '
}LL 
catchMM 
(MM 
	ExceptionMM 
exMM 
)MM  
{NN 
_loggerOO 
.OO 
ErrorOO 
(OO 
$"OO  
$strOO  E
"OOE F
,OOF G
exOOH J
)OOJ K
;OOK L
returnPP 

StatusCodePP !
(PP! "
$numPP" %
,PP% &
exPP' )
.PP) *
MessagePP* 1
)PP1 2
;PP2 3
}QQ 
}RR 	
}SS 
}UU эЖ
pD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\SalesAnalyticsController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[

 
ApiController

 
]

 
[ 
Route 

(
 
$str 
) 
] 
public 

class $
SalesAnalyticsController )
:* +
ControllerBase, :
{ 
private 
readonly !
SalesAnalyticsService ."
_salesAnalyticsService/ E
;E F
private 
readonly 
OrderService %
_orderService& 3
;3 4
private 
static 
readonly 
ILog  $
_logger% ,
=- .

LogManager/ 9
.9 :
	GetLogger: C
(C D
typeofD J
(J K$
SalesAnalyticsControllerK c
)c d
)d e
;e f
public $
SalesAnalyticsController '
(' (!
SalesAnalyticsService( =!
salesAnalyticsService> S
,S T
OrderServiceU a
orderServiceb n
)n o
{ 	"
_salesAnalyticsService "
=# $!
salesAnalyticsService% :
;: ;
_orderService 
= 
orderService (
;( )
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str "
)" #
]# $
[ 	
HttpGet	 
( 
$str "
)" #
]# $
public 
IActionResult 
GetSalesByCategory /
(/ 0
)0 1
{ 	
try 
{ 
var 
result 
= "
_salesAnalyticsService 3
.3 4
GetSalesByCategory4 F
(F G
)G H
;H I
return 
Ok 
( 
result  
)  !
;! "
}   
catch!! 
(!! 
	Exception!! 
ex!! 
)!!  
{"" 
_logger## 
.## 
Error## 
(## 
$str## E
,##E F
ex##G I
)##I J
;##J K
return$$ 

StatusCode$$ !
($$! "
$num$$" %
,$$% &
$str$$' ?
)$$? @
;$$@ A
}%% 
}&& 	
['' 	
	Authorize''	 
('' 
Roles'' 
='' 
$str'' "
)''" #
]''# $
[(( 	
HttpGet((	 
((( 
$str(( !
)((! "
]((" #
public)) 
IActionResult)) 
GetSalesByProduct)) .
()). /
)))/ 0
{** 	
try++ 
{,, 
var-- 
result-- 
=-- "
_salesAnalyticsService-- 3
.--3 4
GetSalesByProduct--4 E
(--E F
)--F G
;--G H
return.. 
Ok.. 
(.. 
result..  
)..  !
;..! "
}// 
catch00 
(00 
	Exception00 
ex00 
)00  
{11 
_logger22 
.22 
Error22 
(22 
$str22 D
,22D E
ex22F H
)22H I
;22I J
return33 

StatusCode33 !
(33! "
$num33" %
,33% &
$str33' ?
)33? @
;33@ A
}44 
}55 	
[66 	
	Authorize66	 
(66 
Roles66 
=66 
$str66 "
)66" #
]66# $
[77 	
HttpGet77	 
(77 
$str77  
)77  !
]77! "
public88 
IActionResult88 
GetSalesBySeller88 -
(88- .
)88. /
{99 	
try:: 
{;; 
var<< 
result<< 
=<< "
_salesAnalyticsService<< 3
.<<3 4
GetSalesBySeller<<4 D
(<<D E
)<<E F
;<<F G
return== 
Ok== 
(== 
result==  
)==  !
;==! "
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
_loggerAA 
.AA 
ErrorAA 
(AA 
$strAA C
,AAC D
exAAE G
)AAG H
;AAH I
returnBB 

StatusCodeBB !
(BB! "
$numBB" %
,BB% &
$strBB' ?
)BB? @
;BB@ A
}CC 
}DD 	
[FF 	
	AuthorizeFF	 
(FF 
RolesFF 
=FF 
$strFF "
)FF" #
]FF# $
[GG 	
HttpGetGG	 
(GG 
$strGG 
)GG 
]GG 
publicHH 
IActionResultHH 
GetDailySalesHH *
(HH* +
)HH+ ,
{II 	
tryJJ 
{KK 
varLL 
resultLL 
=LL "
_salesAnalyticsServiceLL 3
.LL3 4
GetDailySalesLL4 A
(LLA B
)LLB C
;LLC D
returnMM 
OkMM 
(MM 
resultMM  
)MM  !
;MM! "
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
_loggerQQ 
.QQ 
ErrorQQ 
(QQ 
$strQQ @
,QQ@ A
exQQB D
)QQD E
;QQE F
returnRR 

StatusCodeRR !
(RR! "
$numRR" %
,RR% &
$strRR' ?
)RR? @
;RR@ A
}SS 
}TT 	
[VV 	
	AuthorizeVV	 
(VV 
RolesVV 
=VV 
$strVV "
)VV" #
]VV# $
[WW 	
HttpGetWW	 
(WW 
$strWW %
)WW% &
]WW& '
publicXX 
IActionResultXX !
GetTopSellingProductsXX 2
(XX2 3
)XX3 4
{YY 	
tryZZ 
{[[ 
var\\ 
result\\ 
=\\ "
_salesAnalyticsService\\ 3
.\\3 4!
GetTopSellingProducts\\4 I
(\\I J
)\\J K
;\\K L
return]] 
Ok]] 
(]] 
result]]  
)]]  !
;]]! "
}^^ 
catch__ 
(__ 
	Exception__ 
ex__ 
)__  
{`` 
_loggeraa 
.aa 
Erroraa 
(aa 
$straa H
,aaH I
exaaJ L
)aaL M
;aaM N
returnbb 

StatusCodebb !
(bb! "
$numbb" %
,bb% &
$strbb' ?
)bb? @
;bb@ A
}cc 
}dd 	
[ff 	
	Authorizeff	 
(ff 
Rolesff 
=ff 
$strff "
)ff" #
]ff# $
[hh 	
HttpGethh	 
(hh 
$strhh 
)hh  
]hh  !
publicii 
asyncii 
Taskii 
<ii 
IActionResultii '
>ii' (
GetTotalRevenueii) 8
(ii8 9
)ii9 :
{jj 	
trykk 
{ll 
varmm 
totalRevenuemm  
=mm! "
awaitmm# (
_orderServicemm) 6
.mm6 7 
GetTotalRevenueAsyncmm7 K
(mmK L
)mmL M
;mmM N
returnnn 
Oknn 
(nn 
newnn 
{nn 
TotalRevenuenn  ,
=nn- .
totalRevenuenn/ ;
}nn< =
)nn= >
;nn> ?
}oo 
catchpp 
(pp 
	Exceptionpp 
expp 
)pp  
{qq 
returnrr 

StatusCoderr !
(rr! "
$numrr" %
,rr% &
$"rr' )
$strrr) @
{rr@ A
exrrA C
.rrC D
MessagerrD K
}rrK L
"rrL M
)rrM N
;rrN O
}ss 
}tt 	
[vv 	
	Authorizevv	 
(vv 
Rolesvv 
=vv 
$strvv )
)vv) *
]vv* +
[xx 	
HttpGetxx	 
(xx 
$strxx +
)xx+ ,
]xx, -
publicyy 
asyncyy 
Taskyy 
<yy 
IActionResultyy '
>yy' (#
GetTotalRevenueBySelleryy) @
(yy@ A
intyyA D
sellerIdyyE M
)yyM N
{zz 	
try{{ 
{|| 
var}}  
totalRevenueBySeller}} (
=}}) *
await}}+ 0
_orderService}}1 >
.}}> ?(
GetTotalRevenueBySellerAsync}}? [
(}}[ \
sellerId}}\ d
)}}d e
;}}e f
return~~ 
Ok~~ 
(~~ 
new~~ 
{~~ 
SellerId~~  (
=~~) *
sellerId~~+ 3
,~~3 4
TotalRevenue~~5 A
=~~B C 
totalRevenueBySeller~~D X
}~~Y Z
)~~Z [
;~~[ \
} 
catch
АА 
(
АА 
	Exception
АА 
ex
АА 
)
АА  
{
ББ 
return
ГГ 

StatusCode
ГГ !
(
ГГ! "
$num
ГГ" %
,
ГГ% &
$"
ГГ' )
$str
ГГ) @
{
ГГ@ A
ex
ГГA C
.
ГГC D
Message
ГГD K
}
ГГK L
"
ГГL M
)
ГГM N
;
ГГN O
}
ДД 
}
ЕЕ 	
[
ЗЗ 	
	Authorize
ЗЗ	 
(
ЗЗ 
Roles
ЗЗ 
=
ЗЗ 
$str
ЗЗ )
)
ЗЗ) *
]
ЗЗ* +
[
ИИ 	
HttpGet
ИИ	 
(
ИИ 
$str
ИИ .
)
ИИ. /
]
ИИ/ 0
public
ЙЙ 
async
ЙЙ 
Task
ЙЙ 
<
ЙЙ 
IActionResult
ЙЙ '
>
ЙЙ' (
GetSalesByProduct
ЙЙ) :
(
ЙЙ: ;
int
ЙЙ; >
sellerId
ЙЙ? G
)
ЙЙG H
{
КК 	
try
ЛЛ 
{
ММ 
_logger
НН 
.
НН 
Info
НН 
(
НН 
$"
НН 
$str
НН G
{
ННG H
sellerId
ННH P
}
ННP Q
"
ННQ R
)
ННR S
;
ННS T
var
ОО 
salesByProduct
ОО "
=
ОО# $
await
ОО% *$
_salesAnalyticsService
ОО+ A
.
ООA B$
GetSalesByProductAsync
ООB X
(
ООX Y
sellerId
ООY a
)
ООa b
;
ООb c
if
РР 
(
РР 
salesByProduct
РР "
==
РР# %
null
РР& *
||
РР+ -
!
РР. /
salesByProduct
РР/ =
.
РР= >
Any
РР> A
(
РРA B
)
РРB C
)
РРC D
{
СС 
_logger
ТТ 
.
ТТ 
Warn
ТТ  
(
ТТ  !
$"
ТТ! #
$str
ТТ# E
{
ТТE F
sellerId
ТТF N
}
ТТN O
"
ТТO P
)
ТТP Q
;
ТТQ R
return
УУ 
NotFound
УУ #
(
УУ# $
$"
УУ$ &
$str
УУ& M
{
УУM N
sellerId
УУN V
}
УУV W
$str
УУW X
"
УУX Y
)
УУY Z
;
УУZ [
}
ФФ 
return
ЦЦ 
Ok
ЦЦ 
(
ЦЦ 
salesByProduct
ЦЦ (
)
ЦЦ( )
;
ЦЦ) *
}
ЧЧ 
catch
ШШ 
(
ШШ 
	Exception
ШШ 
ex
ШШ 
)
ШШ  
{
ЩЩ 
_logger
ЪЪ 
.
ЪЪ 
Error
ЪЪ 
(
ЪЪ 
$"
ЪЪ  
$str
ЪЪ  `
{
ЪЪ` a
sellerId
ЪЪa i
}
ЪЪi j
"
ЪЪj k
,
ЪЪk l
ex
ЪЪm o
)
ЪЪo p
;
ЪЪp q
return
ЫЫ 

StatusCode
ЫЫ !
(
ЫЫ! "
StatusCodes
ЫЫ" -
.
ЫЫ- .*
Status500InternalServerError
ЫЫ. J
,
ЫЫJ K
$str
ЫЫL ~
)
ЫЫ~ 
;ЫЫ А
}
ЬЬ 
}
ЭЭ 	
[
ЯЯ 	
	Authorize
ЯЯ	 
(
ЯЯ 
Roles
ЯЯ 
=
ЯЯ 
$str
ЯЯ )
)
ЯЯ) *
]
ЯЯ* +
[
аа 	
HttpGet
аа	 
(
аа 
$str
аа ,
)
аа, -
]
аа- .
public
бб 
async
бб 
Task
бб 
<
бб 
IActionResult
бб '
>
бб' (
GetSalesByMonth
бб) 8
(
бб8 9
int
бб9 <
sellerId
бб= E
)
ббE F
{
вв 	
try
гг 
{
дд 
_logger
ее 
.
ее 
Info
ее 
(
ее 
$"
ее 
$str
ее E
{
ееE F
sellerId
ееF N
}
ееN O
"
ееO P
)
ееP Q
;
ееQ R
var
жж 
salesByMonth
жж  
=
жж! "
await
жж# ($
_salesAnalyticsService
жж) ?
.
жж? @"
GetSalesByMonthAsync
жж@ T
(
жжT U
sellerId
жжU ]
)
жж] ^
;
жж^ _
if
ии 
(
ии 
salesByMonth
ии  
==
ии! #
null
ии$ (
||
ии) +
!
ии, -
salesByMonth
ии- 9
.
ии9 :
Any
ии: =
(
ии= >
)
ии> ?
)
ии? @
{
йй 
_logger
кк 
.
кк 
Warn
кк  
(
кк  !
$"
кк! #
$str
кк# M
{
ккM N
sellerId
ккN V
}
ккV W
"
ккW X
)
ккX Y
;
ккY Z
return
лл 
NotFound
лл #
(
лл# $
$"
лл$ &
$str
лл& M
{
ллM N
sellerId
ллN V
}
ллV W
$str
ллW X
"
ллX Y
)
ллY Z
;
ллZ [
}
мм 
return
оо 
Ok
оо 
(
оо 
salesByMonth
оо &
)
оо& '
;
оо' (
}
пп 
catch
░░ 
(
░░ 
	Exception
░░ 
ex
░░ 
)
░░  
{
▒▒ 
_logger
▓▓ 
.
▓▓ 
Error
▓▓ 
(
▓▓ 
$"
▓▓  
$str
▓▓  ^
{
▓▓^ _
sellerId
▓▓_ g
}
▓▓g h
"
▓▓h i
,
▓▓i j
ex
▓▓k m
)
▓▓m n
;
▓▓n o
return
││ 

StatusCode
││ !
(
││! "
StatusCodes
││" -
.
││- .*
Status500InternalServerError
││. J
,
││J K
$str
││L ~
)
││~ 
;││ А
}
┤┤ 
}
╡╡ 	
[
╖╖ 	
	Authorize
╖╖	 
(
╖╖ 
Roles
╖╖ 
=
╖╖ 
$str
╖╖ )
)
╖╖) *
]
╖╖* +
[
╕╕ 	
HttpGet
╕╕	 
(
╕╕ 
$str
╕╕ 1
)
╕╕1 2
]
╕╕2 3
public
╣╣ 
async
╣╣ 
Task
╣╣ 
<
╣╣ 
IActionResult
╣╣ '
>
╣╣' (*
GetTopSellingProductBySeller
╣╣) E
(
╣╣E F
int
╣╣F I
sellerId
╣╣J R
)
╣╣R S
{
║║ 	
try
╗╗ 
{
╝╝ 
_logger
╜╜ 
.
╜╜ 
Info
╜╜ 
(
╜╜ 
$"
╜╜ 
$str
╜╜ J
{
╜╜J K
sellerId
╜╜K S
}
╜╜S T
"
╜╜T U
)
╜╜U V
;
╜╜V W
var
╛╛ 

topProduct
╛╛ 
=
╛╛  
await
╛╛! &$
_salesAnalyticsService
╛╛' =
.
╛╛= >/
!GetTopSellingProductBySellerAsync
╛╛> _
(
╛╛_ `
sellerId
╛╛` h
)
╛╛h i
;
╛╛i j
if
└└ 
(
└└ 

topProduct
└└ 
==
└└ !
null
└└" &
)
└└& '
{
┴┴ 
_logger
┬┬ 
.
┬┬ 
Warn
┬┬  
(
┬┬  !
$"
┬┬! #
$str
┬┬# N
{
┬┬N O
sellerId
┬┬O W
}
┬┬W X
"
┬┬X Y
)
┬┬Y Z
;
┬┬Z [
return
├├ 
NotFound
├├ #
(
├├# $
$"
├├$ &
$str
├├& V
{
├├V W
sellerId
├├W _
}
├├_ `
$str
├├` a
"
├├a b
)
├├b c
;
├├c d
}
── 
return
╞╞ 
Ok
╞╞ 
(
╞╞ 

topProduct
╞╞ $
)
╞╞$ %
;
╞╞% &
}
╟╟ 
catch
╚╚ 
(
╚╚ 
	Exception
╚╚ 
ex
╚╚ 
)
╚╚  
{
╔╔ 
_logger
╩╩ 
.
╩╩ 
Error
╩╩ 
(
╩╩ 
$"
╩╩  
$str
╩╩  g
{
╩╩g h
sellerId
╩╩h p
}
╩╩p q
"
╩╩q r
,
╩╩r s
ex
╩╩t v
)
╩╩v w
;
╩╩w x
return
╦╦ 

StatusCode
╦╦ !
(
╦╦! "
StatusCodes
╦╦" -
.
╦╦- .*
Status500InternalServerError
╦╦. J
,
╦╦J K
$str
╦╦L ~
)
╦╦~ 
;╦╦ А
}
╠╠ 
}
══ 	
}
╬╬ 
}╧╧ ▀h
oD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\ProductReviewController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[		 
ApiController		 
]		 
[

 
Route

 

(


 
$str

 
)

 
]

 
public 

class #
ProductReviewController (
:) *
ControllerBase+ 9
{ 
private 
readonly  
ProductReviewService -!
_productReviewService. C
;C D
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G#
ProductReviewControllerG ^
)^ _
)_ `
;` a
public #
ProductReviewController &
(& ' 
ProductReviewService' ; 
productReviewService< P
)P Q
{ 	!
_productReviewService !
=" # 
productReviewService$ 8
;8 9
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
AddReviewAsync) 7
(7 8
[8 9
FromBody9 A
]A B
	ReviewDTOC L
	reviewDtoM V
)V W
{ 	
try 
{ 
var 
reviewId 
= 
await $!
_productReviewService% :
.: ;
AddReviewAsync; I
(I J
	reviewDtoJ S
)S T
;T U
log 
. 
Info 
( 
$" 
$str >
{> ?
reviewId? G
}G H
$strH T
{T U
	reviewDtoU ^
.^ _
UserId_ e
}e f
$strf v
{v w
	reviewDto	w А
.
А Б
	ProductId
Б К
}
К Л
"
Л М
)
М Н
;
Н О
return 
Ok 
( 
new 
{ 
reviewId  (
,( )
message* 1
=2 3
$str4 O
}P Q
)Q R
;R S
} 
catch 
( $
ProductNotFoundException +
ex, .
). /
{ 
log   
.   
Warn   
(   
$"   
$str   .
{  . /
ex  / 1
.  1 2
Message  2 9
}  9 :
"  : ;
)  ; <
;  < =
return!! 
NotFound!! 
(!!  
ex!!  "
.!!" #
Message!!# *
)!!* +
;!!+ ,
}"" 
catch## 
(## !
UserNotFoundException## (
ex##) +
)##+ ,
{$$ 
log%% 
.%% 
Warn%% 
(%% 
$"%% 
$str%% +
{%%+ ,
ex%%, .
.%%. /
Message%%/ 6
}%%6 7
"%%7 8
)%%8 9
;%%9 :
return&& 
NotFound&& 
(&&  
ex&&  "
.&&" #
Message&&# *
)&&* +
;&&+ ,
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
log** 
.** 
Error** 
(** 
$str** F
,**F G
ex**H J
)**J K
;**K L
return++ 

StatusCode++ !
(++! "
$num++" %
,++% &
$str++' S
)++S T
;++T U
},, 
}-- 	
[// 	
HttpGet//	 
(// 
$str// 
)// 
]// 
public00 
async00 
Task00 
<00 
IActionResult00 '
>00' (
GetReviewByIdAsync00) ;
(00; <
int00< ?
id00@ B
)00B C
{11 	
try22 
{33 
var44 
review44 
=44 
await44 "!
_productReviewService44# 8
.448 9
GetReviewByIdAsync449 K
(44K L
id44L N
)44N O
;44O P
return55 
Ok55 
(55 
review55  
)55  !
;55! "
}66 
catch77 
(77 #
ReviewNotFoundException77 *
ex77+ -
)77- .
{88 
log99 
.99 
Warn99 
(99 
$"99 
$str99 -
{99- .
ex99. 0
.990 1
Message991 8
}998 9
"999 :
)99: ;
;99; <
return:: 
NotFound:: 
(::  
ex::  "
.::" #
Message::# *
)::* +
;::+ ,
};; 
catch<< 
(<< 
	Exception<< 
ex<< 
)<<  
{== 
log>> 
.>> 
Error>> 
(>> 
$str>> H
,>>H I
ex>>J L
)>>L M
;>>M N
return?? 

StatusCode?? !
(??! "
$num??" %
,??% &
$str??' U
)??U V
;??V W
}@@ 
}AA 	
[CC 	
HttpGetCC	 
(CC 
$strCC &
)CC& '
]CC' (
publicDD 
asyncDD 
TaskDD 
<DD 
IActionResultDD '
>DD' (&
GetReviewsByProductIdAsyncDD) C
(DDC D
intDDD G
	productIdDDH Q
)DDQ R
{EE 	
tryFF 
{GG 
varHH 
reviewsHH 
=HH 
awaitHH #!
_productReviewServiceHH$ 9
.HH9 :&
GetReviewsByProductIdAsyncHH: T
(HHT U
	productIdHHU ^
)HH^ _
;HH_ `
returnII 
OkII 
(II 
reviewsII !
)II! "
;II" #
}JJ 
catchKK 
(KK $
ProductNotFoundExceptionKK +
exKK, .
)KK. /
{LL 
logMM 
.MM 
WarnMM 
(MM 
$"MM 
$strMM .
{MM. /
exMM/ 1
.MM1 2
MessageMM2 9
}MM9 :
"MM: ;
)MM; <
;MM< =
returnNN 
NotFoundNN 
(NN  
exNN  "
.NN" #
MessageNN# *
)NN* +
;NN+ ,
}OO 
catchPP 
(PP 
	ExceptionPP 
exPP 
)PP  
{QQ 
logRR 
.RR 
ErrorRR 
(RR 
$strRR I
,RRI J
exRRK M
)RRM N
;RRN O
returnSS 

StatusCodeSS !
(SS! "
$numSS" %
,SS% &
$strSS' V
)SSV W
;SSW X
}TT 
}UU 	
[VV 	
HttpGetVV	 
(VV 
$strVV  
)VV  !
]VV! "
publicWW 
asyncWW 
TaskWW 
<WW 
IActionResultWW '
>WW' (#
GetReviewsByUserIdAsyncWW) @
(WW@ A
intWWA D
userIdWWE K
)WWK L
{XX 	
tryYY 
{ZZ 
var[[ 
reviews[[ 
=[[ 
await[[ #!
_productReviewService[[$ 9
.[[9 :#
GetReviewsByUserIdAsync[[: Q
([[Q R
userId[[R X
)[[X Y
;[[Y Z
return\\ 
Ok\\ 
(\\ 
reviews\\ !
)\\! "
;\\" #
}]] 
catch^^ 
(^^ !
UserNotFoundException^^ (
ex^^) +
)^^+ ,
{__ 
log`` 
.`` 
Warn`` 
(`` 
$"`` 
$str`` .
{``. /
ex``/ 1
.``1 2
Message``2 9
}``9 :
"``: ;
)``; <
;``< =
returnaa 
NotFoundaa 
(aa  
exaa  "
.aa" #
Messageaa# *
)aa* +
;aa+ ,
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
logee 
.ee 
Erroree 
(ee 
$stree I
,eeI J
exeeK M
)eeM N
;eeN O
returnff 

StatusCodeff !
(ff! "
$numff" %
,ff% &
$strff' V
)ffV W
;ffW X
}gg 
}hh 	
[jj 	
HttpPutjj	 
(jj 
$strjj 
)jj 
]jj 
publickk 
asynckk 
Taskkk 
<kk 
IActionResultkk '
>kk' (
UpdateReviewAsynckk) :
(kk: ;
intkk; >
idkk? A
,kkA B
[kkC D
FromBodykkD L
]kkL M
	ReviewDTOkkN W
	reviewDtokkX a
)kka b
{ll 	
trymm 
{nn 
varoo 
updatedoo 
=oo 
awaitoo #!
_productReviewServiceoo$ 9
.oo9 :
UpdateReviewAsyncoo: K
(ooK L
idooL N
,ooN O
	reviewDtoooP Y
)ooY Z
;ooZ [
ifpp 
(pp 
updatedpp 
)pp 
{qq 
logrr 
.rr 
Inforr 
(rr 
$"rr 
$strrr .
{rr. /
idrr/ 1
}rr1 2
$strrr2 H
"rrH I
)rrI J
;rrJ K
returnss 
Okss 
(ss 
newss !
{ss" #
messagess$ +
=ss, -
$strss. K
}ssL M
)ssM N
;ssN O
}tt 
returnvv 

BadRequestvv !
(vv! "
$strvv" @
)vv@ A
;vvA B
}ww 
catchxx 
(xx #
ReviewNotFoundExceptionxx *
exxx+ -
)xx- .
{yy 
logzz 
.zz 
Warnzz 
(zz 
$"zz 
$strzz -
{zz- .
exzz. 0
.zz0 1
Messagezz1 8
}zz8 9
"zz9 :
)zz: ;
;zz; <
return{{ 
NotFound{{ 
({{  
ex{{  "
.{{" #
Message{{# *
){{* +
;{{+ ,
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
log 
. 
Error 
( 
$str H
,H I
exJ L
)L M
;M N
return
АА 

StatusCode
АА !
(
АА! "
$num
АА" %
,
АА% &
$str
АА' U
)
ААU V
;
ААV W
}
ББ 
}
ВВ 	
[
ДД 	

HttpDelete
ДД	 
(
ДД 
$str
ДД 
)
ДД 
]
ДД 
public
ЕЕ 
async
ЕЕ 
Task
ЕЕ 
<
ЕЕ 
IActionResult
ЕЕ '
>
ЕЕ' (
DeleteReviewAsync
ЕЕ) :
(
ЕЕ: ;
int
ЕЕ; >
id
ЕЕ? A
)
ЕЕA B
{
ЖЖ 	
try
ЗЗ 
{
ИИ 
var
ЙЙ 
deleted
ЙЙ 
=
ЙЙ 
await
ЙЙ ##
_productReviewService
ЙЙ$ 9
.
ЙЙ9 :
DeleteReviewAsync
ЙЙ: K
(
ЙЙK L
id
ЙЙL N
)
ЙЙN O
;
ЙЙO P
if
КК 
(
КК 
deleted
КК 
)
КК 
{
ЛЛ 
log
ММ 
.
ММ 
Info
ММ 
(
ММ 
$"
ММ 
$str
ММ .
{
ММ. /
id
ММ/ 1
}
ММ1 2
$str
ММ2 H
"
ММH I
)
ММI J
;
ММJ K
return
НН 
Ok
НН 
(
НН 
new
НН !
{
НН" #
message
НН$ +
=
НН, -
$str
НН. K
}
ННL M
)
ННM N
;
ННN O
}
ОО 
return
РР 

BadRequest
РР !
(
РР! "
$str
РР" @
)
РР@ A
;
РРA B
}
СС 
catch
ТТ 
(
ТТ %
ReviewNotFoundException
ТТ *
ex
ТТ+ -
)
ТТ- .
{
УУ 
log
ФФ 
.
ФФ 
Warn
ФФ 
(
ФФ 
$"
ФФ 
$str
ФФ -
{
ФФ- .
ex
ФФ. 0
.
ФФ0 1
Message
ФФ1 8
}
ФФ8 9
"
ФФ9 :
)
ФФ: ;
;
ФФ; <
return
ХХ 
NotFound
ХХ 
(
ХХ  
ex
ХХ  "
.
ХХ" #
Message
ХХ# *
)
ХХ* +
;
ХХ+ ,
}
ЦЦ 
catch
ЧЧ 
(
ЧЧ 
	Exception
ЧЧ 
ex
ЧЧ 
)
ЧЧ  
{
ШШ 
log
ЩЩ 
.
ЩЩ 
Error
ЩЩ 
(
ЩЩ 
$str
ЩЩ H
,
ЩЩH I
ex
ЩЩJ L
)
ЩЩL M
;
ЩЩM N
return
ЪЪ 

StatusCode
ЪЪ !
(
ЪЪ! "
$num
ЪЪ" %
,
ЪЪ% &
$str
ЪЪ' U
)
ЪЪU V
;
ЪЪV W
}
ЫЫ 
}
ЬЬ 	
}
ЭЭ 
}ЯЯ ║_
qD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\ProductDiscountController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 %
ProductDiscountController

 *
:

+ ,
ControllerBase

- ;
{ 
private 
readonly "
ProductDiscountService /#
_productDiscountService0 G
;G H
private 
static 
readonly 
ILog  $
_logger% ,
=- .

LogManager/ 9
.9 :
	GetLogger: C
(C D
typeofD J
(J K%
ProductDiscountControllerK d
)d e
)e f
;f g
public %
ProductDiscountController (
(( )"
ProductDiscountService) ?"
productDiscountService@ V
)V W
{ 	#
_productDiscountService #
=$ %"
productDiscountService& <
;< =
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' ("
GetAllProductDiscounts) ?
(? @
)@ A
{ 	
try 
{ 
_logger 
. 
Info 
( 
$str @
)@ A
;A B
var 
	discounts 
= 
await  %#
_productDiscountService& =
.= >'
GetAllProductDiscountsAsync> Y
(Y Z
)Z [
;[ \
return 
Ok 
( 
	discounts #
)# $
;$ %
} 
catch 
( 
	Exception 
ex 
)  
{ 
_logger 
. 
Error 
( 
$"  
$str  U
{U V
exV X
.X Y
MessageY `
}` a
"a b
)b c
;c d
return   

StatusCode   !
(  ! "
$num  " %
,  % &
new  ' *
{  + ,
Message  - 4
=  5 6
$str  7 N
}  O P
)  P Q
;  Q R
}!! 
}"" 	
[$$ 	
HttpGet$$	 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' ("
GetProductDiscountById%%) ?
(%%? @
int%%@ C
id%%D F
)%%F G
{&& 	
try'' 
{(( 
_logger)) 
.)) 
Info)) 
()) 
$")) 
$str)) D
{))D E
id))E G
}))G H
"))H I
)))I J
;))J K
var** 
discount** 
=** 
await** $#
_productDiscountService**% <
.**< ='
GetProductDiscountByIdAsync**= X
(**X Y
id**Y [
)**[ \
;**\ ]
if++ 
(++ 
discount++ 
==++ 
null++  $
)++$ %
{,, 
_logger-- 
.-- 
Warn--  
(--  !
$"--! #
$str--# =
{--= >
id--> @
}--@ A
$str--A L
"--L M
)--M N
;--N O
return.. 
NotFound.. #
(..# $
new..$ '
{..( )
Message..* 1
=..2 3
$str..4 Q
}..R S
)..S T
;..T U
}// 
return00 
Ok00 
(00 
discount00 "
)00" #
;00# $
}11 
catch22 
(22 
	Exception22 
ex22 
)22  
{33 
_logger44 
.44 
Error44 
(44 
$"44  
$str44  Q
{44Q R
id44R T
}44T U
$str44U ^
{44^ _
ex44_ a
.44a b
Message44b i
}44i j
"44j k
)44k l
;44l m
return55 

StatusCode55 !
(55! "
$num55" %
,55% &
new55' *
{55+ ,
Message55- 4
=555 6
$str557 N
}55O P
)55P Q
;55Q R
}66 
}77 	
[99 	
HttpPost99	 
]99 
public:: 
async:: 
Task:: 
<:: 
IActionResult:: '
>::' (!
CreateProductDiscount::) >
(::> ?
[::? @
FromBody::@ H
]::H I
ProductDiscountDTO::J \
productDiscountDTO::] o
)::o p
{;; 	
if<< 
(<< 
productDiscountDTO<< "
==<<# %
null<<& *
)<<* +
{== 
_logger>> 
.>> 
Warn>> 
(>> 
$str>> =
)>>= >
;>>> ?
return?? 

BadRequest?? !
(??! "
new??" %
{??& '
Message??( /
=??0 1
$str??2 V
}??W X
)??X Y
;??Y Z
}@@ 
tryBB 
{CC 
_loggerDD 
.DD 
InfoDD 
(DD 
$strDD =
)DD= >
;DD> ?
awaitEE #
_productDiscountServiceEE -
.EE- .&
CreateProductDiscountAsyncEE. H
(EEH I
productDiscountDTOEEI [
)EE[ \
;EE\ ]
returnFF 
CreatedAtActionFF &
(FF& '
nameofFF' -
(FF- ."
GetProductDiscountByIdFF. D
)FFD E
,FFE F
newFFG J
{FFK L
idFFM O
=FFP Q
productDiscountDTOFFR d
.FFd e
ProductDiscountIdFFe v
}FFw x
,FFx y
productDiscountDTO	FFz М
)
FFМ Н
;
FFН О
}GG 
catchHH 
(HH 
	ExceptionHH 
exHH 
)HH  
{II 
_loggerJJ 
.JJ 
ErrorJJ 
(JJ 
$"JJ  
$strJJ  N
{JJN O
exJJO Q
.JJQ R
MessageJJR Y
}JJY Z
"JJZ [
)JJ[ \
;JJ\ ]
returnKK 

StatusCodeKK !
(KK! "
$numKK" %
,KK% &
newKK' *
{KK+ ,
MessageKK- 4
=KK5 6
$strKK7 N
}KKO P
)KKP Q
;KKQ R
}LL 
}MM 	
[OO 	
HttpPutOO	 
(OO 
$strOO 
)OO 
]OO 
publicPP 
asyncPP 
TaskPP 
<PP 
IActionResultPP '
>PP' (!
UpdateProductDiscountPP) >
(PP> ?
intPP? B
idPPC E
,PPE F
[PPG H
FromBodyPPH P
]PPP Q
ProductDiscountDTOPPR d
productDiscountDTOPPe w
)PPw x
{QQ 	
ifRR 
(RR 
productDiscountDTORR "
==RR# %
nullRR& *
)RR* +
{SS 
_loggerTT 
.TT 
WarnTT 
(TT 
$strTT =
)TT= >
;TT> ?
returnUU 

BadRequestUU !
(UU! "
newUU" %
{UU& '
MessageUU( /
=UU0 1
$strUU2 V
}UUW X
)UUX Y
;UUY Z
}VV 
ifXX 
(XX 
idXX 
!=XX 
productDiscountDTOXX (
.XX( )
ProductDiscountIdXX) :
)XX: ;
{YY 
_loggerZZ 
.ZZ 
WarnZZ 
(ZZ 
$"ZZ 
$strZZ Q
"ZZQ R
)ZZR S
;ZZS T
return[[ 

BadRequest[[ !
([[! "
new[[" %
{[[& '
Message[[( /
=[[0 1
$str[[2 Q
}[[R S
)[[S T
;[[T U
}\\ 
try^^ 
{__ 
_logger`` 
.`` 
Info`` 
(`` 
$"`` 
$str`` B
{``B C
id``C E
}``E F
"``F G
)``G H
;``H I
awaitaa #
_productDiscountServiceaa -
.aa- .&
UpdateProductDiscountAsyncaa. H
(aaH I
idaaI K
,aaK L
productDiscountDTOaaM _
)aa_ `
;aa` a
returnbb 
	NoContentbb  
(bb  !
)bb! "
;bb" #
}cc 
catchdd 
(dd  
KeyNotFoundExceptiondd '
exdd( *
)dd* +
{ee 
_loggerff 
.ff 
Warnff 
(ff 
$"ff 
$strff 9
{ff9 :
idff: <
}ff< =
$strff= P
{ffP Q
exffQ S
.ffS T
MessageffT [
}ff[ \
"ff\ ]
)ff] ^
;ff^ _
returngg 
NotFoundgg 
(gg  
newgg  #
{gg$ %
Messagegg& -
=gg. /
$strgg0 M
}ggN O
)ggO P
;ggP Q
}hh 
catchii 
(ii 
	Exceptionii 
exii 
)ii  
{jj 
_loggerkk 
.kk 
Errorkk 
(kk 
$"kk  
$strkk  O
{kkO P
idkkP R
}kkR S
$strkkS \
{kk\ ]
exkk] _
.kk_ `
Messagekk` g
}kkg h
"kkh i
)kki j
;kkj k
returnll 

StatusCodell !
(ll! "
$numll" %
,ll% &
newll' *
{ll+ ,
Messagell- 4
=ll5 6
$strll7 N
}llO P
)llP Q
;llQ R
}mm 
}nn 	
[pp 	

HttpDeletepp	 
(pp 
$strpp 
)pp 
]pp 
publicqq 
asyncqq 
Taskqq 
<qq 
IActionResultqq '
>qq' (!
DeleteProductDiscountqq) >
(qq> ?
intqq? B
idqqC E
)qqE F
{rr 	
tryss 
{tt 
_loggeruu 
.uu 
Infouu 
(uu 
$"uu 
$struu B
{uuB C
iduuC E
}uuE F
"uuF G
)uuG H
;uuH I
awaitvv #
_productDiscountServicevv -
.vv- .&
DeleteProductDiscountAsyncvv. H
(vvH I
idvvI K
)vvK L
;vvL M
returnww 
	NoContentww  
(ww  !
)ww! "
;ww" #
}xx 
catchyy 
(yy  
KeyNotFoundExceptionyy '
exyy( *
)yy* +
{zz 
_logger{{ 
.{{ 
Warn{{ 
({{ 
$"{{ 
$str{{ 9
{{{9 :
id{{: <
}{{< =
$str{{= P
{{{P Q
ex{{Q S
.{{S T
Message{{T [
}{{[ \
"{{\ ]
){{] ^
;{{^ _
return|| 
NotFound|| 
(||  
new||  #
{||$ %
Message||& -
=||. /
$str||0 M
}||N O
)||O P
;||P Q
}}} 
catch~~ 
(~~ 
	Exception~~ 
ex~~ 
)~~  
{ 
_logger
АА 
.
АА 
Error
АА 
(
АА 
$"
АА  
$str
АА  O
{
ААO P
id
ААP R
}
ААR S
$str
ААS \
{
АА\ ]
ex
АА] _
.
АА_ `
Message
АА` g
}
ААg h
"
ААh i
)
ААi j
;
ААj k
return
ББ 

StatusCode
ББ !
(
ББ! "
$num
ББ" %
,
ББ% &
new
ББ' *
{
ББ+ ,
Message
ББ- 4
=
ББ5 6
$str
ББ7 N
}
ББO P
)
ББP Q
;
ББQ R
}
ВВ 
}
ГГ 	
}
ДД 
}ЕЕ ЕР
iD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\ProductController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{		 
[

 
Route

 

(


 
$str

 
)

 
]

 
public 

class 
ProductController "
:# $
ControllerBase% 3
{ 
private 
readonly 
ProductService '
_productService( 7
;7 8
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
ProductControllerG X
)X Y
)Y Z
;Z [
public 
ProductController  
(  !
ProductService! /
productService0 >
)> ?
{ 	
_productService 
= 
productService ,
;, -
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAllProducts) 7
(7 8
)8 9
{ 	
try 
{ 
var 
products 
= 
await $
_productService% 4
.4 5
GetAllProductsAsync5 H
(H I
)I J
;J K
return 
Ok 
( 
products "
)" #
;# $
} 
catch 
( 
System 
. 
	Exception #
ex$ &
)& '
{ 
log 
. 
Error 
( 
$str 7
,7 8
ex9 ;
); <
;< =
return   

StatusCode   !
(  ! "
$num  " %
,  % &
$str  ' >
)  > ?
;  ? @
}!! 
}"" 	
[## 	
HttpGet##	 
(## 
$str## *
)##* +
]##+ ,
public$$ 
async$$ 
Task$$ 
<$$ 
IActionResult$$ '
>$$' ($
GetAllProductsWithSeller$$) A
($$A B
)$$B C
{%% 	
try&& 
{'' 
var(( 
products(( 
=(( 
await(( $
_productService((% 4
.((4 5)
GetAllProductswithSellerAsync((5 R
(((R S
)((S T
;((T U
return)) 
Ok)) 
()) 
products)) "
)))" #
;))# $
}** 
catch++ 
(++ 
System++ 
.++ 
	Exception++ #
ex++$ &
)++& '
{,, 
log-- 
.-- 
Error-- 
(-- 
$str-- 7
,--7 8
ex--9 ;
)--; <
;--< =
return.. 

StatusCode.. !
(..! "
$num.." %
,..% &
$str..' >
)..> ?
;..? @
}// 
}00 	
[22 	
HttpGet22	 
(22 
$str22 
)22 
]22  
public33 
async33 
Task33 
<33 
IActionResult33 '
>33' (
GetProductById33) 7
(337 8
int338 ;
	productId33< E
)33E F
{44 	
try55 
{66 
var77 
product77 
=77 
await77 #
_productService77$ 3
.773 4
GetProductByIdAsync774 G
(77G H
	productId77H Q
)77Q R
;77R S
return88 
Ok88 
(88 
product88 !
)88! "
;88" #
}99 
catch:: 
(:: $
ProductNotFoundException:: +
ex::, .
)::. /
{;; 
log<< 
.<< 
Warn<< 
(<< 
$"<< 
$str<< +
{<<+ ,
	productId<<, 5
}<<5 6
$str<<6 B
{<<B C
ex<<C E
.<<E F
Message<<F M
}<<M N
"<<N O
)<<O P
;<<P Q
return== 
NotFound== 
(==  
new==  #
{==$ %
Message==& -
===. /
ex==0 2
.==2 3
Message==3 :
}==; <
)==< =
;=== >
}>> 
catch?? 
(?? 
System?? 
.?? 
	Exception?? #
ex??$ &
)??& '
{@@ 
logAA 
.AA 
ErrorAA 
(AA 
$"AA 
$strAA ;
{AA; <
	productIdAA< E
}AAE F
"AAF G
,AAG H
exAAI K
)AAK L
;AAL M
returnBB 

StatusCodeBB !
(BB! "
$numBB" %
,BB% &
$strBB' >
)BB> ?
;BB? @
}CC 
}DD 	
[FF 	
HttpGetFF	 
(FF 
$strFF 
)FF 
]FF 
publicGG 
asyncGG 
TaskGG 
<GG 
IActionResultGG '
>GG' (
GetProductsByNameGG) :
(GG: ;
[GG; <
	FromQueryGG< E
]GGE F
stringGGG M
productNameGGN Y
)GGY Z
{HH 	
tryII 
{JJ 
varKK 
productsKK 
=KK 
awaitKK $
_productServiceKK% 4
.KK4 5"
GetProductsByNameAsyncKK5 K
(KKK L
productNameKKL W
)KKW X
;KKX Y
returnLL 
OkLL 
(LL 
productsLL "
)LL" #
;LL# $
}MM 
catchNN 
(NN $
ProductNotFoundExceptionNN +
exNN, .
)NN. /
{OO 
logPP 
.PP 
WarnPP 
(PP 
$"PP 
$strPP 6
{PP6 7
productNamePP7 B
}PPB C
$strPPC E
{PPE F
exPPF H
.PPH I
MessagePPI P
}PPP Q
"PPQ R
)PPR S
;PPS T
returnQQ 
NotFoundQQ 
(QQ  
newQQ  #
{QQ$ %
MessageQQ& -
=QQ. /
exQQ0 2
.QQ2 3
MessageQQ3 :
}QQ; <
)QQ< =
;QQ= >
}RR 
catchSS 
(SS 
SystemSS 
.SS 
	ExceptionSS #
exSS$ &
)SS& '
{TT 
logUU 
.UU 
ErrorUU 
(UU 
$"UU 
$strUU <
{UU< =
productNameUU= H
}UUH I
"UUI J
,UUJ K
exUUL N
)UUN O
;UUO P
returnVV 

StatusCodeVV !
(VV! "
$numVV" %
,VV% &
$strVV' >
)VV> ?
;VV? @
}WW 
}XX 	
[ZZ 	
	AuthorizeZZ	 
(ZZ 
RolesZZ 
=ZZ 
$strZZ )
)ZZ) *
]ZZ* +
[[[ 	
HttpPost[[	 
([[ 
$str[[ 
)[[ 
][[  
public\\ 
async\\ 
Task\\ 
<\\ 
IActionResult\\ '
>\\' (

AddProduct\\) 3
(\\3 4
[\\4 5
FromBody\\5 =
]\\= >#
ProductWithInventoryDTO\\? V#
productWithInventoryDto\\W n
)\\n o
{]] 	
try^^ 
{__ 
var`` 
newProductId``  
=``! "
await``# (
_productService``) 8
.``8 9
AddProductAsync``9 H
(``H I#
productWithInventoryDto``I `
.``` a
Product``a h
)``h i
;``i j
returnaa 
Okaa 
(aa 
newaa 
{aa  
messageaa! (
=aa) *
$"aa+ -
$straa- Q
{aaQ R
newProductIdaaR ^
}aa^ _
"aa_ `
}aaa b
)aab c
;aac d
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
logee 
.ee 
Erroree 
(ee 
$stree 0
,ee0 1
exee2 4
)ee4 5
;ee5 6
returnff 

StatusCodeff !
(ff! "
StatusCodesff" -
.ff- .(
Status500InternalServerErrorff. J
,ffJ K
$strffL c
)ffc d
;ffd e
}gg 
}hh 	
[jj 	
	Authorizejj	 
(jj 
Rolesjj 
=jj 
$strjj )
)jj) *
]jj* +
[kk 	
HttpPutkk	 
(kk 
$strkk  
)kk  !
]kk! "
publicll 
asyncll 
Taskll 
<ll 
IActionResultll '
>ll' (
UpdateProductll) 6
(ll6 7
intll7 :
idll; =
,ll= >
[ll? @
FromBodyll@ H
]llH I#
ProductWithInventoryDTOllJ a#
productWithInventoryDtollb y
)lly z
{mm 	
trynn 
{oo 
ifpp 
(pp 
idpp 
!=pp #
productWithInventoryDtopp 1
.pp1 2
Productpp2 9
.pp9 :
	ProductIdpp: C
)ppC D
{qq 
returnrr 

BadRequestrr %
(rr% &
$strrr& <
)rr< =
;rr= >
}ss 
awaitvv 
_productServicevv %
.vv% &
UpdateProductAsyncvv& 8
(vv8 9#
productWithInventoryDtovv9 P
.vvP Q
ProductvvQ X
)vvX Y
;vvY Z
returnyy 
Okyy 
(yy 
newyy 
{yy 
messageyy  '
=yy( )
$stryy* H
,yyH I
	productIdyyJ S
=yyT U
idyyV X
}yyY Z
)yyZ [
;yy[ \
}zz 
catch{{ 
({{ $
ProductNotFoundException{{ +
ex{{, .
){{. /
{|| 
log}} 
.}} 
Warn}} 
(}} 
$str}} 7
,}}7 8
ex}}9 ;
)}}; <
;}}< =
return~~ 
NotFound~~ 
(~~  
ex~~  "
.~~" #
Message~~# *
)~~* +
;~~+ ,
} 
catch
АА 
(
АА 
	Exception
АА 
ex
АА 
)
АА  
{
ББ 
log
ВВ 
.
ВВ 
Error
ВВ 
(
ВВ 
$str
ВВ 2
,
ВВ2 3
ex
ВВ4 6
)
ВВ6 7
;
ВВ7 8
return
ГГ 

StatusCode
ГГ !
(
ГГ! "
StatusCodes
ГГ" -
.
ГГ- .*
Status500InternalServerError
ГГ. J
,
ГГJ K
$str
ГГL c
)
ГГc d
;
ГГd e
}
ДД 
}
ЕЕ 	
[
ЗЗ 	
	Authorize
ЗЗ	 
(
ЗЗ 
Roles
ЗЗ 
=
ЗЗ 
$str
ЗЗ )
)
ЗЗ) *
]
ЗЗ* +
[
ИИ 	

HttpDelete
ИИ	 
(
ИИ 
$str
ИИ !
)
ИИ! "
]
ИИ" #
public
ЙЙ 
async
ЙЙ 
Task
ЙЙ 
<
ЙЙ 
IActionResult
ЙЙ '
>
ЙЙ' (
DeleteProduct
ЙЙ) 6
(
ЙЙ6 7
int
ЙЙ7 :
	productId
ЙЙ; D
)
ЙЙD E
{
КК 	
try
ЛЛ 
{
ММ 
await
НН 
_productService
НН %
.
НН% & 
DeleteProductAsync
НН& 8
(
НН8 9
	productId
НН9 B
)
ННB C
;
ННC D
return
ОО 
Ok
ОО 
(
ОО 
new
ОО 
{
ОО 
Message
ОО  '
=
ОО( )
$str
ОО* H
}
ООI J
)
ООJ K
;
ООK L
}
ПП 
catch
РР 
(
РР &
ProductNotFoundException
РР +
ex
РР, .
)
РР. /
{
СС 
log
ТТ 
.
ТТ 
Warn
ТТ 
(
ТТ 
$"
ТТ 
$str
ТТ 3
{
ТТ3 4
ex
ТТ4 6
.
ТТ6 7
Message
ТТ7 >
}
ТТ> ?
"
ТТ? @
)
ТТ@ A
;
ТТA B
return
УУ 
NotFound
УУ 
(
УУ  
new
УУ  #
{
УУ$ %
Message
УУ& -
=
УУ. /
ex
УУ0 2
.
УУ2 3
Message
УУ3 :
}
УУ; <
)
УУ< =
;
УУ= >
}
ФФ 
catch
ХХ 
(
ХХ 
System
ХХ 
.
ХХ 
	Exception
ХХ #
ex
ХХ$ &
)
ХХ& '
{
ЦЦ 
log
ЧЧ 
.
ЧЧ 
Error
ЧЧ 
(
ЧЧ 
$"
ЧЧ 
$str
ЧЧ ;
{
ЧЧ; <
	productId
ЧЧ< E
}
ЧЧE F
"
ЧЧF G
,
ЧЧG H
ex
ЧЧI K
)
ЧЧK L
;
ЧЧL M
return
ШШ 

StatusCode
ШШ !
(
ШШ! "
$num
ШШ" %
,
ШШ% &
$str
ШШ' >
)
ШШ> ?
;
ШШ? @
}
ЩЩ 
}
ЪЪ 	
[
ЬЬ 	
	Authorize
ЬЬ	 
(
ЬЬ 
Roles
ЬЬ 
=
ЬЬ 
$str
ЬЬ )
)
ЬЬ) *
]
ЬЬ* +
[
ЭЭ 	
HttpGet
ЭЭ	 
(
ЭЭ 
$str
ЭЭ $
)
ЭЭ$ %
]
ЭЭ% &
public
ЮЮ 
async
ЮЮ 
Task
ЮЮ 
<
ЮЮ 
IActionResult
ЮЮ '
>
ЮЮ' (#
GetProductsBySellerId
ЮЮ) >
(
ЮЮ> ?
int
ЮЮ? B
sellerId
ЮЮC K
)
ЮЮK L
{
ЯЯ 	
try
аа 
{
бб 
var
вв 
products
вв 
=
вв 
await
вв $
_productService
вв% 4
.
вв4 5(
GetProductsBySellerIdAsync
вв5 O
(
ввO P
sellerId
ввP X
)
ввX Y
;
ввY Z
if
гг 
(
гг 
products
гг 
==
гг 
null
гг  $
||
гг% '
!
гг( )
products
гг) 1
.
гг1 2
Any
гг2 5
(
гг5 6
)
гг6 7
)
гг7 8
{
дд 
log
ее 
.
ее 
Info
ее 
(
ее 
$"
ее 
$str
ее ?
{
ее? @
sellerId
ее@ H
}
ееH I
"
ееI J
)
ееJ K
;
ееK L
return
жж 
NotFound
жж #
(
жж# $
$"
жж$ &
$str
жж& F
{
жжF G
sellerId
жжG O
}
жжO P
"
жжP Q
)
жжQ R
;
жжR S
}
зз 
return
ии 
Ok
ии 
(
ии 
products
ии "
)
ии" #
;
ии# $
}
йй 
catch
кк 
(
кк 
	Exception
кк 
ex
кк 
)
кк  
{
лл 
log
мм 
.
мм 
Error
мм 
(
мм 
$"
мм 
$str
мм B
{
ммB C
sellerId
ммC K
}
ммK L
$str
ммL Y
{
ммY Z
ex
ммZ \
.
мм\ ]
Message
мм] d
}
ммd e
"
ммe f
)
ммf g
;
ммg h
return
нн 

StatusCode
нн !
(
нн! "
$num
нн" %
,
нн% &
$str
нн' ?
)
нн? @
;
нн@ A
}
оо 
}
пп 	
[
░░ 	
HttpGet
░░	 
(
░░ 
$str
░░ &
)
░░& '
]
░░' (
public
▒▒ 
async
▒▒ 
Task
▒▒ 
<
▒▒ 
ActionResult
▒▒ &
<
▒▒& '
ProductDetailsDTO
▒▒' 8
>
▒▒8 9
>
▒▒9 :
GetProductDetails
▒▒; L
(
▒▒L M
int
▒▒M P
	productId
▒▒Q Z
)
▒▒Z [
{
▓▓ 	
try
││ 
{
┤┤ 
if
╡╡ 
(
╡╡ 
	productId
╡╡ 
<=
╡╡  
$num
╡╡! "
)
╡╡" #
{
╢╢ 
log
╖╖ 
.
╖╖ 
Warn
╖╖ 
(
╖╖ 
$"
╖╖ 
$str
╖╖ 1
{
╖╖1 2
	productId
╖╖2 ;
}
╖╖; <
$str
╖╖< =
"
╖╖= >
)
╖╖> ?
;
╖╖? @
return
╕╕ 

BadRequest
╕╕ %
(
╕╕% &
$str
╕╕& ;
)
╕╕; <
;
╕╕< =
}
╣╣ 
var
╗╗ 
productDetails
╗╗ "
=
╗╗# $
await
╗╗% *
_productService
╗╗+ :
.
╗╗: ;#
GetProductDetailsFull
╗╗; P
(
╗╗P Q
	productId
╗╗Q Z
)
╗╗Z [
;
╗╗[ \
if
╜╜ 
(
╜╜ 
productDetails
╜╜ "
==
╜╜# %
null
╜╜& *
)
╜╜* +
{
╛╛ 
log
┐┐ 
.
┐┐ 
Warn
┐┐ 
(
┐┐ 
$"
┐┐ 
$str
┐┐ 6
{
┐┐6 7
	productId
┐┐7 @
}
┐┐@ A
$str
┐┐A L
"
┐┐L M
)
┐┐M N
;
┐┐N O
return
└└ 
NotFound
└└ #
(
└└# $
$"
└└$ &
$str
└└& 6
{
└└6 7
	productId
└└7 @
}
└└@ A
$str
└└A L
"
└└L M
)
└└M N
;
└└N O
}
┴┴ 
log
├├ 
.
├├ 
Info
├├ 
(
├├ 
$"
├├ 
$str
├├ 9
{
├├9 :
	productId
├├: C
}
├├C D
$str
├├D E
"
├├E F
)
├├F G
;
├├G H
return
── 
Ok
── 
(
── 
productDetails
── (
)
──( )
;
──) *
}
┼┼ 
catch
╞╞ 
(
╞╞ 
	Exception
╞╞ 
ex
╞╞ 
)
╞╞  
{
╟╟ 
log
╚╚ 
.
╚╚ 
Error
╚╚ 
(
╚╚ 
$"
╚╚ 
$str
╚╚ S
{
╚╚S T
	productId
╚╚T ]
}
╚╚] ^
$str
╚╚^ _
"
╚╚_ `
,
╚╚` a
ex
╚╚b d
)
╚╚d e
;
╚╚e f
return
╔╔ 

StatusCode
╔╔ !
(
╔╔! "
$num
╔╔" %
,
╔╔% &
$str
╔╔' Y
)
╔╔Y Z
;
╔╔Z [
}
╩╩ 
}
╦╦ 	
}
╠╠ 
}══ єz
gD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\OrderController.cs
[ 
Route 
( 
$str 
) 
] 
[ 
	Authorize 

]
 
public 
class 
OrderController 
: 
ControllerBase -
{ 
private 
readonly 
OrderService !
_orderService" /
;/ 0
private 
readonly 
UserService  
_userService! -
;- .
private 
readonly 
EmailService !
_emailService" /
;/ 0
private 
readonly 
ILog 
_logger !
=" #

LogManager$ .
.. /
	GetLogger/ 8
(8 9
typeof9 ?
(? @
OrderController@ O
)O P
)P Q
;Q R
public 

OrderController 
( 
OrderService '
orderService( 4
,4 5
UserService6 A
userServiceB M
,M N
EmailServiceO [
emailService\ h
)h i
{ 
_orderService 
= 
orderService $
;$ %
_userService 
= 
userService "
;" #
_emailService 
= 
emailService $
;$ %
} 
[ 
	Authorize 
( 
Roles 
= 
$str 
) 
] 
[ 
HttpPost 
( 
$str 
) 
] 
public 

async 
Task 
< 
IActionResult #
># $

PlaceOrder% /
(/ 0
[0 1
FromBody1 9
]9 :
PlaceOrderDto; H
orderDtoI Q
)Q R
{ 
if   

(   
orderDto   
==   
null   
||   
orderDto    (
.  ( )

OrderItems  ) 3
==  4 6
null  7 ;
||  < >
orderDto  ? G
.  G H

OrderItems  H R
.  R S
Count  S X
==  Y [
$num  \ ]
||  ^ `
orderDto  a i
.  i j
Payments  j r
==  s u
null  v z
||  { }
orderDto	  ~ Ж
.
  Ж З
Payments
  З П
.
  П Р
Count
  Р Х
==
  Ц Ш
$num
  Щ Ъ
)
  Ъ Ы
{!! 	
_logger"" 
."" 
Warn"" 
("" 
$str"" X
)""X Y
;""Y Z
return## 

BadRequest## 
(## 
$str## 6
)##6 7
;##7 8
}$$ 	
try&& 
{'' 	
var(( 
orderResponse(( 
=((  
await((! &
_orderService((' 4
.((4 5
PlaceOrderAsync((5 D
(((D E
orderDto((E M
)((M N
;((N O
_logger)) 
.)) 
Info)) 
()) 
$")) 
$str)) @
{))@ A
orderResponse))A N
.))N O
OrderId))O V
}))V W
"))W X
)))X Y
;))Y Z
var++ 
user++ 
=++ 
await++ 
_userService++ )
.++) *
GetUserByIdAsync++* :
(++: ;
orderDto++; C
.++C D
UserId++D J
)++J K
;++K L
if,, 
(,, 
user,, 
!=,, 
null,, 
),, 
{-- 
var.. 
emailSubject..  
=..! "
$str..# C
;..C D
var// 
	emailBody// 
=// 
$"//  "
$str//" O
"//O P
+//Q R
$"00  "
$str00" >
{00> ?
user00? C
.00C D
UserName00D L
}00L M
$str00M S
"00S T
+00U V
$"11  "
$str11" d
"11d e
+11f g
$"22  "
$str22" H
"22H I
+22J K
$"33  "
$str33" Y
"33Y Z
+33[ \
$"44  "
$str44" K
"44K L
+44M N
$"55  "
$str55" _
"55_ `
+55a b
$"66  "
$str66" @
{66@ A
orderResponse66A N
.66N O
OrderId66O V
}66V W
$str66W \
"66\ ]
+66^ _
$"77  "
$str77" )
"77) *
+77+ ,
$"88  "
$str88" (
"88( )
+88* +
$"99  "
$str99" c
"99c d
+99e f
$"::  "
$str::" @
{::@ A
orderResponse::A N
.::N O
TotalAmount::O Z
:::Z [
$str::[ \
}::\ ]
$str::] b
"::b c
+::d e
$";;  "
$str;;" )
";;) *
+;;+ ,
$"<<  "
$str<<" K
"<<K L
+<<M N
$"==  "
$str==" a
"==a b
+==c d
$">>  "
$str>>" @
{>>@ A
orderResponse>>A N
.>>N O
	OrderDate>>O X
}>>X Y
$str>>Y ^
">>^ _
+>>` a
$"??  "
$str??" )
"??) *
+??+ ,
$"@@  "
$str@@" (
"@@( )
+@@* +
$"AA  "
$strAA" c
"AAc d
+AAe f
$"BB  "
$strBB" @
{BB@ A
orderResponseBBA N
.BBN O
OrderStatusBBO Z
.BBZ [
ToStringBB[ c
(BBc d
)BBd e
}BBe f
$strBBf k
"BBk l
+BBm n
$"CC  "
$strCC" )
"CC) *
+CC+ ,
$"DD  "
$strDD" /
"DD/ 0
+DD1 2
$"FF  "
$strFF" J
"FFJ K
+FFL M
$"GG  "
$strGG" Y
"GGY Z
+GG[ \
$"HH  "
$strHH" Y
"HHY Z
+HH[ \
$"II  "
$strII" *
"II* +
+II, -
$"JJ  "
$strJJ" h
"JJh i
+JJj k
$"KK  "
$strKK" h
"KKh i
+KKj k
$"LL  "
$strLL" f
"LLf g
+LLh i
$"MM  "
$strMM" h
"MMh i
+MMj k
$"NN  "
$strNN" +
"NN+ ,
+NN- .
$"OO  "
$strOO" ,
"OO, -
+OO. /
$"PP  "
$strPP" +
"PP+ ,
;PP, -
foreachRR 
(RR 
varRR 
paymentRR $
inRR% '
orderResponseRR( 5
.RR5 6
PaymentsRR6 >
)RR> ?
{SS 
	emailBodyTT 
+=TT  
$"TT! #
$strTT# R
"TTR S
+TTT U
$"UU! #
$strUU# C
{UUC D
paymentUUD K
.UUK L
PaymentAmountUUL Y
:UUY Z
$strUUZ [
}UU[ \
$strUU\ a
"UUa b
+UUc d
$"VV! #
$strVV# C
{VVC D
paymentVVD K
.VVK L
PaymentMethodVVL Y
.VVY Z
ToStringVVZ b
(VVb c
)VVc d
}VVd e
$strVVe j
"VVj k
+VVl m
$"WW! #
$strWW# C
{WWC D
paymentWWD K
.WWK L
PaymentDateWWL W
.WWW X
ToStringWWX `
(WW` a
$strWWa ~
)WW~ 
}	WW А
$str
WWА Е
"
WWЕ Ж
+
WWЗ И
$"XX! #
$strXX# C
{XXC D
paymentXXD K
.XXK L
PaymentStatusXXL Y
.XXY Z
ToStringXXZ b
(XXb c
)XXc d
}XXd e
$strXXe j
"XXj k
+XXl m
$"YY! #
$strYY# ,
"YY, -
;YY- .
}ZZ 
	emailBody\\ 
+=\\ 
$"\\ 
$str\\ 6
"\\6 7
+\\8 9
$"^^ 
$str^^ B
"^^B C
+^^D E
$"__ 
$str__ 4
"__4 5
+__6 7
$"`` 
$str`` >
"``> ?
+``@ A
$"aa 
$straa %
"aa% &
;aa& '
awaitdd 
_emailServicedd #
.dd# $
SendEmailAsyncdd$ 2
(dd2 3
userdd3 7
.dd7 8
Emaildd8 =
,dd= >
emailSubjectdd? K
,ddK L
	emailBodyddM V
)ddV W
;ddW X
_loggerff 
.ff 
Infoff 
(ff 
$"ff 
$strff -
{ff- .
userff. 2
.ff2 3
Emailff3 8
}ff8 9
$strff9 N
{ffN O
orderResponseffO \
.ff\ ]
OrderIdff] d
}ffd e
"ffe f
)fff g
;ffg h
}gg 
returnii 
Okii 
(ii 
orderResponseii #
)ii# $
;ii$ %
}jj 	
catchkk 
(kk 
	Exceptionkk 
exkk 
)kk 
{ll 	
_loggermm 
.mm 
Errormm 
(mm 
$strmm F
,mmF G
exmmH J
)mmJ K
;mmK L
returnnn 

StatusCodenn 
(nn 
$numnn !
,nn! "
$strnn# :
)nn: ;
;nn; <
}oo 	
}pp 
[qq 
	Authorizeqq 
(qq 
Rolesqq 
=qq 
$strqq 
)qq 
]qq  
[rr 
HttpGetrr 
(rr 
$strrr 
)rr 
]rr 
publicss 

asyncss 
Taskss 
<ss 
IActionResultss #
>ss# $
GetAllOrdersss% 1
(ss1 2
)ss2 3
{tt 
tryuu 
{vv 	
varww 
ordersww 
=ww 
awaitww 
_orderServiceww ,
.ww, -
GetAllOrdersAsyncww- >
(ww> ?
)ww? @
;ww@ A
returnxx 
Okxx 
(xx 
ordersxx 
)xx 
;xx 
}yy 	
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz 
{{{ 	
_logger|| 
.|| 
Error|| 
(|| 
$str|| ?
,||? @
ex||A C
)||C D
;||D E
return}} 

StatusCode}} 
(}} 
$num}} !
,}}! "
$str}}# :
)}}: ;
;}}; <
}~~ 	
} 
[
АА 
	Authorize
АА 
(
АА 
Roles
АА 
=
АА 
$str
АА %
)
АА% &
]
АА& '
[
ББ 
HttpPut
ББ 
(
ББ 
$str
ББ 5
)
ББ5 6
]
ББ6 7
public
ВВ 

async
ВВ 
Task
ВВ 
<
ВВ 
IActionResult
ВВ #
>
ВВ# $#
UpdateOrderItemStatus
ВВ% :
(
ВВ: ;
int
ВВ; >
orderItemId
ВВ? J
,
ВВJ K
[
ВВL M
FromBody
ВВM U
]
ВВU V
OrderItemStatus
ВВW f
status
ВВg m
)
ВВm n
{
ГГ 
try
ДД 
{
ЕЕ 	
await
ЖЖ 
_orderService
ЖЖ 
.
ЖЖ  (
UpdateOrderItemStatusAsync
ЖЖ  :
(
ЖЖ: ;
orderItemId
ЖЖ; F
,
ЖЖF G
status
ЖЖH N
)
ЖЖN O
;
ЖЖO P
_logger
ЗЗ 
.
ЗЗ 
Info
ЗЗ 
(
ЗЗ 
$"
ЗЗ 
$str
ЗЗ E
{
ЗЗE F
orderItemId
ЗЗF Q
}
ЗЗQ R
$str
ЗЗR `
{
ЗЗ` a
status
ЗЗa g
}
ЗЗg h
"
ЗЗh i
)
ЗЗi j
;
ЗЗj k
return
ИИ 
	NoContent
ИИ 
(
ИИ 
)
ИИ 
;
ИИ 
}
ЙЙ 	
catch
КК 
(
КК 
	Exception
КК 
ex
КК 
)
КК 
{
ЛЛ 	
_logger
ММ 
.
ММ 
Error
ММ 
(
ММ 
$"
ММ 
$str
ММ b
{
ММb c
orderItemId
ММc n
}
ММn o
$str
ММo p
"
ММp q
,
ММq r
ex
ММs u
)
ММu v
;
ММv w
return
НН 

StatusCode
НН 
(
НН 
$num
НН !
,
НН! "
$str
НН# :
)
НН: ;
;
НН; <
}
ОО 	
}
ПП 
[
РР 
	Authorize
РР 
(
РР 
Roles
РР 
=
РР 
$str
РР %
)
РР% &
]
РР& '
[
СС 
HttpGet
СС 
(
СС 
$str
СС 
)
СС 
]
СС 
public
ТТ 

async
ТТ 
Task
ТТ 
<
ТТ 
IActionResult
ТТ #
>
ТТ# $#
GetOrderItemsBySeller
ТТ% :
(
ТТ: ;
int
ТТ; >
sellerId
ТТ? G
)
ТТG H
{
УУ 
try
ФФ 
{
ХХ 	
var
ЦЦ 

orderItems
ЦЦ 
=
ЦЦ 
await
ЦЦ "
_orderService
ЦЦ# 0
.
ЦЦ0 1(
GetOrderItemsBySellerAsync
ЦЦ1 K
(
ЦЦK L
sellerId
ЦЦL T
)
ЦЦT U
;
ЦЦU V
return
ЧЧ 
Ok
ЧЧ 
(
ЧЧ 

orderItems
ЧЧ  
)
ЧЧ  !
;
ЧЧ! "
}
ШШ 	
catch
ЩЩ 
(
ЩЩ 
	Exception
ЩЩ 
ex
ЩЩ 
)
ЩЩ 
{
ЪЪ 	
_logger
ЫЫ 
.
ЫЫ 
Error
ЫЫ 
(
ЫЫ 
$str
ЫЫ @
,
ЫЫ@ A
ex
ЫЫA C
)
ЫЫC D
;
ЫЫD E
return
ЬЬ 

StatusCode
ЬЬ 
(
ЬЬ 
$num
ЬЬ !
,
ЬЬ! "
$str
ЬЬ# :
)
ЬЬ: ;
;
ЬЬ; <
}
ЭЭ 	
}
ЮЮ 
[
аа 
	Authorize
аа 
(
аа 
Roles
аа 
=
аа 
$str
аа #
)
аа# $
]
аа$ %
[
бб 
HttpGet
бб 
(
бб 
$str
бб *
)
бб* +
]
бб+ ,
public
вв 

async
вв 
Task
вв 
<
вв 
IActionResult
вв #
>
вв# $!
GetUserOrderHistory
вв% 8
(
вв8 9
int
вв9 <
userId
вв= C
)
ввC D
{
гг 
_logger
дд 
.
дд 
Info
дд 
(
дд 
$"
дд 
$str
дд @
{
дд@ A
userId
ддA G
}
ддG H
"
ддH I
)
ддI J
;
ддJ K
var
ее 

orderItems
ее 
=
ее 
await
ее 
_orderService
ее ,
.
ее, -&
GetUserOrderHistoryAsync
ее- E
(
ееE F
userId
ееF L
)
ееL M
;
ееM N
if
жж 

(
жж 

orderItems
жж 
==
жж 
null
жж 
||
жж !
!
жж" #

orderItems
жж# -
.
жж- .
Any
жж. 1
(
жж1 2
)
жж2 3
)
жж3 4
{
зз 	
_logger
ии 
.
ии 
Warn
ии 
(
ии 
$str
ии ;
+
ии< =
userId
ии> D
)
ииD E
;
ииE F
return
йй 
NotFound
йй 
(
йй 
$str
йй <
)
йй< =
;
йй= >
}
кк 	
return
мм 
Ok
мм 
(
мм 

orderItems
мм 
)
мм 
;
мм 
}
нн 
}оо ╩8
kD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\InventoryController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str &
)& '
]' (
[ 
ApiController 
] 
public		 

class		 
InventoryController		 $
:		% &
ControllerBase		' 5
{

 
private 
readonly 
InventoryService )
_inventoryService* ;
;; <
private 
readonly 
ILogger  
<  !
InventoryController! 4
>4 5
_logger6 =
;= >
public 
InventoryController "
(" #
InventoryService# 3
inventoryService4 D
,D E
ILoggerF M
<M N
InventoryControllerN a
>a b
loggerc i
)i j
{ 	
_inventoryService 
= 
inventoryService  0
;0 1
_logger 
= 
logger 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAllInventories) :
(: ;
); <
{ 	
try 
{ 
var 
inventories 
=  !
await" '
_inventoryService( 9
.9 :"
GetAllInventoriesAsync: P
(P Q
)Q R
;R S
return 
Ok 
( 
inventories %
)% &
;& '
} 
catch 
( 
	Exception 
ex 
)  
{ 
_logger 
. 
LogError  
(  !
ex! #
,# $
$str% W
)W X
;X Y
return 

StatusCode !
(! "
$num" %
,% &
$str' W
)W X
;X Y
}   
}!! 	
[## 	
HttpGet##	 
(## 
$str##  
)##  !
]##! "
public$$ 
async$$ 
Task$$ 
<$$ 
IActionResult$$ '
>$$' (
GetInventoryById$$) 9
($$9 :
int$$: =
inventoryId$$> I
)$$I J
{%% 	
try&& 
{'' 
var(( 
	inventory(( 
=(( 
await((  %
_inventoryService((& 7
.((7 8!
GetInventoryByIdAsync((8 M
(((M N
inventoryId((N Y
)((Y Z
;((Z [
return)) 
Ok)) 
()) 
	inventory)) #
)))# $
;))$ %
}** 
catch++ 
(++ &
InventoryNotFoundException++ -
ex++. 0
)++0 1
{,, 
_logger-- 
.-- 

LogWarning-- "
(--" #
ex--# %
,--% &
$str--' S
,--S T
inventoryId--U `
)--` a
;--a b
return.. 
NotFound.. 
(..  
ex..  "
..." #
Message..# *
)..* +
;..+ ,
}// 
catch00 
(00 
	Exception00 
ex00 
)00  
{11 
_logger22 
.22 
LogError22  
(22  !
ex22! #
,22# $
$str22% g
,22g h
inventoryId22i t
)22t u
;22u v
return33 

StatusCode33 !
(33! "
$num33" %
,33% &
$str33' W
)33W X
;33X Y
}44 
}55 	
[77 	
HttpGet77	 
(77 
$str77 *
)77* +
]77+ ,
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (%
GetInventoriesByProductId88) B
(88B C
int88C F
	productId88G P
)88P Q
{99 	
try:: 
{;; 
var<< 
inventories<< 
=<<  !
await<<" '
_inventoryService<<( 9
.<<9 :*
GetInventoriesByProductIdAsync<<: X
(<<X Y
	productId<<Y b
)<<b c
;<<c d
return== 
Ok== 
(== 
inventories== %
)==% &
;==& '
}>> 
catch?? 
(?? &
InventoryNotFoundException?? -
ex??. 0
)??0 1
{@@ 
_loggerAA 
.AA 

LogWarningAA "
(AA" #
exAA# %
,AA% &
$strAA' V
,AAV W
	productIdAAX a
)AAa b
;AAb c
returnBB 
NotFoundBB 
(BB  
exBB  "
.BB" #
MessageBB# *
)BB* +
;BB+ ,
}CC 
catchDD 
(DD 
	ExceptionDD 
exDD 
)DD  
{EE 
_loggerFF 
.FF 
LogErrorFF  
(FF  !
exFF! #
,FF# $
$strFF% l
,FFl m
	productIdFFn w
)FFw x
;FFx y
returnGG 

StatusCodeGG !
(GG! "
$numGG" %
,GG% &
$strGG' W
)GGW X
;GGX Y
}HH 
}II 	
[KK 	
HttpGetKK	 
(KK 
$strKK .
)KK. /
]KK/ 0
publicLL 
asyncLL 
TaskLL 
<LL 
IActionResultLL '
>LL' ('
GetInventoriesByProductNameLL) D
(LLD E
stringLLE K
productNameLLL W
)LLW X
{MM 	
tryNN 
{OO 
varPP 
inventoriesPP 
=PP  !
awaitPP" '
_inventoryServicePP( 9
.PP9 :,
 GetInventoriesByProductNameAsyncPP: Z
(PPZ [
productNamePP[ f
)PPf g
;PPg h
returnQQ 
OkQQ 
(QQ 
inventoriesQQ %
)QQ% &
;QQ& '
}RR 
catchSS 
(SS &
InventoryNotFoundExceptionSS -
exSS. 0
)SS0 1
{TT 
_loggerUU 
.UU 

LogWarningUU "
(UU" #
exUU# %
,UU% &
$strUU' \
,UU\ ]
productNameUU^ i
)UUi j
;UUj k
returnVV 
NotFoundVV 
(VV  
exVV  "
.VV" #
MessageVV# *
)VV* +
;VV+ ,
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX  
{YY 
_loggerZZ 
.ZZ 
LogErrorZZ  
(ZZ  !
exZZ! #
,ZZ# $
$strZZ% s
,ZZs t
productName	ZZu А
)
ZZА Б
;
ZZБ В
return[[ 

StatusCode[[ !
([[! "
$num[[" %
,[[% &
$str[[' W
)[[W X
;[[X Y
}\\ 
}]] 	
}^^ 
}__ █l
jD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\DiscountController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 
DiscountController

 #
:

$ %
ControllerBase

& 4
{ 
private 
readonly 
DiscountService (
_discountService) 9
;9 :
private 
static 
readonly 
ILog  $
_logger% ,
=- .

LogManager/ 9
.9 :
	GetLogger: C
(C D
typeofD J
(J K
DiscountControllerK ]
)] ^
)^ _
;_ `
public 
DiscountController !
(! "
DiscountService" 1
discountService2 A
)A B
{ 	
_discountService 
= 
discountService .
;. /
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAllDiscounts) 8
(8 9
)9 :
{ 	
try 
{ 
_logger 
. 
Info 
( 
$str 8
)8 9
;9 :
var 
	discounts 
= 
await  %
_discountService& 6
.6 7 
GetAllDiscountsAsync7 K
(K L
)L M
;M N
return 
Ok 
( 
	discounts #
)# $
;$ %
} 
catch 
( 
	Exception 
ex 
)  
{ 
_logger 
. 
Error 
( 
$"  
$str  M
{M N
exN P
.P Q
MessageQ X
}X Y
"Y Z
)Z [
;[ \
return   

StatusCode   !
(  ! "
$num  " %
,  % &
new  ' *
{  + ,
Message  - 4
=  5 6
$str  7 N
}  O P
)  P Q
;  Q R
}!! 
}"" 	
[$$ 	
HttpGet$$	 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' (
GetDiscountById%%) 8
(%%8 9
int%%9 <
id%%= ?
)%%? @
{&& 	
try'' 
{(( 
_logger)) 
.)) 
Info)) 
()) 
$")) 
$str)) <
{))< =
id))= ?
}))? @
"))@ A
)))A B
;))B C
var** 
discount** 
=** 
await** $
_discountService**% 5
.**5 6 
GetDiscountByIdAsync**6 J
(**J K
id**K M
)**M N
;**N O
if++ 
(++ 
discount++ 
==++ 
null++  $
)++$ %
{,, 
_logger-- 
.-- 
Warn--  
(--  !
$"--! #
$str--# 5
{--5 6
id--6 8
}--8 9
$str--9 D
"--D E
)--E F
;--F G
return.. 
NotFound.. #
(..# $
new..$ '
{..( )
Message..* 1
=..2 3
$str..4 I
}..J K
)..K L
;..L M
}// 
return00 
Ok00 
(00 
discount00 "
)00" #
;00# $
}11 
catch22 
(22 
	Exception22 
ex22 
)22  
{33 
_logger44 
.44 
Error44 
(44 
$"44  
$str44  I
{44I J
id44J L
}44L M
$str44M V
{44V W
ex44W Y
.44Y Z
Message44Z a
}44a b
"44b c
)44c d
;44d e
return55 

StatusCode55 !
(55! "
$num55" %
,55% &
new55' *
{55+ ,
Message55- 4
=555 6
$str557 N
}55O P
)55P Q
;55Q R
}66 
}77 	
[99 	
HttpGet99	 
(99 
$str99 +
)99+ ,
]99, -
public:: 
async:: 
Task:: 
<:: 
IActionResult:: '
>::' (
GetDiscountByCode::) :
(::: ;
string::; A
discountCode::B N
)::N O
{;; 	
try<< 
{== 
var>> 
discount>> 
=>> 
await>> $
_discountService>>% 5
.>>5 6"
GetDiscountByCodeAsync>>6 L
(>>L M
discountCode>>M Y
)>>Y Z
;>>Z [
if@@ 
(@@ 
discount@@ 
==@@ 
null@@  $
)@@$ %
{AA 
returnBB 
NotFoundBB #
(BB# $
newBB$ '
{BB( )
messageBB* 1
=BB2 3
$strBB4 K
}BBL M
)BBM N
;BBN O
}CC 
returnEE 
OkEE 
(EE 
discountEE "
)EE" #
;EE# $
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
{II 
_loggerJJ 
.JJ 
ErrorJJ !
(JJ! "
$"JJ" $
$strJJ$ O
{JJO P
discountCodeJJP \
}JJ\ ]
$strJJ] f
{JJf g
exJJg i
.JJi j
MessageJJj q
}JJq r
"JJr s
)JJs t
;JJt u
returnKK 

StatusCodeKK %
(KK% &
$numKK& )
,KK) *
newKK+ .
{KK/ 0
MessageKK1 8
=KK9 :
$strKK; R
}KKS T
)KKT U
;KKU V
}LL 
}MM 
}NN 	
[PP 	
HttpPostPP	 
]PP 
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
IActionResultQQ '
>QQ' (
CreateDiscountQQ) 7
(QQ7 8
[QQ8 9
FromBodyQQ9 A
]QQA B
DiscountDTOQQC N
discountDTOQQO Z
)QQZ [
{RR 	
ifSS 
(SS 
discountDTOSS 
==SS 
nullSS #
)SS# $
{TT 
_loggerUU 
.UU 
WarnUU 
(UU 
$strUU 5
)UU5 6
;UU6 7
returnVV 

BadRequestVV !
(VV! "
newVV" %
{VV& '
MessageVV( /
=VV0 1
$strVV2 N
}VVO P
)VVP Q
;VVQ R
}WW 
tryYY 
{ZZ 
_logger[[ 
.[[ 
Info[[ 
([[ 
$str[[ 5
)[[5 6
;[[6 7
await\\ 
_discountService\\ &
.\\& '
CreateDiscountAsync\\' :
(\\: ;
discountDTO\\; F
)\\F G
;\\G H
return]] 
CreatedAtAction]] &
(]]& '
nameof]]' -
(]]- .
GetDiscountById]]. =
)]]= >
,]]> ?
new]]@ C
{]]D E
id]]F H
=]]I J
discountDTO]]K V
.]]V W

DiscountId]]W a
}]]b c
,]]c d
discountDTO]]e p
)]]p q
;]]q r
}^^ 
catch__ 
(__ 
	Exception__ 
ex__ 
)__  
{`` 
_loggeraa 
.aa 
Erroraa 
(aa 
$"aa  
$straa  F
{aaF G
exaaG I
.aaI J
MessageaaJ Q
}aaQ R
"aaR S
)aaS T
;aaT U
returnbb 

StatusCodebb !
(bb! "
$numbb" %
,bb% &
newbb' *
{bb+ ,
Messagebb- 4
=bb5 6
$strbb7 N
}bbO P
)bbP Q
;bbQ R
}cc 
}dd 	
[ff 	
HttpPutff	 
(ff 
$strff 
)ff 
]ff 
publicgg 
asyncgg 
Taskgg 
<gg 
IActionResultgg '
>gg' (
UpdateDiscountgg) 7
(gg7 8
intgg8 ;
idgg< >
,gg> ?
[gg@ A
FromBodyggA I
]ggI J
DiscountDTOggK V
discountDTOggW b
)ggb c
{hh 	
ifii 
(ii 
discountDTOii 
==ii 
nullii #
)ii# $
{jj 
_loggerkk 
.kk 
Warnkk 
(kk 
$strkk 5
)kk5 6
;kk6 7
returnll 

BadRequestll !
(ll! "
newll" %
{ll& '
Messagell( /
=ll0 1
$strll2 N
}llO P
)llP Q
;llQ R
}mm 
ifoo 
(oo 
idoo 
!=oo 
discountDTOoo !
.oo! "

DiscountIdoo" ,
)oo, -
{pp 
_loggerqq 
.qq 
Warnqq 
(qq 
$"qq 
$strqq I
"qqI J
)qqJ K
;qqK L
returnrr 

BadRequestrr !
(rr! "
newrr" %
{rr& '
Messagerr( /
=rr0 1
$strrr2 I
}rrJ K
)rrK L
;rrL M
}ss 
tryuu 
{vv 
_loggerww 
.ww 
Infoww 
(ww 
$"ww 
$strww :
{ww: ;
idww; =
}ww= >
"ww> ?
)ww? @
;ww@ A
awaitxx 
_discountServicexx &
.xx& '
UpdateDiscountAsyncxx' :
(xx: ;
idxx; =
,xx= >
discountDTOxx> I
)xxI J
;xxJ K
returnyy 
	NoContentyy  
(yy  !
)yy! "
;yy" #
}zz 
catch{{ 
({{  
KeyNotFoundException{{ '
ex{{( *
){{* +
{|| 
_logger}} 
.}} 
Warn}} 
(}} 
$"}} 
$str}} 1
{}}1 2
id}}2 4
}}}4 5
$str}}5 H
{}}H I
ex}}I K
.}}K L
Message}}L S
}}}S T
"}}T U
)}}U V
;}}V W
return~~ 
NotFound~~ 
(~~  
new~~  #
{~~$ %
Message~~& -
=~~. /
$str~~0 E
}~~F G
)~~G H
;~~H I
} 
catch
АА 
(
АА 
	Exception
АА 
ex
АА 
)
АА  
{
ББ 
_logger
ВВ 
.
ВВ 
Error
ВВ 
(
ВВ 
$"
ВВ  
$str
ВВ  G
{
ВВG H
id
ВВH J
}
ВВJ K
$str
ВВK T
{
ВВT U
ex
ВВU W
.
ВВW X
Message
ВВX _
}
ВВ_ `
"
ВВ` a
)
ВВa b
;
ВВb c
return
ГГ 

StatusCode
ГГ !
(
ГГ! "
$num
ГГ" %
,
ГГ% &
new
ГГ' *
{
ГГ+ ,
Message
ГГ- 4
=
ГГ5 6
$str
ГГ7 N
}
ГГO P
)
ГГP Q
;
ГГQ R
}
ДД 
}
ЕЕ 	
[
ЗЗ 	

HttpDelete
ЗЗ	 
(
ЗЗ 
$str
ЗЗ 
)
ЗЗ 
]
ЗЗ 
public
ИИ 
async
ИИ 
Task
ИИ 
<
ИИ 
IActionResult
ИИ '
>
ИИ' (
DeleteDiscount
ИИ) 7
(
ИИ7 8
int
ИИ8 ;
id
ИИ< >
)
ИИ> ?
{
ЙЙ 	
try
КК 
{
ЛЛ 
_logger
ММ 
.
ММ 
Info
ММ 
(
ММ 
$"
ММ 
$str
ММ :
{
ММ: ;
id
ММ; =
}
ММ= >
"
ММ> ?
)
ММ? @
;
ММ@ A
await
НН 
_discountService
НН &
.
НН& '!
DeleteDiscountAsync
НН' :
(
НН: ;
id
НН; =
)
НН= >
;
НН> ?
return
ОО 
	NoContent
ОО  
(
ОО  !
)
ОО! "
;
ОО" #
}
ПП 
catch
РР 
(
РР "
KeyNotFoundException
РР '
ex
РР( *
)
РР* +
{
СС 
_logger
ТТ 
.
ТТ 
Warn
ТТ 
(
ТТ 
$"
ТТ 
$str
ТТ 1
{
ТТ1 2
id
ТТ2 4
}
ТТ4 5
$str
ТТ5 H
{
ТТH I
ex
ТТI K
.
ТТK L
Message
ТТL S
}
ТТS T
"
ТТT U
)
ТТU V
;
ТТV W
return
УУ 
NotFound
УУ 
(
УУ  
new
УУ  #
{
УУ$ %
Message
УУ& -
=
УУ. /
$str
УУ0 E
}
УУF G
)
УУG H
;
УУH I
}
ФФ 
catch
ХХ 
(
ХХ 
	Exception
ХХ 
ex
ХХ 
)
ХХ  
{
ЦЦ 
_logger
ЧЧ 
.
ЧЧ 
Error
ЧЧ 
(
ЧЧ 
$"
ЧЧ  
$str
ЧЧ  G
{
ЧЧG H
id
ЧЧH J
}
ЧЧJ K
$str
ЧЧK T
{
ЧЧT U
ex
ЧЧU W
.
ЧЧW X
Message
ЧЧX _
}
ЧЧ_ `
"
ЧЧ` a
)
ЧЧa b
;
ЧЧb c
return
ШШ 

StatusCode
ШШ !
(
ШШ! "
$num
ШШ" %
,
ШШ% &
new
ШШ' *
{
ШШ+ ,
Message
ШШ- 4
=
ШШ5 6
$str
ШШ7 N
}
ШШO P
)
ШШP Q
;
ШШQ R
}
ЩЩ 
}
ЪЪ 	
}
ЫЫ 
}ЬЬ ╡З
jD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\CategoryController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[

 
ApiController

 
]

 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
CategoryController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
CategoryService (
_categoryService) 9
;9 :
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
CategoryControllerG Y
)Y Z
)Z [
;[ \
public 
CategoryController !
(! "
CategoryService" 1
categoryService2 A
)A B
{ 	
_categoryService 
= 
categoryService .
;. /
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str "
)" #
]# $
[ 	
HttpPost	 
( 
$str '
)' (
]( )
public 
async 
Task 
< 
IActionResult '
>' (
AddParentCategory) :
(: ;
ParentCategoryDTO; L
parentCategoryDTOM ^
)^ _
{ 	
try 
{ 
log 
. 
Info 
( 
$str 6
)6 7
;7 8
var 
id 
= 
await 
_categoryService /
./ 0"
AddParentCategoryAsync0 F
(F G
parentCategoryDTOG X
)X Y
;Y Z
log   
.   
Info   
(   
$"   
$str   9
{  9 :
id  : <
}  < =
"  = >
)  > ?
;  ? @
return!! 
Ok!! 
(!! 
new!! 
{!! 
ParentCategoryId!!  0
=!!1 2
id!!3 5
}!!6 7
)!!7 8
;!!8 9
}"" 
catch## 
(## &
ItemAlreadyExistsException## -
ex##. 0
)##0 1
{$$ 
log%% 
.%% 
Error%% 
(%% 
$str%% 6
+%%7 8
ex%%9 ;
.%%; <
Message%%< C
)%%C D
;%%D E
return&& 
Conflict&& 
(&&  
ex&&  "
.&&" #
Message&&# *
)&&* +
;&&+ ,
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
log** 
.** 
Error** 
(** 
$str** 6
+**7 8
ex**9 ;
.**; <
Message**< C
)**C D
;**D E
return++ 

StatusCode++ !
(++! "
$num++" %
,++% &
$str++' >
)++> ?
;++? @
},, 
}-- 	
[// 	
HttpGet//	 
(// 
$str// '
)//' (
]//( )
public00 
async00 
Task00 
<00 
IActionResult00 '
>00' (!
GetParentCategoryById00) >
(00> ?
int00? B
id00C E
)00E F
{11 	
try22 
{33 
log44 
.44 
Info44 
(44 
$"44 
$str44 C
{44C D
id44D F
}44F G
"44G H
)44H I
;44I J
var55 
category55 
=55 
await55 $
_categoryService55% 5
.555 6&
GetParentCategoryByIdAsync556 P
(55P Q
id55Q S
)55S T
;55T U
return66 
Ok66 
(66 
category66 "
)66" #
;66# $
}77 
catch88 
(88 %
CategoryNotFoundException88 ,
ex88- /
)88/ 0
{99 
log:: 
.:: 
Error:: 
(:: 
$str:: :
+::; <
ex::= ?
.::? @
Message::@ G
)::G H
;::H I
return;; 
NotFound;; 
(;;  
ex;;  "
.;;" #
Message;;# *
);;* +
;;;+ ,
}<< 
catch== 
(== 
	Exception== 
ex== 
)==  
{>> 
log?? 
.?? 
Error?? 
(?? 
$str?? :
+??; <
ex??= ?
.??? @
Message??@ G
)??G H
;??H I
return@@ 

StatusCode@@ !
(@@! "
$num@@" %
,@@% &
$str@@' >
)@@> ?
;@@? @
}AA 
}BB 	
[CC 	
HttpGetCC	 
(CC 
$strCC (
)CC( )
]CC) *
publicDD 
asyncDD 
TaskDD 
<DD 
IActionResultDD '
>DD' ("
GetAllParentCategoriesDD) ?
(DD? @
)DD@ A
{EE 	
tryFF 
{GG 
logHH 
.HH 
InfoHH 
(HH 
$strHH ;
)HH; <
;HH< =
varII 

categoriesII 
=II  
awaitII! &
_categoryServiceII' 7
.II7 8'
GetAllParentCategoriesAsyncII8 S
(IIS T
)IIT U
;IIU V
returnJJ 
OkJJ 
(JJ 

categoriesJJ $
)JJ$ %
;JJ% &
}KK 
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL  
{MM 
logNN 
.NN 
ErrorNN 
(NN 
$strNN ;
+NN< =
exNN> @
.NN@ A
MessageNNA H
)NNH I
;NNI J
returnOO 

StatusCodeOO !
(OO! "
$numOO" %
,OO% &
$strOO' >
)OO> ?
;OO? @
}PP 
}QQ 	
[SS 	
	AuthorizeSS	 
(SS 
RolesSS 
=SS 
$strSS "
)SS" #
]SS# $
[TT 	
HttpPutTT	 
(TT 
$strTT )
)TT) *
]TT* +
publicUU 
asyncUU 
TaskUU 
<UU 
IActionResultUU '
>UU' ( 
UpdateParentCategoryUU) =
(UU= >
ParentCategoryDTOUU> O
parentCategoryDTOUUP a
)UUa b
{VV 	
tryWW 
{XX 
logYY 
.YY 
InfoYY 
(YY 
$strYY 9
)YY9 :
;YY: ;
varZZ 
updatedCategoryZZ #
=ZZ$ %
awaitZZ& +
_categoryServiceZZ, <
.ZZ< =%
UpdateParentCategoryAsyncZZ= V
(ZZV W
parentCategoryDTOZZW h
)ZZh i
;ZZi j
log[[ 
.[[ 
Info[[ 
([[ 
$"[[ 
$str[[ ;
{[[; <
updatedCategory[[< K
.[[K L
ParentCategoryId[[L \
}[[\ ]
"[[] ^
)[[^ _
;[[_ `
return\\ 
Ok\\ 
(\\ 
updatedCategory\\ )
)\\) *
;\\* +
}]] 
catch^^ 
(^^ %
CategoryNotFoundException^^ ,
ex^^- /
)^^/ 0
{__ 
log`` 
.`` 
Error`` 
(`` 
$str`` 9
+``: ;
ex``< >
.``> ?
Message``? F
)``F G
;``G H
returnaa 
NotFoundaa 
(aa  
exaa  "
.aa" #
Messageaa# *
)aa* +
;aa+ ,
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
logee 
.ee 
Erroree 
(ee 
$stree 9
+ee: ;
exee< >
.ee> ?
Messageee? F
)eeF G
;eeG H
returnff 

StatusCodeff !
(ff! "
$numff" %
,ff% &
$strff' >
)ff> ?
;ff? @
}gg 
}hh 	
[ii 	
	Authorizeii	 
(ii 
Rolesii 
=ii 
$strii "
)ii" #
]ii# $
[jj 	

HttpDeletejj	 
(jj 
$strjj *
)jj* +
]jj+ ,
publickk 
asynckk 
Taskkk 
<kk 
IActionResultkk '
>kk' ( 
DeleteParentCategorykk) =
(kk= >
intkk> A
idkkB D
)kkD E
{ll 	
trymm 
{nn 
logoo 
.oo 
Infooo 
(oo 
$"oo 
$stroo B
{ooB C
idooC E
}ooE F
"ooF G
)ooG H
;ooH I
varpp 
resultpp 
=pp 
awaitpp "
_categoryServicepp# 3
.pp3 4%
DeleteParentCategoryAsyncpp4 M
(ppM N
idppN P
)ppP Q
;ppQ R
ifqq 
(qq 
resultqq 
)qq 
{rr 
logss 
.ss 
Infoss 
(ss 
$"ss 
$strss ?
{ss? @
idss@ B
}ssB C
"ssC D
)ssD E
;ssE F
returntt 
	NoContenttt $
(tt$ %
)tt% &
;tt& '
}uu 
returnvv 

StatusCodevv !
(vv! "
$numvv" %
,vv% &
$strvv' I
)vvI J
;vvJ K
}ww 
catchxx 
(xx %
CategoryNotFoundExceptionxx ,
exxx- /
)xx/ 0
{yy 
logzz 
.zz 
Errorzz 
(zz 
$strzz 9
+zz: ;
exzz< >
.zz> ?
Messagezz? F
)zzF G
;zzG H
return{{ 
NotFound{{ 
({{  
ex{{  "
.{{" #
Message{{# *
){{* +
;{{+ ,
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
log 
. 
Error 
( 
$str 9
+: ;
ex< >
.> ?
Message? F
)F G
;G H
return
АА 

StatusCode
АА !
(
АА! "
$num
АА" %
,
АА% &
$str
АА' >
)
АА> ?
;
АА? @
}
ББ 
}
ВВ 	
[
ЕЕ 	
	Authorize
ЕЕ	 
(
ЕЕ 
Roles
ЕЕ 
=
ЕЕ 
$str
ЕЕ "
)
ЕЕ" #
]
ЕЕ# $
[
ЖЖ 	
HttpPost
ЖЖ	 
(
ЖЖ 
$str
ЖЖ $
)
ЖЖ$ %
]
ЖЖ% &
public
ЗЗ 
async
ЗЗ 
Task
ЗЗ 
<
ЗЗ 
IActionResult
ЗЗ '
>
ЗЗ' (
AddSubCategory
ЗЗ) 7
(
ЗЗ7 8
SubCategoryDTO
ЗЗ8 F
subCategoryDTO
ЗЗG U
)
ЗЗU V
{
ИИ 	
try
ЙЙ 
{
КК 
log
ЛЛ 
.
ЛЛ 
Info
ЛЛ 
(
ЛЛ 
$str
ЛЛ 3
)
ЛЛ3 4
;
ЛЛ4 5
var
ММ 
id
ММ 
=
ММ 
await
ММ 
_categoryService
ММ /
.
ММ/ 0!
AddSubCategoryAsync
ММ0 C
(
ММC D
subCategoryDTO
ММD R
)
ММR S
;
ММS T
log
НН 
.
НН 
Info
НН 
(
НН 
$"
НН 
$str
НН 6
{
НН6 7
id
НН7 9
}
НН9 :
"
НН: ;
)
НН; <
;
НН< =
return
ОО 
Ok
ОО 
(
ОО 
new
ОО 
{
ОО 
SubCategoryId
ОО  -
=
ОО. /
id
ОО0 2
}
ОО3 4
)
ОО4 5
;
ОО5 6
}
ПП 
catch
РР 
(
РР (
ItemAlreadyExistsException
РР -
ex
РР. 0
)
РР0 1
{
СС 
log
ТТ 
.
ТТ 
Error
ТТ 
(
ТТ 
$str
ТТ 3
+
ТТ4 5
ex
ТТ6 8
.
ТТ8 9
Message
ТТ9 @
)
ТТ@ A
;
ТТA B
return
УУ 
Conflict
УУ 
(
УУ  
ex
УУ  "
.
УУ" #
Message
УУ# *
)
УУ* +
;
УУ+ ,
}
ФФ 
catch
ХХ 
(
ХХ 
	Exception
ХХ 
ex
ХХ 
)
ХХ  
{
ЦЦ 
log
ЧЧ 
.
ЧЧ 
Error
ЧЧ 
(
ЧЧ 
$str
ЧЧ 3
+
ЧЧ4 5
ex
ЧЧ6 8
.
ЧЧ8 9
Message
ЧЧ9 @
)
ЧЧ@ A
;
ЧЧA B
return
ШШ 

StatusCode
ШШ !
(
ШШ! "
$num
ШШ" %
,
ШШ% &
$str
ШШ' >
)
ШШ> ?
;
ШШ? @
}
ЩЩ 
}
ЪЪ 	
[
ЬЬ 	
HttpGet
ЬЬ	 
(
ЬЬ 
$str
ЬЬ $
)
ЬЬ$ %
]
ЬЬ% &
public
ЭЭ 
async
ЭЭ 
Task
ЭЭ 
<
ЭЭ 
IActionResult
ЭЭ '
>
ЭЭ' ( 
GetSubCategoryById
ЭЭ) ;
(
ЭЭ; <
int
ЭЭ< ?
id
ЭЭ@ B
)
ЭЭB C
{
ЮЮ 	
try
ЯЯ 
{
аа 
log
бб 
.
бб 
Info
бб 
(
бб 
$"
бб 
$str
бб @
{
бб@ A
id
ббA C
}
ббC D
"
ббD E
)
ббE F
;
ббF G
var
вв 
subCategory
вв 
=
вв  !
await
вв" '
_categoryService
вв( 8
.
вв8 9%
GetSubCategoryByIdAsync
вв9 P
(
ввP Q
id
ввQ S
)
ввS T
;
ввT U
return
гг 
Ok
гг 
(
гг 
subCategory
гг %
)
гг% &
;
гг& '
}
дд 
catch
ее 
(
ее '
CategoryNotFoundException
ее ,
ex
ее- /
)
ее/ 0
{
жж 
log
зз 
.
зз 
Error
зз 
(
зз 
$str
зз 7
+
зз8 9
ex
зз: <
.
зз< =
Message
зз= D
)
ззD E
;
ззE F
return
ии 
NotFound
ии 
(
ии  
ex
ии  "
.
ии" #
Message
ии# *
)
ии* +
;
ии+ ,
}
йй 
catch
кк 
(
кк 
	Exception
кк 
ex
кк 
)
кк  
{
лл 
log
мм 
.
мм 
Error
мм 
(
мм 
$str
мм 7
+
мм8 9
ex
мм: <
.
мм< =
Message
мм= D
)
ммD E
;
ммE F
return
нн 

StatusCode
нн !
(
нн! "
$num
нн" %
,
нн% &
$str
нн' >
)
нн> ?
;
нн? @
}
оо 
}
пп 	
[
▒▒ 	
HttpGet
▒▒	 
(
▒▒ 
$str
▒▒ !
)
▒▒! "
]
▒▒" #
public
▓▓ 
async
▓▓ 
Task
▓▓ 
<
▓▓ 
IActionResult
▓▓ '
>
▓▓' (!
GetAllSubCategories
▓▓) <
(
▓▓< =
)
▓▓= >
{
││ 	
try
┤┤ 
{
╡╡ 
log
╢╢ 
.
╢╢ 
Info
╢╢ 
(
╢╢ 
$str
╢╢ 8
)
╢╢8 9
;
╢╢9 :
var
╖╖ 
subCategories
╖╖ !
=
╖╖" #
await
╖╖$ )
_categoryService
╖╖* :
.
╖╖: ;&
GetAllSubCategoriesAsync
╖╖; S
(
╖╖S T
)
╖╖T U
;
╖╖U V
return
╕╕ 
Ok
╕╕ 
(
╕╕ 
subCategories
╕╕ '
)
╕╕' (
;
╕╕( )
}
╣╣ 
catch
║║ 
(
║║ 
	Exception
║║ 
ex
║║ 
)
║║  
{
╗╗ 
log
╝╝ 
.
╝╝ 
Error
╝╝ 
(
╝╝ 
$str
╝╝ 8
+
╝╝9 :
ex
╝╝; =
.
╝╝= >
Message
╝╝> E
)
╝╝E F
;
╝╝F G
return
╜╜ 

StatusCode
╜╜ !
(
╜╜! "
$num
╜╜" %
,
╜╜% &
$str
╜╜' >
)
╜╜> ?
;
╜╜? @
}
╛╛ 
}
┐┐ 	
[
┴┴ 	
HttpGet
┴┴	 
(
┴┴ 
$str
┴┴ 3
)
┴┴3 4
]
┴┴4 5
public
┬┬ 
async
┬┬ 
Task
┬┬ 
<
┬┬ 
IActionResult
┬┬ '
>
┬┬' ((
GetSubCategoriesByParentId
┬┬) C
(
┬┬C D
int
┬┬D G
parentId
┬┬H P
)
┬┬P Q
{
├├ 	
try
── 
{
┼┼ 
log
╞╞ 
.
╞╞ 
Info
╞╞ 
(
╞╞ 
$"
╞╞ 
$str
╞╞ V
{
╞╞V W
parentId
╞╞W _
}
╞╞_ `
"
╞╞` a
)
╞╞a b
;
╞╞b c
var
╟╟ 
subCategories
╟╟ !
=
╟╟" #
await
╟╟$ )
_categoryService
╟╟* :
.
╟╟: ;-
GetSubCategoriesByParentIdAsync
╟╟; Z
(
╟╟Z [
parentId
╟╟[ c
)
╟╟c d
;
╟╟d e
return
╚╚ 
Ok
╚╚ 
(
╚╚ 
subCategories
╚╚ '
)
╚╚' (
;
╚╚( )
}
╔╔ 
catch
╩╩ 
(
╩╩ 
	Exception
╩╩ 
ex
╩╩ 
)
╩╩  
{
╦╦ 
log
╠╠ 
.
╠╠ 
Error
╠╠ 
(
╠╠ 
$str
╠╠ ?
+
╠╠@ A
ex
╠╠B D
.
╠╠D E
Message
╠╠E L
)
╠╠L M
;
╠╠M N
return
══ 

StatusCode
══ !
(
══! "
$num
══" %
,
══% &
$str
══' >
)
══> ?
;
══? @
}
╬╬ 
}
╧╧ 	
[
╤╤ 	
	Authorize
╤╤	 
(
╤╤ 
Roles
╤╤ 
=
╤╤ 
$str
╤╤ "
)
╤╤" #
]
╤╤# $
[
╥╥ 	
HttpPut
╥╥	 
(
╥╥ 
$str
╥╥ 
)
╥╥  
]
╥╥  !
public
╙╙ 
async
╙╙ 
Task
╙╙ 
<
╙╙ 
IActionResult
╙╙ '
>
╙╙' (
UpdateSubCategory
╙╙) :
(
╙╙: ;
SubCategoryDTO
╙╙; I
subCategoryDTO
╙╙J X
)
╙╙X Y
{
╘╘ 	
try
╒╒ 
{
╓╓ 
log
╫╫ 
.
╫╫ 
Info
╫╫ 
(
╫╫ 
$str
╫╫ 6
)
╫╫6 7
;
╫╫7 8
var
╪╪  
updatedSubCategory
╪╪ &
=
╪╪' (
await
╪╪) .
_categoryService
╪╪/ ?
.
╪╪? @$
UpdateSubCategoryAsync
╪╪@ V
(
╪╪V W
subCategoryDTO
╪╪W e
)
╪╪e f
;
╪╪f g
log
┘┘ 
.
┘┘ 
Info
┘┘ 
(
┘┘ 
$"
┘┘ 
$str
┘┘ 8
{
┘┘8 9 
updatedSubCategory
┘┘9 K
.
┘┘K L
SubCategoryId
┘┘L Y
}
┘┘Y Z
"
┘┘Z [
)
┘┘[ \
;
┘┘\ ]
return
┌┌ 
Ok
┌┌ 
(
┌┌  
updatedSubCategory
┌┌ ,
)
┌┌, -
;
┌┌- .
}
██ 
catch
▄▄ 
(
▄▄ '
CategoryNotFoundException
▄▄ ,
ex
▄▄- /
)
▄▄/ 0
{
▌▌ 
log
▐▐ 
.
▐▐ 
Error
▐▐ 
(
▐▐ 
$str
▐▐ 6
+
▐▐7 8
ex
▐▐9 ;
.
▐▐; <
Message
▐▐< C
)
▐▐C D
;
▐▐D E
return
▀▀ 
NotFound
▀▀ 
(
▀▀  
ex
▀▀  "
.
▀▀" #
Message
▀▀# *
)
▀▀* +
;
▀▀+ ,
}
рр 
catch
сс 
(
сс 
	Exception
сс 
ex
сс 
)
сс  
{
тт 
log
уу 
.
уу 
Error
уу 
(
уу 
$str
уу 6
+
уу7 8
ex
уу9 ;
.
уу; <
Message
уу< C
)
ууC D
;
ууD E
return
фф 

StatusCode
фф !
(
фф! "
$num
фф" %
,
фф% &
$str
фф' >
)
фф> ?
;
фф? @
}
хх 
}
цц 	
[
шш 	
	Authorize
шш	 
(
шш 
Roles
шш 
=
шш 
$str
шш "
)
шш" #
]
шш# $
[
щщ 	

HttpDelete
щщ	 
(
щщ 
$str
щщ '
)
щщ' (
]
щщ( )
public
ъъ 
async
ъъ 
Task
ъъ 
<
ъъ 
IActionResult
ъъ '
>
ъъ' (
DeleteSubCategory
ъъ) :
(
ъъ: ;
int
ъъ; >
id
ъъ? A
)
ъъA B
{
ыы 	
try
ьь 
{
ээ 
log
юю 
.
юю 
Info
юю 
(
юю 
$"
юю 
$str
юю ?
{
юю? @
id
юю@ B
}
ююB C
"
ююC D
)
ююD E
;
ююE F
var
яя 
result
яя 
=
яя 
await
яя "
_categoryService
яя# 3
.
яя3 4$
DeleteSubCategoryAsync
яя4 J
(
яяJ K
id
яяK M
)
яяM N
;
яяN O
if
ЁЁ 
(
ЁЁ 
result
ЁЁ 
)
ЁЁ 
{
ёё 
log
ЄЄ 
.
ЄЄ 
Info
ЄЄ 
(
ЄЄ 
$"
ЄЄ 
$str
ЄЄ <
{
ЄЄ< =
id
ЄЄ= ?
}
ЄЄ? @
"
ЄЄ@ A
)
ЄЄA B
;
ЄЄB C
return
єє 
	NoContent
єє $
(
єє$ %
)
єє% &
;
єє& '
}
ЇЇ 
return
її 

StatusCode
її !
(
її! "
$num
її" %
,
її% &
$str
її' F
)
їїF G
;
їїG H
}
ЎЎ 
catch
ўў 
(
ўў '
CategoryNotFoundException
ўў ,
ex
ўў- /
)
ўў/ 0
{
°° 
log
∙∙ 
.
∙∙ 
Error
∙∙ 
(
∙∙ 
$str
∙∙ 6
+
∙∙7 8
ex
∙∙9 ;
.
∙∙; <
Message
∙∙< C
)
∙∙C D
;
∙∙D E
return
·· 
NotFound
·· 
(
··  
ex
··  "
.
··" #
Message
··# *
)
··* +
;
··+ ,
}
√√ 
catch
№№ 
(
№№ 
	Exception
№№ 
ex
№№ 
)
№№  
{
¤¤ 
log
■■ 
.
■■ 
Error
■■ 
(
■■ 
$str
■■ 6
+
■■7 8
ex
■■9 ;
.
■■; <
Message
■■< C
)
■■C D
;
■■D E
return
   

StatusCode
   !
(
  ! "
$num
  " %
,
  % &
$str
  ' >
)
  > ?
;
  ? @
}
АА 
}
ББ 	
[
ДД 	
	Authorize
ДД	 
(
ДД 
Roles
ДД 
=
ДД 
$str
ДД "
)
ДД" #
]
ДД# $
[
ЕЕ 	
HttpPost
ЕЕ	 
(
ЕЕ 
$str
ЕЕ 
)
ЕЕ 
]
ЕЕ 
public
ЖЖ 
async
ЖЖ 
Task
ЖЖ 
<
ЖЖ 
IActionResult
ЖЖ '
>
ЖЖ' (
AddBrand
ЖЖ) 1
(
ЖЖ1 2
BrandDTO
ЖЖ2 :
brandDTO
ЖЖ; C
)
ЖЖC D
{
ЗЗ 	
try
ИИ 
{
ЙЙ 
log
КК 
.
КК 
Info
КК 
(
КК 
$str
КК -
)
КК- .
;
КК. /
var
ЛЛ 
id
ЛЛ 
=
ЛЛ 
await
ЛЛ 
_categoryService
ЛЛ /
.
ЛЛ/ 0
AddBrandAsync
ЛЛ0 =
(
ЛЛ= >
brandDTO
ЛЛ> F
)
ЛЛF G
;
ЛЛG H
log
ММ 
.
ММ 
Info
ММ 
(
ММ 
$"
ММ 
$str
ММ 0
{
ММ0 1
id
ММ1 3
}
ММ3 4
"
ММ4 5
)
ММ5 6
;
ММ6 7
return
НН 
Ok
НН 
(
НН 
new
НН 
{
НН 
BrandId
НН  '
=
НН( )
id
НН* ,
}
НН- .
)
НН. /
;
НН/ 0
}
ОО 
catch
ПП 
(
ПП (
ItemAlreadyExistsException
ПП -
ex
ПП. 0
)
ПП0 1
{
РР 
log
СС 
.
СС 
Error
СС 
(
СС 
$str
СС -
+
СС. /
ex
СС0 2
.
СС2 3
Message
СС3 :
)
СС: ;
;
СС; <
return
ТТ 
Conflict
ТТ 
(
ТТ  
ex
ТТ  "
.
ТТ" #
Message
ТТ# *
)
ТТ* +
;
ТТ+ ,
}
УУ 
catch
ФФ 
(
ФФ 
	Exception
ФФ 
ex
ФФ 
)
ФФ  
{
ХХ 
log
ЦЦ 
.
ЦЦ 
Error
ЦЦ 
(
ЦЦ 
$str
ЦЦ -
+
ЦЦ. /
ex
ЦЦ0 2
.
ЦЦ2 3
Message
ЦЦ3 :
)
ЦЦ: ;
;
ЦЦ; <
return
ЧЧ 

StatusCode
ЧЧ !
(
ЧЧ! "
$num
ЧЧ" %
,
ЧЧ% &
$str
ЧЧ' >
)
ЧЧ> ?
;
ЧЧ? @
}
ШШ 
}
ЩЩ 	
[
ЫЫ 	
HttpGet
ЫЫ	 
(
ЫЫ 
$str
ЫЫ 
)
ЫЫ 
]
ЫЫ 
public
ЬЬ 
async
ЬЬ 
Task
ЬЬ 
<
ЬЬ 
IActionResult
ЬЬ '
>
ЬЬ' (
GetBrandById
ЬЬ) 5
(
ЬЬ5 6
int
ЬЬ6 9
id
ЬЬ: <
)
ЬЬ< =
{
ЭЭ 	
try
ЮЮ 
{
ЯЯ 
log
аа 
.
аа 
Info
аа 
(
аа 
$"
аа 
$str
аа :
{
аа: ;
id
аа; =
}
аа= >
"
аа> ?
)
аа? @
;
аа@ A
var
бб 
brand
бб 
=
бб 
await
бб !
_categoryService
бб" 2
.
бб2 3
GetBrandByIdAsync
бб3 D
(
ббD E
id
ббE G
)
ббG H
;
ббH I
return
вв 
Ok
вв 
(
вв 
brand
вв 
)
вв  
;
вв  !
}
гг 
catch
дд 
(
дд $
BrandNotFoundException
дд )
ex
дд* ,
)
дд, -
{
ее 
log
жж 
.
жж 
Error
жж 
(
жж 
$str
жж 1
+
жж2 3
ex
жж4 6
.
жж6 7
Message
жж7 >
)
жж> ?
;
жж? @
return
зз 
NotFound
зз 
(
зз  
ex
зз  "
.
зз" #
Message
зз# *
)
зз* +
;
зз+ ,
}
ии 
catch
йй 
(
йй 
	Exception
йй 
ex
йй 
)
йй  
{
кк 
log
лл 
.
лл 
Error
лл 
(
лл 
$str
лл 1
+
лл2 3
ex
лл4 6
.
лл6 7
Message
лл7 >
)
лл> ?
;
лл? @
return
мм 

StatusCode
мм !
(
мм! "
$num
мм" %
,
мм% &
$str
мм' >
)
мм> ?
;
мм? @
}
нн 
}
оо 	
[
░░ 	
HttpGet
░░	 
(
░░ 
$str
░░ 
)
░░ 
]
░░ 
public
▒▒ 
async
▒▒ 
Task
▒▒ 
<
▒▒ 
IActionResult
▒▒ '
>
▒▒' (
GetAllBrands
▒▒) 5
(
▒▒5 6
)
▒▒6 7
{
▓▓ 	
try
││ 
{
┤┤ 
log
╡╡ 
.
╡╡ 
Info
╡╡ 
(
╡╡ 
$str
╡╡ 1
)
╡╡1 2
;
╡╡2 3
var
╢╢ 
brands
╢╢ 
=
╢╢ 
await
╢╢ "
_categoryService
╢╢# 3
.
╢╢3 4
GetAllBrandsAsync
╢╢4 E
(
╢╢E F
)
╢╢F G
;
╢╢G H
return
╖╖ 
Ok
╖╖ 
(
╖╖ 
brands
╖╖  
)
╖╖  !
;
╖╖! "
}
╕╕ 
catch
╣╣ 
(
╣╣ 
	Exception
╣╣ 
ex
╣╣ 
)
╣╣  
{
║║ 
log
╗╗ 
.
╗╗ 
Error
╗╗ 
(
╗╗ 
$str
╗╗ 1
+
╗╗2 3
ex
╗╗4 6
.
╗╗6 7
Message
╗╗7 >
)
╗╗> ?
;
╗╗? @
return
╝╝ 

StatusCode
╝╝ !
(
╝╝! "
$num
╝╝" %
,
╝╝% &
$str
╝╝' >
)
╝╝> ?
;
╝╝? @
}
╜╜ 
}
╛╛ 	
[
┐┐ 	
	Authorize
┐┐	 
(
┐┐ 
Roles
┐┐ 
=
┐┐ 
$str
┐┐ "
)
┐┐" #
]
┐┐# $
[
└└ 	
HttpPut
└└	 
(
└└ 
$str
└└ 
)
└└ 
]
└└ 
public
┴┴ 
async
┴┴ 
Task
┴┴ 
<
┴┴ 
IActionResult
┴┴ '
>
┴┴' (
UpdateBrand
┴┴) 4
(
┴┴4 5
BrandDTO
┴┴5 =
brandDTO
┴┴> F
)
┴┴F G
{
┬┬ 	
try
├├ 
{
── 
log
┼┼ 
.
┼┼ 
Info
┼┼ 
(
┼┼ 
$str
┼┼ 0
)
┼┼0 1
;
┼┼1 2
var
╞╞ 
updatedBrand
╞╞  
=
╞╞! "
await
╞╞# (
_categoryService
╞╞) 9
.
╞╞9 :
UpdateBrandAsync
╞╞: J
(
╞╞J K
brandDTO
╞╞K S
)
╞╞S T
;
╞╞T U
log
╟╟ 
.
╟╟ 
Info
╟╟ 
(
╟╟ 
$"
╟╟ 
$str
╟╟ 2
{
╟╟2 3
updatedBrand
╟╟3 ?
.
╟╟? @
BrandId
╟╟@ G
}
╟╟G H
"
╟╟H I
)
╟╟I J
;
╟╟J K
return
╚╚ 
Ok
╚╚ 
(
╚╚ 
updatedBrand
╚╚ &
)
╚╚& '
;
╚╚' (
}
╔╔ 
catch
╩╩ 
(
╩╩ $
BrandNotFoundException
╩╩ )
ex
╩╩* ,
)
╩╩, -
{
╦╦ 
log
╠╠ 
.
╠╠ 
Error
╠╠ 
(
╠╠ 
$str
╠╠ 0
+
╠╠1 2
ex
╠╠3 5
.
╠╠5 6
Message
╠╠6 =
)
╠╠= >
;
╠╠> ?
return
══ 
NotFound
══ 
(
══  
ex
══  "
.
══" #
Message
══# *
)
══* +
;
══+ ,
}
╬╬ 
catch
╧╧ 
(
╧╧ 
	Exception
╧╧ 
ex
╧╧ 
)
╧╧  
{
╨╨ 
log
╤╤ 
.
╤╤ 
Error
╤╤ 
(
╤╤ 
$str
╤╤ 0
+
╤╤1 2
ex
╤╤3 5
.
╤╤5 6
Message
╤╤6 =
)
╤╤= >
;
╤╤> ?
return
╥╥ 

StatusCode
╥╥ !
(
╥╥! "
$num
╥╥" %
,
╥╥% &
$str
╥╥' >
)
╥╥> ?
;
╥╥? @
}
╙╙ 
}
╘╘ 	
[
╒╒ 	
	Authorize
╒╒	 
(
╒╒ 
Roles
╒╒ 
=
╒╒ 
$str
╒╒ "
)
╒╒" #
]
╒╒# $
[
╓╓ 	

HttpDelete
╓╓	 
(
╓╓ 
$str
╓╓  
)
╓╓  !
]
╓╓! "
public
╫╫ 
async
╫╫ 
Task
╫╫ 
<
╫╫ 
IActionResult
╫╫ '
>
╫╫' (
DeleteBrand
╫╫) 4
(
╫╫4 5
int
╫╫5 8
id
╫╫9 ;
)
╫╫; <
{
╪╪ 	
try
┘┘ 
{
┌┌ 
log
██ 
.
██ 
Info
██ 
(
██ 
$"
██ 
$str
██ 9
{
██9 :
id
██: <
}
██< =
"
██= >
)
██> ?
;
██? @
var
▄▄ 
result
▄▄ 
=
▄▄ 
await
▄▄ "
_categoryService
▄▄# 3
.
▄▄3 4
DeleteBrandAsync
▄▄4 D
(
▄▄D E
id
▄▄E G
)
▄▄G H
;
▄▄H I
if
▌▌ 
(
▌▌ 
result
▌▌ 
)
▌▌ 
{
▐▐ 
log
▀▀ 
.
▀▀ 
Info
▀▀ 
(
▀▀ 
$"
▀▀ 
$str
▀▀ 6
{
▀▀6 7
id
▀▀7 9
}
▀▀9 :
"
▀▀: ;
)
▀▀; <
;
▀▀< =
return
рр 
	NoContent
рр $
(
рр$ %
)
рр% &
;
рр& '
}
сс 
return
тт 

StatusCode
тт !
(
тт! "
$num
тт" %
,
тт% &
$str
тт' ?
)
тт? @
;
тт@ A
}
уу 
catch
фф 
(
фф $
BrandNotFoundException
фф )
ex
фф* ,
)
фф, -
{
хх 
log
цц 
.
цц 
Error
цц 
(
цц 
$str
цц 0
+
цц1 2
ex
цц3 5
.
цц5 6
Message
цц6 =
)
цц= >
;
цц> ?
return
чч 
NotFound
чч 
(
чч  
ex
чч  "
.
чч" #
Message
чч# *
)
чч* +
;
чч+ ,
}
шш 
catch
щщ 
(
щщ 
	Exception
щщ 
ex
щщ 
)
щщ  
{
ъъ 
log
ыы 
.
ыы 
Error
ыы 
(
ыы 
$str
ыы 0
+
ыы1 2
ex
ыы3 5
.
ыы5 6
Message
ыы6 =
)
ыы= >
;
ыы> ?
return
ьь 

StatusCode
ьь !
(
ьь! "
$num
ьь" %
,
ьь% &
$str
ьь' >
)
ьь> ?
;
ьь? @
}
ээ 
}
юю 	
}
яя 
}ЁЁ ВN
fD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\CartController.cs
	namespace		 	

EcomWebApp		
 
.		 
Controllers		  
{

 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
CartController 
:  !
ControllerBase" 0
{ 
private 
readonly 
ILog 
_logger %
=& '

LogManager( 2
.2 3
	GetLogger3 <
(< =
typeof= C
(C D
CartControllerD R
)R S
)S T
;T U
private 
readonly 
CartService $
_cartService% 1
;1 2
public 
CartController 
( 
CartService )
cartService* 5
)5 6
{ 	
_cartService 
= 
cartService &
;& '
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
[ 	
	Authorize	 
( 
Roles 
= 
$str '
)' (
]( )
public 
IActionResult 
GetCart $
($ %
int% (
userId) /
)/ 0
{ 	
try   
{!! 
_logger"" 
."" 
Info"" 
("" 
$""" 
$str"" :
{"": ;
userId""; A
}""A B
"""B C
)""C D
;""D E
var## 
cart## 
=## 
_cartService## '
.##' (
GetCartByUserId##( 7
(##7 8
userId##8 >
)##> ?
;##? @
if%% 
(%% 
cart%% 
==%% 
null%%  
)%%  !
{&& 
_logger'' 
.'' 
Warn''  
(''  !
$"''! #
$str''# >
{''> ?
userId''? E
}''E F
"''F G
)''G H
;''H I
return(( 
NotFound(( #
(((# $
$str(($ 4
)((4 5
;((5 6
})) 
_logger++ 
.++ 
Info++ 
(++ 
$"++ 
$str++ F
{++F G
userId++G M
}++M N
"++N O
)++O P
;++P Q
return,, 
Ok,, 
(,, 
cart,, 
),, 
;,,  
}-- 
catch.. 
(.. 
	Exception.. 
ex.. 
)..  
{// 
_logger00 
.00 
Error00 
(00 
$"00  
$str00  F
{00F G
userId00G M
}00M N
$str00N P
{00P Q
ex00Q S
.00S T
Message00T [
}00[ \
"00\ ]
,00] ^
ex00_ a
)00a b
;00b c
return11 

StatusCode11 !
(11! "
StatusCodes11" -
.11- .(
Status500InternalServerError11. J
,11J K
$str11L c
)11c d
;11d e
}22 
}33 	
[55 	
	Authorize55	 
(55 
Roles55 
=55 
$str55 !
)55! "
]55" #
[77 	
HttpPost77	 
(77 
$str77  
)77  !
]77! "
public88 
IActionResult88 
	AddToCart88 &
(88& '
int88' *
userId88+ 1
,881 2
[883 4
FromBody884 <
]88< =
CartItemDTO88> I
cartItemDto88J U
)88U V
{99 	
try:: 
{;; 
_logger<< 
.<< 
Info<< 
(<< 
$"<< 
$str<< @
{<<@ A
userId<<A G
}<<G H
$str<<H V
{<<V W
cartItemDto<<W b
.<<b c
	ProductId<<c l
}<<l m
"<<m n
)<<n o
;<<o p
_cartService>> 
.>> 
	AddToCart>> &
(>>& '
userId>>' -
,>>- .
cartItemDto>>/ :
)>>: ;
;>>; <
_logger@@ 
.@@ 
Info@@ 
(@@ 
$"@@ 
$str@@ I
{@@I J
userId@@J P
}@@P Q
$str@@Q _
{@@_ `
cartItemDto@@` k
.@@k l
	ProductId@@l u
}@@u v
"@@v w
)@@w x
;@@x y
returnAA 
OkAA 
(AA 
newAA 
{AA 
messageAA  '
=AA( )
$strAA* C
,AAC D
successAAE L
=AAM N
trueAAO S
}AAT U
)AAU V
;AAV W
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
_loggerEE 
.EE 
ErrorEE 
(EE 
$"EE  
$strEE  L
{EEL M
userIdEEM S
}EES T
$strEET V
{EEV W
exEEW Y
.EEY Z
MessageEEZ a
}EEa b
"EEb c
,EEc d
exEEe g
)EEg h
;EEh i
returnFF 

StatusCodeFF !
(FF! "
StatusCodesFF" -
.FF- .(
Status500InternalServerErrorFF. J
,FFJ K
$strFFL c
)FFc d
;FFd e
}GG 
}HH 	
[JJ 	
	AuthorizeJJ	 
(JJ 
RolesJJ 
=JJ 
$strJJ !
)JJ! "
]JJ" #
[LL 	
HttpPutLL	 
(LL 
$strLL 
)LL 
]LL 
publicMM 
IActionResultMM 

UpdateCartMM '
(MM' (
[MM( )
FromBodyMM) 1
]MM1 2
CartDTOMM3 :
cartDtoMM; B
)MMB C
{NN 	
tryOO 
{PP 
_loggerQQ 
.QQ 
InfoQQ 
(QQ 
$"QQ 
$strQQ :
{QQ: ;
cartDtoQQ; B
.QQB C
UserIdQQC I
}QQI J
"QQJ K
)QQK L
;QQL M
_cartServiceSS 
.SS 

UpdateCartSS '
(SS' (
cartDtoSS( /
.SS/ 0
UserIdSS0 6
,SS6 7
cartDtoSS8 ?
)SS? @
;SS@ A
_loggerUU 
.UU 
InfoUU 
(UU 
$"UU 
$strUU F
{UUF G
cartDtoUUG N
.UUN O
UserIdUUO U
}UUU V
"UUV W
)UUW X
;UUX Y
returnVV 
OkVV 
(VV 
newVV 
{VV 
messageVV  '
=VV( )
$strVV* E
,VVE F
successVVG N
=VVO P
trueVVQ U
}VVV W
)VVW X
;VVX Y
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX  
{YY 
_loggerZZ 
.ZZ 
ErrorZZ 
(ZZ 
$"ZZ  
$strZZ  F
{ZZF G
cartDtoZZG N
.ZZN O
UserIdZZO U
}ZZU V
$strZZV X
{ZZX Y
exZZY [
.ZZ[ \
MessageZZ\ c
}ZZc d
"ZZd e
,ZZe f
exZZg i
)ZZi j
;ZZj k
return[[ 
NotFound[[ 
([[  
new[[  #
{[[$ %
message[[& -
=[[. /
$str[[0 @
,[[@ A
success[[B I
=[[J K
false[[L Q
}[[R S
)[[S T
;[[T U
}\\ 
}]] 	
[__ 	
	Authorize__	 
(__ 
Roles__ 
=__ 
$str__ !
)__! "
]__" #
[aa 	

HttpDeleteaa	 
(aa 
$straa 2
)aa2 3
]aa3 4
publicbb 
IActionResultbb 
RemoveFromCartbb +
(bb+ ,
intbb, /
userIdbb0 6
,bb6 7
intbb8 ;

cartItemIdbb< F
)bbF G
{cc 	
trydd 
{ee 
_loggerff 
.ff 
Infoff 
(ff 
$"ff 
$strff ?
{ff? @

cartItemIdff@ J
}ffJ K
$strffK c
{ffc d
userIdffd j
}ffj k
"ffk l
)ffl m
;ffm n
_cartServicehh 
.hh 
RemoveFromCarthh +
(hh+ ,
userIdhh, 2
,hh2 3

cartItemIdhh4 >
)hh> ?
;hh? @
_loggerjj 
.jj 
Infojj 
(jj 
$"jj 
$strjj K
{jjK L

cartItemIdjjL V
}jjV W
$strjjW e
{jje f
userIdjjf l
}jjl m
"jjm n
)jjn o
;jjo p
returnkk 
Okkk 
(kk 
newkk 
{kk 
messagekk  '
=kk( )
$strkk* E
,kkE F
successkkG N
=kkO P
truekkQ U
}kkV W
)kkW X
;kkX Y
}ll 
catchmm 
(mm 
	Exceptionmm 
exmm 
)mm  
{nn 
_loggeroo 
.oo 
Erroroo 
(oo 
$"oo  
$stroo  K
{ooK L

cartItemIdooL V
}ooV W
$strooW n
{oon o
userIdooo u
}oou v
$stroov x
{oox y
exooy {
.oo{ |
Message	oo| Г
}
ooГ Д
"
ooД Е
,
ooЕ Ж
ex
ooЗ Й
)
ooЙ К
;
ooК Л
returnpp 

StatusCodepp !
(pp! "
StatusCodespp" -
.pp- .(
Status500InternalServerErrorpp. J
,ppJ K
$strppL c
)ppc d
;ppd e
}qq 
}rr 	
}ss 
}vv Г#
fD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\AuthController.cs
	namespace 	

EcomWebApp
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 
AuthController		 
:		  !
ControllerBase		" 0
{

 
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
AuthControllerG U
)U V
)V W
;W X
private 
readonly 
AuthService $
_authService% 1
;1 2
public 
AuthController 
( 
AuthService )
authService* 5
)5 6
{ 	
_authService 
= 
authService &
;& '
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Login) .
(. /
[/ 0
FromBody0 8
]8 9
LoginRequestDto: I
loginRequestJ V
)V W
{ 	
if 
( 
! 

ModelState 
. 
IsValid #
)# $
{ 
log 
. 
Warn 
( 
$str A
)A B
;B C
return 

BadRequest !
(! "

ModelState" ,
), -
;- .
} 
try 
{   
log!! 
.!! 
Info!! 
(!! 
$"!! 
$str!! 3
{!!3 4
loginRequest!!4 @
.!!@ A
UsernameOrEmail!!A P
}!!P Q
"!!Q R
)!!R S
;!!S T
var$$ 
token$$ 
=$$ 
await$$ !
_authService$$" .
.$$. /&
LoginAndGenerateTokenAsync$$/ I
($$I J
loginRequest$$J V
.$$V W
UsernameOrEmail$$W f
,$$f g
loginRequest$$h t
.$$t u
Password$$u }
)$$} ~
;$$~ 
log&& 
.&& 
Info&& 
(&& 
$"&& 
$str&& B
{&&B C
loginRequest&&C O
.&&O P
UsernameOrEmail&&P _
}&&_ `
"&&` a
)&&a b
;&&b c
return)) 
Ok)) 
()) 
new)) 
{)) 
Token))  %
=))& '
token))( -
})). /
)))/ 0
;))0 1
}** 
catch++ 
(++ '
UnauthorizedAccessException++ .
ex++/ 1
)++1 2
{,, 
log-- 
.-- 
Error-- 
(-- 
$"-- 
$str-- 8
{--8 9
ex--9 ;
.--; <
Message--< C
}--C D
"--D E
)--E F
;--F G
return.. 
Unauthorized.. #
(..# $
new..$ '
{..( )
Message..* 1
=..2 3
ex..4 6
...6 7
Message..7 >
}..? @
)..@ A
;..A B
}// 
catch00 
(00 
	Exception00 
ex00 
)00  
{11 
log22 
.22 
Error22 
(22 
$"22 
$str22 <
{22< =
ex22= ?
.22? @
Message22@ G
}22G H
"22H I
)22I J
;22J K
return33 

StatusCode33 !
(33! "
$num33" %
,33% &
$str33' >
)33> ?
;33? @
}44 
}55 	
}66 
public99 

class99 
LoginRequestDto99  
{:: 
public;; 
string;; 
UsernameOrEmail;; %
{;;& '
get;;( +
;;;+ ,
set;;- 0
;;;0 1
};;2 3
public<< 
string<< 
Password<< 
{<<  
get<<! $
;<<$ %
set<<& )
;<<) *
}<<+ ,
}== 
}>> ╠Z
gD:\DOTNET FSD Training\CaseStudy\Ecommerce_Backend\QuitQ_Ecom\EcomWebApp\Controllers\AdminController.cs
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public 
class 
AdminController 
: 
ControllerBase -
{		 
private

 
readonly

 
UserService

  
_userService

! -
;

- .
private 
static 
readonly 
ILog  
log! $
=% &

LogManager' 1
.1 2
	GetLogger2 ;
(; <
typeof< B
(B C
AdminControllerC R
)R S
)S T
;T U
public 

AdminController 
( 
UserService &
userService' 2
)2 3
{ 
_userService 
= 
userService "
;" #
} 
[ 
HttpGet 
( 
$str !
)! "
]" #
public 

async 
Task 
< 
IActionResult #
># $
GetUsersLast24Hours% 8
(8 9
)9 :
{ 
try 
{ 	
var 
users 
= 
await 
_userService *
.* +$
GetUsersLast24HoursAsync+ C
(C D
)D E
;E F
return 
Ok 
( 
users 
) 
; 
} 	
catch 
( !
UserNotFoundException $
ex% '
)' (
{ 	
log 
. 
Error 
( 
$str S
,S T
exU W
)W X
;X Y
return 
NotFound 
( 
ex 
. 
Message &
)& '
;' (
} 	
catch 
( 
	Exception 
ex 
) 
{   	
log!! 
.!! 
Error!! 
(!! 
$str!! U
,!!U V
ex!!W Y
)!!Y Z
;!!Z [
return"" 

StatusCode"" 
("" 
$num"" !
,""! "
$str""# U
)""U V
;""V W
}## 	
}$$ 
[&& 
HttpGet&& 
(&& 
$str&& 
)&&  
]&&  !
public'' 

async'' 
Task'' 
<'' 
IActionResult'' #
>''# $
GetUsersLast7Days''% 6
(''6 7
)''7 8
{(( 
try)) 
{** 	
var++ 
users++ 
=++ 
await++ 
_userService++ *
.++* +"
GetUsersLast7DaysAsync+++ A
(++A B
)++B C
;++C D
return,, 
Ok,, 
(,, 
users,, 
),, 
;,, 
}-- 	
catch.. 
(.. !
UserNotFoundException.. $
ex..% '
)..' (
{// 	
log00 
.00 
Error00 
(00 
$str00 Q
,00Q R
ex00S U
)00U V
;00V W
return11 
NotFound11 
(11 
ex11 
.11 
Message11 &
)11& '
;11' (
}22 	
catch33 
(33 
	Exception33 
ex33 
)33 
{44 	
log55 
.55 
Error55 
(55 
$str55 S
,55S T
ex55U W
)55W X
;55X Y
return66 

StatusCode66 
(66 
$num66 !
,66! "
$str66# U
)66U V
;66V W
}77 	
}88 
[:: 
HttpGet:: 
(:: 
$str:: 
):: 
]::  
public;; 

async;; 
Task;; 
<;; 
IActionResult;; #
>;;# $
GetUsersLastMonth;;% 6
(;;6 7
);;7 8
{<< 
try== 
{>> 	
var?? 
users?? 
=?? 
await?? 
_userService?? *
.??* +"
GetUsersLastMonthAsync??+ A
(??A B
)??B C
;??C D
return@@ 
Ok@@ 
(@@ 
users@@ 
)@@ 
;@@ 
}AA 	
catchBB 
(BB !
UserNotFoundExceptionBB $
exBB% '
)BB' (
{CC 	
logDD 
.DD 
ErrorDD 
(DD 
$strDD P
,DDP Q
exDDR T
)DDT U
;DDU V
returnEE 
NotFoundEE 
(EE 
exEE 
.EE 
MessageEE &
)EE& '
;EE' (
}FF 	
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG 
{HH 	
logII 
.II 
ErrorII 
(II 
$strII R
,IIR S
exIIT V
)IIV W
;IIW X
returnJJ 

StatusCodeJJ 
(JJ 
$numJJ !
,JJ! "
$strJJ# U
)JJU V
;JJV W
}KK 	
}LL 
[MM 
HttpGetMM 
(MM 
$strMM $
)MM$ %
]MM% &
publicNN 

asyncNN 
TaskNN 
<NN 
IActionResultNN #
>NN# $!
GetSellersLast24HoursNN% :
(NN: ;
)NN; <
{OO 
tryPP 
{QQ 	
varRR 
usersRR 
=RR 
awaitRR 
_userServiceRR *
.RR* +&
GetSellersLast24HoursAsyncRR+ E
(RRE F
)RRF G
;RRG H
returnSS 
OkSS 
(SS 
usersSS 
)SS 
;SS 
}TT 	
catchUU 
(UU !
UserNotFoundExceptionUU $
exUU% '
)UU' (
{VV 	
logWW 
.WW 
WarnWW 
(WW 
$strWW .
+WW/ 0
exWW1 3
.WW3 4
MessageWW4 ;
)WW; <
;WW< =
returnXX 
NotFoundXX 
(XX 
exXX 
.XX 
MessageXX &
)XX& '
;XX' (
}YY 	
catchZZ 
(ZZ 
DataAccessExceptionZZ "
exZZ# %
)ZZ% &
{[[ 	
log\\ 
.\\ 
Error\\ 
(\\ 
$str\\ -
+\\. /
ex\\0 2
.\\2 3
Message\\3 :
)\\: ;
;\\; <
return]] 

StatusCode]] 
(]] 
$num]] !
,]]! "
$str]]# U
)]]U V
;]]V W
}^^ 	
catch__ 
(__ 
	Exception__ 
ex__ 
)__ 
{`` 	
logaa 
.aa 
Erroraa 
(aa 
$straa #
+aa$ %
exaa& (
.aa( )
Messageaa) 0
)aa0 1
;aa1 2
returnbb 

StatusCodebb 
(bb 
$numbb !
,bb! "
$strbb# B
)bbB C
;bbC D
}cc 	
}dd 
[ff 
HttpGetff 
(ff 
$strff "
)ff" #
]ff# $
publicgg 

asyncgg 
Taskgg 
<gg 
IActionResultgg #
>gg# $
GetSellersLast7Daysgg% 8
(gg8 9
)gg9 :
{hh 
tryii 
{jj 	
varkk 
userskk 
=kk 
awaitkk 
_userServicekk *
.kk* +$
GetSellersLast7DaysAsynckk+ C
(kkC D
)kkD E
;kkE F
returnll 
Okll 
(ll 
usersll 
)ll 
;ll 
}mm 	
catchnn 
(nn !
UserNotFoundExceptionnn $
exnn% '
)nn' (
{oo 	
logpp 
.pp 
Warnpp 
(pp 
$strpp .
+pp/ 0
expp1 3
.pp3 4
Messagepp4 ;
)pp; <
;pp< =
returnqq 
NotFoundqq 
(qq 
exqq 
.qq 
Messageqq &
)qq& '
;qq' (
}rr 	
catchss 
(ss 
DataAccessExceptionss "
exss# %
)ss% &
{tt 	
loguu 
.uu 
Erroruu 
(uu 
$struu -
+uu. /
exuu0 2
.uu2 3
Messageuu3 :
)uu: ;
;uu; <
returnvv 

StatusCodevv 
(vv 
$numvv !
,vv! "
$strvv# U
)vvU V
;vvV W
}ww 	
catchxx 
(xx 
	Exceptionxx 
exxx 
)xx 
{yy 	
logzz 
.zz 
Errorzz 
(zz 
$strzz #
+zz$ %
exzz& (
.zz( )
Messagezz) 0
)zz0 1
;zz1 2
return{{ 

StatusCode{{ 
({{ 
$num{{ !
,{{! "
$str{{# B
){{B C
;{{C D
}|| 	
}}} 
[ 
HttpGet 
( 
$str !
)! "
]" #
public
АА 

async
АА 
Task
АА 
<
АА 
IActionResult
АА #
>
АА# $ 
GetSellerLastMonth
АА% 7
(
АА7 8
)
АА8 9
{
ББ 
try
ВВ 
{
ГГ 	
var
ДД 
users
ДД 
=
ДД 
await
ДД 
_userService
ДД *
.
ДД* +&
GetSellersLastMonthAsync
ДД+ C
(
ДДC D
)
ДДD E
;
ДДE F
return
ЕЕ 
Ok
ЕЕ 
(
ЕЕ 
users
ЕЕ 
)
ЕЕ 
;
ЕЕ 
}
ЖЖ 	
catch
ЗЗ 
(
ЗЗ #
UserNotFoundException
ЗЗ $
ex
ЗЗ% '
)
ЗЗ' (
{
ИИ 	
log
ЙЙ 
.
ЙЙ 
Error
ЙЙ 
(
ЙЙ 
$str
ЙЙ /
+
ЙЙ0 1
ex
ЙЙ2 4
.
ЙЙ4 5
Message
ЙЙ5 <
)
ЙЙ< =
;
ЙЙ= >
return
КК 
NotFound
КК 
(
КК 
ex
КК 
.
КК 
Message
КК &
)
КК& '
;
КК' (
}
ЛЛ 	
catch
ММ 
(
ММ !
DataAccessException
ММ "
ex
ММ# %
)
ММ% &
{
НН 	
log
ОО 
.
ОО 
Error
ОО 
(
ОО 
$str
ОО -
+
ОО. /
ex
ОО0 2
.
ОО2 3
Message
ОО3 :
)
ОО: ;
;
ОО; <
return
ПП 

StatusCode
ПП 
(
ПП 
$num
ПП !
,
ПП! "
$str
ПП# U
)
ППU V
;
ППV W
}
РР 	
catch
СС 
(
СС 
	Exception
СС 
ex
СС 
)
СС 
{
ТТ 	
log
УУ 
.
УУ 
Error
УУ 
(
УУ 
$str
УУ #
+
УУ$ %
ex
УУ& (
.
УУ( )
Message
УУ) 0
)
УУ0 1
;
УУ1 2
return
ФФ 

StatusCode
ФФ 
(
ФФ 
$num
ФФ !
,
ФФ! "
$str
ФФ# B
)
ФФB C
;
ФФC D
}
ХХ 	
}
ЦЦ 
}ЧЧ 